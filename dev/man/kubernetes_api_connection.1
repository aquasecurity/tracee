.\" Automatically generated by Pandoc 3.2
.\"
.TH "TRACEE\-K8S\-API\-CONNECTION" "1" "" "" "Tracee Event Manual"
.SS NAME
\f[B]k8s_api_connection\f[R] \- detect container connections to
Kubernetes API server
.SS DESCRIPTION
This event detects attempts by containers to connect to the Kubernetes
API server.
The Kubernetes API server is the control plane component that exposes
the Kubernetes API, making it a critical security boundary.
Unauthorized access attempts could indicate reconnaissance, credential
theft, or attempts to deploy malicious workloads.
.PP
The event maintains a mapping of container IDs to their respective
Kubernetes API server IP addresses and monitors for connection attempts
to these addresses, providing early warning of potential security
breaches.
.SS SIGNATURE METADATA
.IP \[bu] 2
\f[B]ID\f[R]: TRC\-1013
.IP \[bu] 2
\f[B]Version\f[R]: 0.1.0
.IP \[bu] 2
\f[B]Severity\f[R]: 1
.IP \[bu] 2
\f[B]Category\f[R]: Discovery
.IP \[bu] 2
\f[B]Technique\f[R]: Cloud Service Discovery
.IP \[bu] 2
\f[B]Tags\f[R]: container
.SS EVENT SETS
\f[B]signatures\f[R], \f[B]default\f[R]
.SS DATA FIELDS
.TP
\f[B]ip\f[R] (\f[I]string\f[R])
The IP address of the Kubernetes API server being accessed
.TP
\f[B]container_id\f[R] (\f[I]string\f[R])
ID of the container making the connection
.TP
\f[B]comm\f[R] (\f[I]string\f[R])
Name of the process attempting the connection
.TP
\f[B]port\f[R] (\f[I]uint32\f[R])
Destination port of the connection
.SS DEPENDENCIES
.IP \[bu] 2
\f[CR]sched_process_exec\f[R]: Track process execution in containers
.IP \[bu] 2
\f[CR]security_socket_connect\f[R]: Monitor socket connections
.SS USE CASES
.IP \[bu] 2
\f[B]Access control\f[R]: Monitor unauthorized API access
.IP \[bu] 2
\f[B]Container security\f[R]: Detect container escape attempts
.IP \[bu] 2
\f[B]Privilege escalation\f[R]: Identify unauthorized API interactions
.IP \[bu] 2
\f[B]Reconnaissance detection\f[R]: Spot information gathering attempts
.SS KUBERNETES SECURITY
Critical security aspects:
.IP \[bu] 2
API server is the cluster control plane
.IP \[bu] 2
Manages all cluster operations
.IP \[bu] 2
Handles authentication and authorization
.IP \[bu] 2
Stores sensitive cluster data
.SS ATTACK VECTORS
Common malicious uses include:
.IP \[bu] 2
\f[B]Information gathering\f[R]: Enumerate cluster resources
.IP \[bu] 2
\f[B]Credential theft\f[R]: Access service account tokens
.IP \[bu] 2
\f[B]Workload deployment\f[R]: Launch malicious pods
.IP \[bu] 2
\f[B]Lateral movement\f[R]: Access other namespaces
.SS RISK ASSESSMENT
Risk factors to consider:
.IP \[bu] 2
\f[B]Cluster Control\f[R]: Full API access possible
.IP \[bu] 2
\f[B]Sensitive Data\f[R]: Access to secrets
.IP \[bu] 2
\f[B]Cross\-namespace\f[R]: Potential blast radius
.IP \[bu] 2
\f[B]Persistence\f[R]: Ability to create workloads
.SS LEGITIMATE USES
Valid API access scenarios:
.IP \[bu] 2
Service mesh sidecars
.IP \[bu] 2
Monitoring agents
.IP \[bu] 2
Operators and controllers
.IP \[bu] 2
CI/CD tools
.SS MITIGATION
Recommended security controls:
.IP \[bu] 2
Network policies
.IP \[bu] 2
RBAC restrictions
.IP \[bu] 2
Service account limits
.IP \[bu] 2
API server audit logging
.IP \[bu] 2
Pod security standards
.SS RELATED EVENTS
.IP \[bu] 2
\f[B]security_socket_connect\f[R]: Network connections
.IP \[bu] 2
\f[B]sched_process_exec\f[R]: Process execution
.IP \[bu] 2
\f[B]container_create\f[R]: Container lifecycle
.IP \[bu] 2
\f[B]k8s_cert_theft\f[R]: Certificate theft attempts
