.\" Automatically generated by Pandoc 3.2
.\"
.TH "TRACEE\-RCD\-MODIFICATION" "1" "" "" "Tracee Event Manual"
.SS NAME
\f[B]rcd_modification\f[R] \- detect modifications to system runlevel
scripts
.SS DESCRIPTION
This event detects modifications to runlevel control directories (rcd)
scripts and related files.
These scripts are executed during system boot and runlevel changes,
making them attractive targets for attackers seeking to establish
persistence.
By modifying these initialization scripts, malicious actors can ensure
their code runs automatically when the system starts or changes states.
.PP
The event monitors not only direct modifications to rcd files but also
renames and executions of related commands like update\-rc.d, providing
comprehensive coverage of potential persistence mechanisms targeting
system initialization.
.SS SIGNATURE METADATA
.IP \[bu] 2
\f[B]ID\f[R]: TRC\-1026
.IP \[bu] 2
\f[B]Version\f[R]: 1
.IP \[bu] 2
\f[B]Severity\f[R]: 2
.IP \[bu] 2
\f[B]Category\f[R]: persistence
.IP \[bu] 2
\f[B]Technique\f[R]: RC Scripts
.IP \[bu] 2
\f[B]MITRE ID\f[R]:
attack\-pattern\[en]dca670cf\-eeec\-438f\-8185\-fd959d9ef211
.IP \[bu] 2
\f[B]MITRE External ID\f[R]: T1037.004
.SS EVENT SETS
\f[B]signatures\f[R], \f[B]default\f[R]
.SS DATA FIELDS
This signature event uses fields from multiple underlying events:
.TP
\f[B]pathname\f[R] (\f[I]string\f[R])
Path to the rcd file being accessed
.TP
\f[B]flags\f[R] (\f[I]string\f[R])
File access flags indicating modification
.TP
\f[B]old_path\f[R] (\f[I]string\f[R])
Original path in rename operations
.TP
\f[B]new_path\f[R] (\f[I]string\f[R])
New path in rename operations
.TP
\f[B]comm\f[R] (\f[I]string\f[R])
Command being executed (for update\-rc.d)
.SS DEPENDENCIES
.IP \[bu] 2
\f[CR]security_file_open\f[R]: Monitor file modifications
.IP \[bu] 2
\f[CR]security_inode_rename\f[R]: Track file renames
.IP \[bu] 2
\f[CR]sched_process_exec\f[R]: Monitor rc management commands
.SS USE CASES
.IP \[bu] 2
\f[B]Persistence detection\f[R]: Identify boot\-time malware
.IP \[bu] 2
\f[B]System integrity\f[R]: Monitor init script changes
.IP \[bu] 2
\f[B]Configuration control\f[R]: Track service changes
.IP \[bu] 2
\f[B]Boot sequence protection\f[R]: Prevent unauthorized changes
.SS RUNLEVEL SCRIPTS
Critical script locations:
.IP \[bu] 2
/etc/rc.d/
.IP \[bu] 2
/etc/init.d/
.IP \[bu] 2
/etc/rc*.d/
.IP \[bu] 2
System V init scripts
.IP \[bu] 2
Update\-rc.d command
.IP \[bu] 2
Chkconfig command
.SS ATTACK VECTORS
Common malicious uses include:
.IP \[bu] 2
\f[B]Boot persistence\f[R]: Ensure malware survival
.IP \[bu] 2
\f[B]Service creation\f[R]: Add malicious services
.IP \[bu] 2
\f[B]Privilege escalation\f[R]: Run as root at boot
.IP \[bu] 2
\f[B]Defense evasion\f[R]: Hide in legitimate scripts
.SS RISK ASSESSMENT
Risk factors to consider:
.IP \[bu] 2
\f[B]System\-Wide Impact\f[R]: Affects all users
.IP \[bu] 2
\f[B]Root Access\f[R]: Runs with full privileges
.IP \[bu] 2
\f[B]Boot\-Time Execution\f[R]: Early system access
.IP \[bu] 2
\f[B]Persistence\f[R]: Survives reboots
.SS LEGITIMATE USES
Valid modification scenarios:
.IP \[bu] 2
Service installation
.IP \[bu] 2
System configuration
.IP \[bu] 2
Package management
.IP \[bu] 2
Boot sequence optimization
.SS MITIGATION
Recommended security controls:
.IP \[bu] 2
File integrity monitoring
.IP \[bu] 2
Access restrictions
.IP \[bu] 2
Change management
.IP \[bu] 2
Audit logging
.IP \[bu] 2
Configuration control
.SS RELATED EVENTS
.IP \[bu] 2
\f[B]security_file_open\f[R]: File access monitoring
.IP \[bu] 2
\f[B]security_inode_rename\f[R]: File rename operations
.IP \[bu] 2
\f[B]sched_process_exec\f[R]: Command execution
.IP \[bu] 2
\f[B]scheduled_task_modification\f[R]: Task scheduling changes
