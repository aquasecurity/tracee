.\" Automatically generated by Pandoc 3.2
.\"
.TH "TRACEE\-NET\-PACKET\-DNS" "1" "" "" "Tracee Event Manual"
.SS NAME
\f[B]net_packet_dns\f[R] \- capture and analyze DNS network packets
.SS DESCRIPTION
Triggered for each DNS packet that reaches or leaves one of the
processes being traced.
This event provides detailed information about DNS queries and
responses, including all DNS header fields and resource records,
enabling comprehensive DNS traffic analysis.
.PP
The Domain Name System (DNS) is fundamental to Internet operations,
translating human\-readable domain names into IP addresses.
This event captures the complete DNS protocol exchange for monitoring,
security analysis, and troubleshooting.
.PP
This event is useful for:
.IP \[bu] 2
\f[B]DNS monitoring\f[R]: Track domain name resolution patterns
.IP \[bu] 2
\f[B]Security analysis\f[R]: Detect DNS\-based attacks and malicious
domains
.IP \[bu] 2
\f[B]Network troubleshooting\f[R]: Debug DNS resolution issues
.IP \[bu] 2
\f[B]Traffic analysis\f[R]: Monitor DNS query patterns and performance
.SS EVENT SETS
\f[B]network_events\f[R]
.SS DATA FIELDS
.TP
\f[B]metadata\f[R] (\f[I]trace.PacketMetadata\f[R])
Network packet metadata containing: \- Source IP address \- Destination
IP address \- Source port number (typically 53 for DNS servers) \-
Destination port number (typically 53 for DNS) \- Network protocol \-
Packet length \- Network interface
.TP
\f[B]proto_dns\f[R] (\f[I]trace.ProtoDNS\f[R])
DNS protocol information containing: \- \f[B]ID\f[R] (\f[I]uint16\f[R]):
Transaction ID for matching queries to responses \- \f[B]QR\f[R]
(\f[I]uint8\f[R]): Query (0) or Response (1) flag \- \f[B]opCode\f[R]
(\f[I]string\f[R]): Operation code (e.g., \[lq]query\[rq],
\[lq]iquery\[rq], \[lq]status\[rq]) \- \f[B]AA\f[R] (\f[I]uint8\f[R]):
Authoritative Answer flag \- \f[B]TC\f[R] (\f[I]uint8\f[R]): Truncation
flag \- \f[B]RD\f[R] (\f[I]uint8\f[R]): Recursion Desired flag \-
\f[B]RA\f[R] (\f[I]uint8\f[R]): Recursion Available flag \- \f[B]Z\f[R]
(\f[I]uint8\f[R]): Reserved field \- \f[B]responseCode\f[R]
(\f[I]string\f[R]): Response code (e.g., \[lq]no error\[rq], \[lq]name
error\[rq]) \- \f[B]QDCount\f[R] (\f[I]uint16\f[R]): Number of questions
\- \f[B]ANCount\f[R] (\f[I]uint16\f[R]): Number of answer records \-
\f[B]NSCount\f[R] (\f[I]uint16\f[R]): Number of authority records \-
\f[B]ARCount\f[R] (\f[I]uint16\f[R]): Number of additional records \-
\f[B]questions\f[R] (\f[I][]DNSQuestion\f[R]): DNS questions with name,
type, and class \- \f[B]answers\f[R] (\f[I][]DNSResourceRecord\f[R]):
DNS answer records \- \f[B]authorities\f[R]
(\f[I][]DNSResourceRecord\f[R]): DNS authority records \-
\f[B]additionals\f[R] (\f[I][]DNSResourceRecord\f[R]): DNS additional
records
.SS DEPENDENCIES
\f[B]Event Dependencies:\f[R]
.IP \[bu] 2
net_packet_dns_base: Base DNS packet capture event for network packet
parsing
.SS USE CASES
.IP \[bu] 2
\f[B]Security monitoring\f[R]: Detect DNS tunneling, DGA domains, and
malicious DNS traffic
.IP \[bu] 2
\f[B]Network analysis\f[R]: Monitor DNS resolution patterns and
performance
.IP \[bu] 2
\f[B]Troubleshooting\f[R]: Debug DNS resolution failures and timeouts
.IP \[bu] 2
\f[B]Compliance monitoring\f[R]: Track DNS queries for policy compliance
.IP \[bu] 2
\f[B]Threat hunting\f[R]: Identify suspicious domain resolution patterns
.SS DNS RECORD TYPES
Common DNS record types captured:
.IP \[bu] 2
\f[B]A\f[R]: IPv4 address records
.IP \[bu] 2
\f[B]AAAA\f[R]: IPv6 address records
.IP \[bu] 2
\f[B]CNAME\f[R]: Canonical name records
.IP \[bu] 2
\f[B]MX\f[R]: Mail exchange records
.IP \[bu] 2
\f[B]NS\f[R]: Name server records
.IP \[bu] 2
\f[B]PTR\f[R]: Pointer records for reverse lookups
.IP \[bu] 2
\f[B]SOA\f[R]: Start of authority records
.IP \[bu] 2
\f[B]TXT\f[R]: Text records
.IP \[bu] 2
\f[B]SRV\f[R]: Service records
.SS DNS FLAGS
Important DNS header flags:
.IP \[bu] 2
\f[B]QR\f[R]: Distinguishes queries from responses
.IP \[bu] 2
\f[B]AA\f[R]: Indicates authoritative responses
.IP \[bu] 2
\f[B]TC\f[R]: Signals truncated messages
.IP \[bu] 2
\f[B]RD\f[R]: Requests recursive resolution
.IP \[bu] 2
\f[B]RA\f[R]: Indicates recursive resolution support
.SS RELATED EVENTS
.IP \[bu] 2
\f[B]net_packet_udp\f[R]: UDP packet capture (DNS typically uses UDP)
.IP \[bu] 2
\f[B]net_packet_tcp\f[R]: TCP packet capture (DNS over TCP for large
responses)
.IP \[bu] 2
\f[B]net_packet_dns_request\f[R]: DNS query\-specific events
.IP \[bu] 2
\f[B]net_packet_dns_response\f[R]: DNS response\-specific events
