.\" Automatically generated by Pandoc 3.2
.\"
.TH "TRACEE\-DO\-MMAP" "1" "" "" "Tracee Event Manual"
.SS NAME
\f[B]do_mmap\f[R] \- memory mapping operation monitoring
.SS DESCRIPTION
Triggered when memory mapping operations are performed using the
kernel\[cq]s \f[CR]do_mmap\f[R] function.
This event captures detailed information about memory mapping
operations, including file mappings, anonymous mappings, and shared
memory operations, providing comprehensive insight into process memory
layout and usage patterns.
.PP
Memory mapping is fundamental to process execution, shared libraries,
and inter\-process communication, but can also be used in exploitation
techniques and code injection attacks.
.SS EVENT SETS
\f[B]fs\f[R], \f[B]fs_file_ops\f[R], \f[B]proc\f[R], \f[B]proc_mem\f[R]
.SS DATA FIELDS
.TP
\f[B]addr\f[R] (\f[I]trace.Pointer\f[R])
The memory address where the mapping is requested or created
.TP
\f[B]pathname\f[R] (\f[I]string\f[R])
The path of the file being mapped (for file mappings)
.TP
\f[B]flags\f[R] (\f[I]uint32\f[R])
The flags used for the memory mapping operation
.TP
\f[B]dev\f[R] (\f[I]uint32\f[R])
The device identifier where the mapped file resides
.TP
\f[B]inode\f[R] (\f[I]uint64\f[R])
The inode number of the mapped file
.TP
\f[B]ctime\f[R] (\f[I]uint64\f[R])
The creation/change time of the mapped file
.TP
\f[B]pgoff\f[R] (\f[I]uint64\f[R])
The page offset within the file for the mapping
.TP
\f[B]len\f[R] (\f[I]uint64\f[R])
The length of the memory mapping
.TP
\f[B]prot\f[R] (\f[I]uint64\f[R])
The memory protection flags (read, write, execute permissions)
.TP
\f[B]mmap_flags\f[R] (\f[I]uint64\f[R])
The memory mapping flags (shared, private, anonymous, etc.)
.SS DEPENDENCIES
\f[B]Kernel Probe:\f[R]
.IP \[bu] 2
do_mmap (kprobe + kretprobe, required): Kernel memory mapping function
.SS USE CASES
.IP \[bu] 2
\f[B]Memory security monitoring\f[R]: Track memory mapping operations
for security analysis
.IP \[bu] 2
\f[B]Code injection detection\f[R]: Detect potential code injection
through suspicious memory mappings
.IP \[bu] 2
\f[B]Performance analysis\f[R]: Monitor memory usage patterns and
mapping efficiency
.IP \[bu] 2
\f[B]Process debugging\f[R]: Debug memory mapping and allocation issues
.IP \[bu] 2
\f[B]Shared memory monitoring\f[R]: Track shared memory operations and
inter\-process communication
.SS RELATED EVENTS
.IP \[bu] 2
\f[B]security_mmap_file\f[R]: LSM security checks for file memory
mapping
.IP \[bu] 2
\f[B]shared_object_loaded\f[R]: Shared library loading through memory
mapping
.IP \[bu] 2
\f[B]mmap, mmap2\f[R]: Memory mapping system calls
.IP \[bu] 2
\f[B]Memory management events\f[R]: Related memory allocation and
management monitoring
