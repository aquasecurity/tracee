.\" Automatically generated by Pandoc 3.2
.\"
.TH "TRACEE\-SECURITY\-SOCKET\-SETSOCKOPT" "1" "" "" "Tracee Event Manual"
.SS NAME
\f[B]security_socket_setsockopt\f[R] \- check permissions before setting
socket options
.SS DESCRIPTION
This event is triggered by the Linux Security Module (LSM) hook when
checking permissions before setting socket options via the setsockopt
system call.
It provides visibility into socket option modifications and their
security implications.
.PP
Unlike the setsockopt syscall event which only provides the socket file
descriptor, this LSM event provides detailed socket information
including socket type and addressing details.
However, it does not include the actual option value being set, as it
occurs during the permission check phase.
.SS EVENT SETS
\f[B]lsm_hooks\f[R], \f[B]net\f[R], \f[B]net_sock\f[R]
.SS DATA FIELDS
.TP
\f[B]sockfd\f[R] (\f[I]int32\f[R])
File descriptor of the socket being modified
.TP
\f[B]level\f[R] (\f[I]int32\f[R])
Protocol level for the option (e.g., SOL_SOCKET, IPPROTO_TCP)
.TP
\f[B]optname\f[R] (\f[I]int32\f[R])
Option name being set
.TP
\f[B]local_addr\f[R] (\f[I]SockAddr\f[R])
Socket details including: \- Socket type \- Local IP address \- Local
port number \- Protocol\-specific information
.SS DEPENDENCIES
.IP \[bu] 2
\f[CR]security_socket_setsockopt\f[R]: LSM hook for socket option
setting
.SS USE CASES
.IP \[bu] 2
\f[B]Security monitoring\f[R]: Track socket configuration changes
.IP \[bu] 2
\f[B]Network control\f[R]: Audit socket option modifications
.IP \[bu] 2
\f[B]Compliance\f[R]: Verify socket security settings
.IP \[bu] 2
\f[B]Debugging\f[R]: Diagnose socket configuration issues
.SS SOCKET OPTIONS
Common socket option levels:
.IP \[bu] 2
\f[B]SOL_SOCKET\f[R]: Socket level options
.RS 2
.IP \[bu] 2
SO_REUSEADDR: Address reuse
.IP \[bu] 2
SO_KEEPALIVE: Connection keepalive
.IP \[bu] 2
SO_BROADCAST: Broadcast permissions
.IP \[bu] 2
SO_SNDBUF/SO_RCVBUF: Buffer sizes
.IP \[bu] 2
SO_LINGER: Connection termination
.RE
.IP \[bu] 2
\f[B]IPPROTO_IP\f[R]: IP level options
.RS 2
.IP \[bu] 2
IP_TTL: Time to live
.IP \[bu] 2
IP_TOS: Type of service
.IP \[bu] 2
IP_OPTIONS: IP header options
.RE
.IP \[bu] 2
\f[B]IPPROTO_TCP\f[R]: TCP level options
.RS 2
.IP \[bu] 2
TCP_NODELAY: Disable Nagle\[cq]s algorithm
.IP \[bu] 2
TCP_MAXSEG: Maximum segment size
.IP \[bu] 2
TCP_KEEPIDLE: Keepalive idle time
.RE
.SS SECURITY IMPLICATIONS
Important security aspects:
.IP \[bu] 2
\f[B]Resource limits\f[R]: Buffer size controls
.IP \[bu] 2
\f[B]Access control\f[R]: Broadcast permissions
.IP \[bu] 2
\f[B]Network behavior\f[R]: Protocol configurations
.IP \[bu] 2
\f[B]Connection handling\f[R]: Timeout settings
.IP \[bu] 2
\f[B]Performance tuning\f[R]: Protocol optimizations
.SS AUDIT TIPS
Key monitoring points:
.IP \[bu] 2
Changes to security\-relevant options
.IP \[bu] 2
Unusual option combinations
.IP \[bu] 2
Privileged option modifications
.IP \[bu] 2
Protocol\-specific security settings
.IP \[bu] 2
Resource allocation changes
.SS RELATED EVENTS
.IP \[bu] 2
\f[B]setsockopt\f[R]: System call for setting options
.IP \[bu] 2
\f[B]getsockopt\f[R]: System call for getting options
.IP \[bu] 2
\f[B]security_socket_bind\f[R]: Socket binding security
.IP \[bu] 2
\f[B]security_socket_connect\f[R]: Connection security
