.\" Automatically generated by Pandoc 3.2
.\"
.TH "TRACEE\-SECURITY\-PATH\-NOTIFY" "1" "" "" "Tracee Event Manual"
.SS NAME
\f[B]security_path_notify\f[R] \- security check for filesystem
notification registration
.SS DESCRIPTION
Triggered when a process attempts to register a filesystem notification
through any of the filesystem notification APIs (dnotify, inotify, or
fanotify).
This LSM (Linux Security Module) hook event captures the security check
performed when setting up filesystem watches.
.PP
The event provides detailed information about the filesystem object
being watched and the types of events being monitored.
This is particularly important for security monitoring as filesystem
notifications can be used for both legitimate monitoring and potential
malicious activities.
.PP
This event is useful for:
.IP \[bu] 2
\f[B]Filesystem monitoring\f[R]: Track who\[cq]s watching filesystem
changes
.IP \[bu] 2
\f[B]Security auditing\f[R]: Monitor filesystem notification setup
.IP \[bu] 2
\f[B]Access control\f[R]: Verify notification registration permissions
.IP \[bu] 2
\f[B]Behavior analysis\f[R]: Understand application monitoring patterns
.SS EVENT SETS
\f[B]none\f[R]
.SS DATA FIELDS
.TP
\f[B]pathname\f[R] (\f[I]string\f[R])
Filesystem path for which the watch is being registered
.TP
\f[B]inode\f[R] (\f[I]uint64\f[R])
Inode number of the filesystem object
.TP
\f[B]dev\f[R] (\f[I]uint32\f[R])
Device identifier of the filesystem object
.TP
\f[B]mask\f[R] (\f[I]uint64\f[R])
Mask representing the filesystem events to monitor
.TP
\f[B]obj_type\f[R] (\f[I]uint32\f[R])
The type of filesystem object to be watched
.SS DEPENDENCIES
\f[B]LSM Hook:\f[R]
.IP \[bu] 2
security_path_notify (required): LSM hook for filesystem notification
security checks
.SS USE CASES
.IP \[bu] 2
\f[B]Security monitoring\f[R]: Track filesystem watch registration
attempts
.IP \[bu] 2
\f[B]Access control\f[R]: Verify notification registration permissions
.IP \[bu] 2
\f[B]Behavior analysis\f[R]: Understand application monitoring patterns
.IP \[bu] 2
\f[B]Audit compliance\f[R]: Track filesystem monitoring activities
.IP \[bu] 2
\f[B]Threat detection\f[R]: Identify suspicious monitoring behavior
.SS NOTIFICATION APIS
The event captures notifications from multiple APIs:
.IP \[bu] 2
\f[B]dnotify\f[R]: Directory notification (legacy)
.IP \[bu] 2
\f[B]inotify\f[R]: File and directory monitoring
.IP \[bu] 2
\f[B]fanotify\f[R]: Advanced filesystem monitoring and access control
.SS WATCH MASKS
Common notification mask combinations:
.IP \[bu] 2
\f[B]IN_ACCESS\f[R]: File access
.IP \[bu] 2
\f[B]IN_MODIFY\f[R]: File modification
.IP \[bu] 2
\f[B]IN_ATTRIB\f[R]: Metadata changes
.IP \[bu] 2
\f[B]IN_CLOSE\f[R]: File close operations
.IP \[bu] 2
\f[B]IN_OPEN\f[R]: File open operations
.IP \[bu] 2
\f[B]IN_MOVED\f[R]: File move operations
.IP \[bu] 2
\f[B]IN_CREATE\f[R]: File/directory creation
.IP \[bu] 2
\f[B]IN_DELETE\f[R]: File/directory deletion
.SS SECURITY IMPLICATIONS
Important security considerations:
.IP \[bu] 2
\f[B]Information disclosure\f[R]: Monitoring sensitive files
.IP \[bu] 2
\f[B]Resource exhaustion\f[R]: Excessive watch registrations
.IP \[bu] 2
\f[B]Privilege escalation\f[R]: Unauthorized monitoring
.IP \[bu] 2
\f[B]Side\-channel attacks\f[R]: Information leakage through
notifications
.IP \[bu] 2
\f[B]Denial of service\f[R]: Watch limit exhaustion
.SS PERFORMANCE CONSIDERATIONS
Watch registration impact:
.IP \[bu] 2
\f[B]Watch limits\f[R]: System\-wide and per\-process limits
.IP \[bu] 2
\f[B]Memory usage\f[R]: Each watch consumes kernel resources
.IP \[bu] 2
\f[B]Notification overhead\f[R]: Event generation and delivery cost
.IP \[bu] 2
\f[B]Filesystem impact\f[R]: Additional metadata tracking
.SS RELATED EVENTS
.IP \[bu] 2
\f[B]inotify_add_watch\f[R]: inotify watch registration
.IP \[bu] 2
\f[B]fanotify_mark\f[R]: fanotify mark operations
.IP \[bu] 2
\f[B]security_file_open\f[R]: File open security events
.IP \[bu] 2
\f[B]security_inode_unlink\f[R]: File deletion security events
