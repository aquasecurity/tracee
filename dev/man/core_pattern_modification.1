.\" Automatically generated by Pandoc 3.2
.\"
.TH "TRACEE\-CORE\-PATTERN\-MODIFICATION" "1" "" "" "Tracee Event Manual"
.SS NAME
\f[B]core_pattern_modification\f[R] \- detect modifications to core dump
configuration
.SS DESCRIPTION
This event detects unauthorized changes to the core dump configuration
file (\f[CR]/proc/sys/kernel/core_pattern\f[R]).
The core_pattern file controls how the Linux kernel handles core dumps
when programs crash, including where the dumps are stored and what
program processes them.
.PP
Modifications to this file are security\-sensitive because the
core_pattern can specify an executable to process core dumps,
potentially allowing attackers to execute arbitrary commands with
elevated privileges when programs crash.
.SS SIGNATURE METADATA
.IP \[bu] 2
\f[B]ID\f[R]: TRC\-1011
.IP \[bu] 2
\f[B]Version\f[R]: 1
.IP \[bu] 2
\f[B]Severity\f[R]: 3
.IP \[bu] 2
\f[B]Category\f[R]: privilege\-escalation
.IP \[bu] 2
\f[B]Technique\f[R]: Escape to Host
.IP \[bu] 2
\f[B]MITRE ID\f[R]:
attack\-pattern\[en]4a5b7ade\-8bb5\-4853\-84ed\-23f262002665
.IP \[bu] 2
\f[B]MITRE External ID\f[R]: T1611
.SS EVENT SETS
\f[B]signatures\f[R], \f[B]default\f[R]
.SS DATA FIELDS
This signature event uses fields from the underlying security_file_open
event:
.TP
\f[B]pathname\f[R] (\f[I]string\f[R])
Path to the core_pattern file being accessed
.TP
\f[B]flags\f[R] (\f[I]string\f[R])
File access flags indicating the type of operation
.SS DEPENDENCIES
.IP \[bu] 2
\f[CR]security_file_open\f[R]: Monitor file access attempts to
core_pattern
.SS USE CASES
.IP \[bu] 2
\f[B]Container security\f[R]: Detect potential container escape attempts
.IP \[bu] 2
\f[B]Privilege escalation detection\f[R]: Monitor for unauthorized
command execution setup
.IP \[bu] 2
\f[B]System integrity\f[R]: Track changes to critical kernel
configurations
.IP \[bu] 2
\f[B]Incident response\f[R]: Identify attempts to exploit core dump
handling
.SS CORE PATTERN SECURITY
Critical aspects of core_pattern:
.IP \[bu] 2
Controls system\-wide core dump handling
.IP \[bu] 2
Can specify arbitrary executables
.IP \[bu] 2
Runs with elevated privileges
.IP \[bu] 2
Affects all processes on the system
.SS ATTACK VECTORS
Common malicious modifications include:
.IP \[bu] 2
\f[B]Command injection\f[R]: Setting malicious executables as handlers
.IP \[bu] 2
\f[B]Container escape\f[R]: Breaking container isolation via core dumps
.IP \[bu] 2
\f[B]Privilege escalation\f[R]: Executing commands with elevated
privileges
.IP \[bu] 2
\f[B]Information disclosure\f[R]: Capturing sensitive memory contents
.SS RISK ASSESSMENT
Risk factors to consider:
.IP \[bu] 2
\f[B]High Impact\f[R]: System\-wide effect on core dump handling
.IP \[bu] 2
\f[B]Root Access\f[R]: Core dump handlers run with elevated privileges
.IP \[bu] 2
\f[B]Automated Execution\f[R]: Triggers on any program crash
.IP \[bu] 2
\f[B]Persistence\f[R]: Changes persist until system reboot
.SS MITIGATION
Recommended security controls:
.IP \[bu] 2
Restrict access to /proc/sys/kernel/
.IP \[bu] 2
Monitor core_pattern modifications
.IP \[bu] 2
Use seccomp to control core dumps
.IP \[bu] 2
Implement proper container isolation
.SS RELATED EVENTS
.IP \[bu] 2
\f[B]security_file_open\f[R]: File access monitoring
.IP \[bu] 2
\f[B]process_execute\f[R]: Track execution of core dump handlers
.IP \[bu] 2
\f[B]security_bprm_check\f[R]: Binary execution security checks
.IP \[bu] 2
\f[B]container_create\f[R]: Container lifecycle events
