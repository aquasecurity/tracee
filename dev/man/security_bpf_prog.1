.\" Automatically generated by Pandoc 3.2
.\"
.TH "TRACEE\-SECURITY\-BPF\-PROG" "1" "" "" "Tracee Event Manual"
.SS NAME
\f[B]security_bpf_prog\f[R] \- security check for BPF program file
descriptor generation
.SS DESCRIPTION
Triggered when the kernel performs a security check before generating
and returning a file descriptor for a BPF program.
This LSM (Linux Security Module) hook event occurs during BPF program
loading or when explicitly requested by a user.
.PP
The event provides detailed information about the BPF program, including
its type, name, helper functions used, and loading status.
This visibility is crucial for monitoring BPF program usage and ensuring
security policies are enforced.
.PP
This event is useful for:
.IP \[bu] 2
\f[B]BPF monitoring\f[R]: Track BPF program loading and usage
.IP \[bu] 2
\f[B]Security auditing\f[R]: Monitor BPF program permissions and
capabilities
.IP \[bu] 2
\f[B]Helper function analysis\f[R]: Track which BPF helpers are being
used
.IP \[bu] 2
\f[B]Program identification\f[R]: Monitor BPF program types and names
.SS EVENT SETS
\f[B]none\f[R]
.SS DATA FIELDS
.TP
\f[B]type\f[R] (\f[I]int32\f[R])
The BPF program type
.TP
\f[B]name\f[R] (\f[I]string\f[R])
The BPF program name (first 16 bytes only, as stored in kernel)
.TP
\f[B]helpers\f[R] (\f[I][]uint64\f[R])
List of all BPF helper functions used by the program
.TP
\f[B]id\f[R] (\f[I]uint32\f[R])
The BPF program ID assigned by the kernel
.TP
\f[B]load\f[R] (\f[I]bool\f[R])
Whether this BPF program is currently being loaded
.SS DEPENDENCIES
\f[B]Kernel Probes:\f[R]
.IP \[bu] 2
security_bpf_prog (kprobe, required): LSM hook for BPF program file
descriptor generation
.IP \[bu] 2
bpf_check (kprobe, required): Track BPF program loading status
.IP \[bu] 2
check_helper_call (kprobe, required): Monitor BPF helper function usage
.IP \[bu] 2
check_map_func_compatibility (kprobe, required): Additional BPF helper
function monitoring
.SS USE CASES
.IP \[bu] 2
\f[B]Security monitoring\f[R]: Track BPF program loading and permissions
.IP \[bu] 2
\f[B]Helper function auditing\f[R]: Monitor which BPF helpers are being
used
.IP \[bu] 2
\f[B]Program identification\f[R]: Track BPF program types and names
.IP \[bu] 2
\f[B]Load monitoring\f[R]: Detect when new BPF programs are being loaded
.IP \[bu] 2
\f[B]Resource tracking\f[R]: Monitor BPF program resource allocation
.SS BPF PROGRAM TYPES
Common BPF program types that can be monitored:
.IP \[bu] 2
\f[B]Socket filters\f[R]: Network packet filtering
.IP \[bu] 2
\f[B]Kprobes\f[R]: Kernel function tracing
.IP \[bu] 2
\f[B]Tracepoints\f[R]: Kernel tracepoint monitoring
.IP \[bu] 2
\f[B]XDP\f[R]: Network packet processing
.IP \[bu] 2
\f[B]Cgroup\f[R]: Control group operations
.SS HELPER FUNCTIONS
The event tracks BPF helper function usage:
.IP \[bu] 2
\f[B]Map operations\f[R]: Map access and manipulation
.IP \[bu] 2
\f[B]Network helpers\f[R]: Packet and socket operations
.IP \[bu] 2
\f[B]Tracing helpers\f[R]: Event and context information
.IP \[bu] 2
\f[B]Time helpers\f[R]: Timestamp and timing operations
.IP \[bu] 2
\f[B]Security helpers\f[R]: LSM and capability checks
.SS SECURITY IMPLICATIONS
Important security considerations:
.IP \[bu] 2
\f[B]Privilege escalation\f[R]: BPF programs can access sensitive kernel
functionality
.IP \[bu] 2
\f[B]Resource consumption\f[R]: BPF programs can impact system
performance
.IP \[bu] 2
\f[B]Helper restrictions\f[R]: Different program types have different
helper access
.IP \[bu] 2
\f[B]Verification\f[R]: Programs must pass kernel verifier checks
.SS RELATED EVENTS
.IP \[bu] 2
\f[B]bpf_attach\f[R]: BPF program attachment events
.IP \[bu] 2
\f[B]security_bpf\f[R]: General BPF security events
.IP \[bu] 2
\f[B]bpf_map_create\f[R]: BPF map creation events
.IP \[bu] 2
\f[B]bpf_prog_load\f[R]: BPF program loading events
