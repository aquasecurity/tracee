.\" Automatically generated by Pandoc 3.2
.\"
.TH "TRACEE\-POLICY" "1" "2025/12" "" "Tracee Policy Flag Manual"
.SS NAME
tracee \f[B]\-\-policy\f[R] \- Specify policy files or directories to
load
.SS SYNOPSIS
tracee \f[B]\-\-policy\f[R] <file|dir> [\f[B]\-\-policy\f[R] <file|dir>
\&...]
.SS DESCRIPTION
The \f[B]\-\-policy\f[R] flag allows you to specify one or more policy
files or directories containing policy files to load into Tracee.
.PP
Policies define which events to trace and how to filter them.
When using the \f[B]\-\-policy\f[R] flag, you cannot use the
\f[B]\-\-scope\f[R] or \f[B]\-\-events\f[R] flags together, as they
serve different purposes for event selection.
.PP
Policy files are YAML files that follow the Tracee Policy API
specification.
They define:
.IP \[bu] 2
\f[B]Scope\f[R]: Which workloads to trace (e.g., global, specific
containers, processes)
.IP \[bu] 2
\f[B]Rules\f[R]: Which events to trace and optional filters to apply
.PP
When specifying a directory, Tracee will load all policy files found in
that directory.
When specifying individual files, you can use multiple
\f[B]\-\-policy\f[R] flags to load multiple policies.
.SS EXAMPLES
.IP \[bu] 2
Load a single policy file:
.RS 2
.IP
.EX
\-\-policy ./policy.yaml
.EE
.RE
.IP \[bu] 2
Load all policies from a directory:
.RS 2
.IP
.EX
\-\-policy ./policies/
.EE
.RE
.IP \[bu] 2
Load multiple individual policy files:
.RS 2
.IP
.EX
\-\-policy ./policy1.yaml \-\-policy ./policy2.yaml
.EE
.RE
.IP \[bu] 2
Using the short form:
.RS 2
.IP
.EX
\-p ./policy.yaml
.EE
.RE
.IP \[bu] 2
Complete example with policy:
.RS 2
.IP
.EX
tracee \-\-policy ./security\-policy.yaml \-\-output json:events.json
.EE
.RE
.SS POLICY FILE FORMAT
Policy files use YAML format and follow this structure:
.IP
.EX
apiVersion\f[B]:\f[R] tracee.aquasec.com/v1beta1
kind\f[B]:\f[R] Policy
metadata\f[B]:\f[R]
  name\f[B]:\f[R] policy\-name
  annotations\f[B]:\f[R]
    description\f[B]:\f[R] Policy description
spec\f[B]:\f[R]
  scope\f[B]:\f[R]
    \f[B]\-\f[R] global
  rules\f[B]:\f[R]
    \f[B]\-\f[R] event\f[B]:\f[R] event_name
      filters\f[B]:\f[R]
        \f[B]\-\f[R] filter_expression
.EE
.PP
For more information about policy file format and options, refer to the
Tracee Policy documentation.
.SS NOTES
.IP \[bu] 2
If multiple policies are loaded, they are combined and all matching
events from any policy will be traced
.IP \[bu] 2
Policy files must be valid YAML and conform to the Tracee Policy API
specification
