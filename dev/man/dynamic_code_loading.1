.\" Automatically generated by Pandoc 3.2
.\"
.TH "TRACEE\-DYNAMIC\-CODE\-LOADING" "1" "" "" "Tracee Event Manual"
.SS NAME
\f[B]dynamic_code_loading\f[R] \- detect dynamic code loading through
memory protection changes
.SS DESCRIPTION
This event detects potential dynamic code loading by monitoring changes
in memory protection attributes.
It specifically identifies when a memory region transitions from being
writable to executable, which often indicates that code has been written
to memory and is about to be executed.
.PP
Dynamic code loading can be used legitimately (e.g., JIT compilation)
but is also a common technique used by malware to execute code without
writing files to disk, making it harder to detect through static
analysis.
.SS SIGNATURE METADATA
.IP \[bu] 2
\f[B]ID\f[R]: TRC\-104
.IP \[bu] 2
\f[B]Version\f[R]: 1
.IP \[bu] 2
\f[B]Severity\f[R]: 2
.IP \[bu] 2
\f[B]Category\f[R]: defense\-evasion
.IP \[bu] 2
\f[B]Technique\f[R]: Software Packing
.IP \[bu] 2
\f[B]MITRE ID\f[R]:
attack\-pattern\[en]deb98323\-e13f\-4b0c\-8d94\-175379069062
.IP \[bu] 2
\f[B]MITRE External ID\f[R]: T1027.002
.SS EVENT SETS
\f[B]signatures\f[R], \f[B]default\f[R]
.SS DATA FIELDS
This signature event uses fields from the underlying mem_prot_alert
event:
.TP
\f[B]pathname\f[R] (\f[I]string\f[R])
Path to the executable containing the memory region
.TP
\f[B]prev_prot\f[R] (\f[I]string\f[R])
Previous memory protection flags
.TP
\f[B]prot\f[R] (\f[I]string\f[R])
New memory protection flags
.TP
\f[B]vm_file\f[R] (\f[I]string\f[R])
Associated file mapping information
.TP
\f[B]offset\f[R] (\f[I]uint64\f[R])
Offset within the memory region
.SS DEPENDENCIES
.IP \[bu] 2
\f[CR]mem_prot_alert\f[R]: Monitor memory protection changes
.SS USE CASES
.IP \[bu] 2
\f[B]Malware detection\f[R]: Identify fileless malware execution
.IP \[bu] 2
\f[B]Runtime integrity\f[R]: Monitor for unexpected code execution
.IP \[bu] 2
\f[B]Security analysis\f[R]: Track dynamic code behavior
.IP \[bu] 2
\f[B]Threat hunting\f[R]: Detect evasive malware techniques
.SS MEMORY PROTECTION
Protection flag transitions:
.IP \[bu] 2
\f[B]W→X\f[R]: Write to Execute (suspicious)
.IP \[bu] 2
\f[B]W+X\f[R]: Simultaneous Write/Execute (highly suspicious)
.IP \[bu] 2
\f[B]R→X\f[R]: Read to Execute (common for JIT)
.IP \[bu] 2
\f[B]None→X\f[R]: No access to Execute (potential unpacking)
.SS ATTACK VECTORS
Common malicious uses include:
.IP \[bu] 2
\f[B]Fileless malware\f[R]: Execute code without files
.IP \[bu] 2
\f[B]Shellcode injection\f[R]: Dynamic code execution
.IP \[bu] 2
\f[B]Packer unpacking\f[R]: Runtime code decryption
.IP \[bu] 2
\f[B]Memory\-resident malware\f[R]: Avoid disk artifacts
.SS RISK ASSESSMENT
Risk factors to consider:
.IP \[bu] 2
\f[B]Evasion Technique\f[R]: Bypasses static analysis
.IP \[bu] 2
\f[B]Fileless Attack\f[R]: No filesystem artifacts
.IP \[bu] 2
\f[B]Memory Analysis\f[R]: Required for detection
.IP \[bu] 2
\f[B]False Positives\f[R]: Common in JIT environments
.SS LEGITIMATE USES
Valid dynamic code scenarios:
.IP \[bu] 2
JIT compilation
.IP \[bu] 2
Runtime code generation
.IP \[bu] 2
Plugin systems
.IP \[bu] 2
Dynamic language interpreters
.SS RELATED EVENTS
.IP \[bu] 2
\f[B]mem_prot_alert\f[R]: Memory protection changes
.IP \[bu] 2
\f[B]security_file_mprotect\f[R]: Memory protection syscalls
.IP \[bu] 2
\f[B]process_vm_write\f[R]: Process memory modifications
.IP \[bu] 2
\f[B]shared_object_loaded\f[R]: Dynamic library loading
