.\" Automatically generated by Pandoc 3.2
.\"
.TH "TRACEE\-KERNEL\-MODULE\-LOADING" "1" "" "" "Tracee Event Manual"
.SS NAME
\f[B]kernel_module_loading\f[R] \- kernel module loading detection
.SS DESCRIPTION
Triggered when kernel module loading is detected.
This security signature monitors for kernel module loading activities,
which can be legitimate system administration tasks or potentially
malicious operations by adversaries seeking elevated privileges and
stealth capabilities.
.PP
Kernel modules operate with elevated privileges and can directly
interact with the operating system core.
While legitimate modules extend kernel functionality, malicious modules
can enable rootkits, hide processes, intercept system calls, and evade
detection by operating within kernel space.
.SS SIGNATURE METADATA
.IP \[bu] 2
\f[B]ID\f[R]: TRC\-1017
.IP \[bu] 2
\f[B]Version\f[R]: 1
.IP \[bu] 2
\f[B]Severity\f[R]: 2 (Moderate threat level)
.IP \[bu] 2
\f[B]Category\f[R]: persistence
.IP \[bu] 2
\f[B]Technique\f[R]: Kernel Modules and Extensions
.IP \[bu] 2
\f[B]MITRE ATT&CK\f[R]: T1547.006
.SS EVENT SETS
\f[B]signatures\f[R], \f[B]persistence\f[R]
.SS DATA FIELDS
.TP
\f[B]module_info\f[R] (\f[I]object\f[R])
Information about the kernel module being loaded
.TP
\f[B]loading_context\f[R] (\f[I]object\f[R])
Context information about the module loading operation
.SS DEPENDENCIES
\f[B]System Events:\f[R]
.IP \[bu] 2
init_module (required): Monitors kernel module initialization
.IP \[bu] 2
security_kernel_read_file (required): Monitors kernel file read
operations for \[lq]kernel\-module\[rq] type files
.SS DETECTION LOGIC
The signature monitors for:
.IP "1." 3
\f[B]Module initialization events\f[R] from \f[CR]init_module\f[R]
system calls
.IP "2." 3
\f[B]Kernel file reading\f[R] from \f[CR]security_kernel_read_file\f[R]
with \[lq]kernel\-module\[rq] type
.IP "3." 3
\f[B]Loading pattern analysis\f[R] to distinguish legitimate from
suspicious module loading
.SS USE CASES
.IP \[bu] 2
\f[B]Rootkit detection\f[R]: Identify malicious kernel modules used by
rootkits
.IP \[bu] 2
\f[B]System integrity monitoring\f[R]: Track unauthorized kernel
modifications
.IP \[bu] 2
\f[B]Incident response\f[R]: Investigate persistence mechanisms during
security incidents
.IP \[bu] 2
\f[B]Compliance monitoring\f[R]: Ensure only authorized kernel modules
are loaded
.IP \[bu] 2
\f[B]Forensic analysis\f[R]: Analyze kernel\-level persistence
techniques
.SS LEGITIMATE VS. MALICIOUS LOADING
\f[B]Legitimate scenarios\f[R]: \- Hardware driver installation \-
System feature activation (e.g., VPN, virtualization) \- Administrative
tools requiring kernel access \- Security software components
.PP
\f[B]Suspicious indicators\f[R]: \- Loading from unusual locations \-
Unsigned or unknown modules \- Loading during suspicious timeframes \-
Modules with obfuscated names \- Concurrent with other suspicious
activities
.SS DETECTION CHALLENGES
.IP \[bu] 2
\f[B]False positives\f[R]: Legitimate administrative activities
.IP \[bu] 2
\f[B]Timing\f[R]: Detection after module is already loaded
.IP \[bu] 2
\f[B]Evasion\f[R]: Advanced modules may use anti\-detection techniques
.IP \[bu] 2
\f[B]Context\f[R]: Distinguishing legitimate from malicious loading
.SS RELATED EVENTS
.IP \[bu] 2
\f[B]init_module\f[R]: Primary system call for module loading
.IP \[bu] 2
\f[B]security_kernel_read_file\f[R]: Kernel file access monitoring
.IP \[bu] 2
\f[B]hidden_kernel_module\f[R]: Detection of hidden modules after
loading
.IP \[bu] 2
\f[B]module_load\f[R]: Alternative module loading detection
.IP \[bu] 2
\f[B]finit_module\f[R]: File\-based module loading system call
