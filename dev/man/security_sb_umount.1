.\" Automatically generated by Pandoc 3.2
.\"
.TH "TRACEE\-SECURITY\-SB\-UMOUNT" "1" "" "" "Tracee Event Manual"
.SS NAME
\f[B]security_sb_umount\f[R] \- security check for filesystem unmount
operations
.SS DESCRIPTION
Triggered when a filesystem unmount operation is attempted in the
system.
This LSM (Linux Security Module) hook event captures the security check
performed before a filesystem is unmounted, providing critical
visibility into storage operations and system configuration changes.
.PP
The event provides detailed information about the unmount operation,
including the device being unmounted, mount point, filesystem type, and
unmount flags.
This visibility is crucial for both system administration and security
monitoring, as unexpected unmount operations could indicate security
breaches or system instability.
.PP
This event is useful for:
.IP \[bu] 2
\f[B]Unmount monitoring\f[R]: Track filesystem unmount operations
.IP \[bu] 2
\f[B]Security auditing\f[R]: Detect unauthorized unmount attempts
.IP \[bu] 2
\f[B]System stability\f[R]: Monitor storage configuration changes
.IP \[bu] 2
\f[B]Resource management\f[R]: Track storage availability
.SS EVENT SETS
\f[B]none\f[R]
.SS DATA FIELDS
.TP
\f[B]dev_name\f[R] (\f[I]string\f[R])
The name of the device being unmounted
.TP
\f[B]path\f[R] (\f[I]string\f[R])
The filesystem path being unmounted
.TP
\f[B]type\f[R] (\f[I]string\f[R])
The filesystem type being unmounted (e.g., ext4, nfs)
.TP
\f[B]flags\f[R] (\f[I]uint32\f[R])
Unmount flags that specify unmount behavior
.SS DEPENDENCIES
\f[B]LSM Hook:\f[R]
.IP \[bu] 2
security_sb_umount (required): LSM hook for filesystem unmount security
checks
.SS USE CASES
.IP \[bu] 2
\f[B]Security monitoring\f[R]: Detect unauthorized unmount operations
.IP \[bu] 2
\f[B]System administration\f[R]: Track filesystem unmount activities
.IP \[bu] 2
\f[B]Stability monitoring\f[R]: Verify proper storage detachment
.IP \[bu] 2
\f[B]Resource tracking\f[R]: Monitor storage availability changes
.IP \[bu] 2
\f[B]Threat detection\f[R]: Identify suspicious unmount operations
.SS UNMOUNT FLAGS
Common unmount flags to monitor:
.IP \[bu] 2
\f[B]MNT_FORCE\f[R]: Force unmount even if busy
.IP \[bu] 2
\f[B]MNT_DETACH\f[R]: Perform lazy unmount
.IP \[bu] 2
\f[B]MNT_EXPIRE\f[R]: Mark for expiry
.IP \[bu] 2
\f[B]UMOUNT_NOFOLLOW\f[R]: Don\[cq]t follow symlinks
.IP \[bu] 2
\f[B]MNT_EXCL\f[R]: Only unmount if not shared
.SS FILESYSTEM TYPES
Common filesystem types affected:
.IP \[bu] 2
\f[B]Local filesystems\f[R]: ext4, xfs, btrfs
.IP \[bu] 2
\f[B]Network filesystems\f[R]: nfs, cifs, smbfs
.IP \[bu] 2
\f[B]Special filesystems\f[R]: tmpfs, devfs, procfs
.IP \[bu] 2
\f[B]Container filesystems\f[R]: overlayfs, aufs
.IP \[bu] 2
\f[B]Encrypted filesystems\f[R]: ecryptfs, encfs
.SS SECURITY IMPLICATIONS
Critical security aspects to monitor:
.IP \[bu] 2
\f[B]Data loss\f[R]: Through forced unmounts
.IP \[bu] 2
\f[B]Service disruption\f[R]: Through unexpected unmounts
.IP \[bu] 2
\f[B]Resource denial\f[R]: Through malicious unmounts
.IP \[bu] 2
\f[B]System instability\f[R]: Through improper unmounts
.IP \[bu] 2
\f[B]Container isolation\f[R]: Through shared mount unmounts
.SS RELATED EVENTS
.IP \[bu] 2
\f[B]umount\f[R]: Unmount system call events
.IP \[bu] 2
\f[B]umount2\f[R]: Extended unmount system call events
.IP \[bu] 2
\f[B]security_sb_mount\f[R]: Filesystem mount security events
.IP \[bu] 2
\f[B]security_sb_remount\f[R]: Filesystem remount security events
