.\" Automatically generated by Pandoc 3.2
.\"
.TH "TRACEE\-NET\-PACKET\-ICMP" "1" "" "" "Tracee Event Manual"
.SS NAME
\f[B]net_packet_icmp\f[R] \- capture and analyze ICMP network packets
.SS DESCRIPTION
Triggered for each ICMP (Internet Control Message Protocol) packet that
reaches or leaves one of the processes being traced.
This event provides detailed information about ICMP packets, including
message types, codes, and protocol\-specific fields used for network
diagnostics and error reporting.
.PP
ICMP is a network layer protocol primarily used for diagnostic and
control purposes, enabling devices to communicate error and status
information about network conditions.
It\[cq]s commonly used by networking utilities like ping and traceroute
for network connectivity testing and troubleshooting.
.SS EVENT SETS
\f[B]network_events\f[R]
.SS DATA FIELDS
.TP
\f[B]metadata\f[R] (\f[I]trace.PacketMetadata\f[R])
Network packet metadata containing: \- Source IP address \- Destination
IP address \- Network protocol \- Packet length \- Network interface
.TP
\f[B]proto_icmp\f[R] (\f[I]trace.ProtoICMP\f[R])
ICMP protocol information containing: \- \f[B]typeCode\f[R]
(\f[I]string\f[R]): ICMP message type and code (e.g.,
\[lq]EchoRequest\[rq], \[lq]EchoReply\[rq],
\[lq]DestinationUnreachable\[rq]) \- \f[B]checksum\f[R]
(\f[I]uint16\f[R]): ICMP checksum for error detection \- \f[B]id\f[R]
(\f[I]uint16\f[R]): Identifier field for matching requests/replies \-
\f[B]seq\f[R] (\f[I]uint16\f[R]): Sequence number for ordering messages
.SS DEPENDENCIES
\f[B]Event Dependencies:\f[R]
.IP \[bu] 2
net_packet_icmp_base: Base ICMP packet capture event for network packet
parsing
.SS USE CASES
.IP \[bu] 2
\f[B]Network connectivity testing\f[R]: Monitor ping and connectivity
testing tools
.IP \[bu] 2
\f[B]Network troubleshooting\f[R]: Analyze ICMP error messages and
routing issues
.IP \[bu] 2
\f[B]Security monitoring\f[R]: Detect ICMP\-based reconnaissance and
attacks
.IP \[bu] 2
\f[B]Performance analysis\f[R]: Monitor network latency and packet loss
.IP \[bu] 2
\f[B]Infrastructure monitoring\f[R]: Track network health and
reachability
.SS ICMP MESSAGE TYPES
Common ICMP message types captured:
.SS Diagnostic Messages
.IP \[bu] 2
\f[B]Echo Request (Type 8)\f[R]: Ping requests for connectivity testing
.IP \[bu] 2
\f[B]Echo Reply (Type 0)\f[R]: Ping responses confirming reachability
.SS Error Messages
.IP \[bu] 2
\f[B]Destination Unreachable (Type 3)\f[R]: Target host/network
unreachable
.IP \[bu] 2
\f[B]Time Exceeded (Type 11)\f[R]: TTL expired, indicates routing loops
.IP \[bu] 2
\f[B]Parameter Problem (Type 12)\f[R]: IP header issues
.IP \[bu] 2
\f[B]Redirect (Type 5)\f[R]: Better route suggestions from routers
.SS Informational Messages
.IP \[bu] 2
\f[B]Timestamp Request/Reply\f[R]: Time synchronization
.IP \[bu] 2
\f[B]Information Request/Reply\f[R]: Network information queries
.SS ICMP CODES
Each ICMP type has specific codes providing additional context:
.PP
\f[B]Destination Unreachable (Type 3)\f[R]:
.IP \[bu] 2
Code 0: Network unreachable
.IP \[bu] 2
Code 1: Host unreachable
.IP \[bu] 2
Code 2: Protocol unreachable
.IP \[bu] 2
Code 3: Port unreachable
.PP
\f[B]Time Exceeded (Type 11)\f[R]:
.IP \[bu] 2
Code 0: TTL exceeded in transit
.IP \[bu] 2
Code 1: Fragment reassembly time exceeded
.SS SECURITY CONSIDERATIONS
Monitor for malicious ICMP usage:
.IP \[bu] 2
\f[B]ICMP flooding\f[R]: DoS attacks using ping floods
.IP \[bu] 2
\f[B]ICMP tunneling\f[R]: Data exfiltration through ICMP payloads
.IP \[bu] 2
\f[B]Network reconnaissance\f[R]: Port scanning using ICMP
.IP \[bu] 2
\f[B]Covert channels\f[R]: Hidden communication via ICMP
.SS NETWORK TROUBLESHOOTING
ICMP helps diagnose:
.IP \[bu] 2
\f[B]Connectivity issues\f[R]: Echo requests/replies for reachability
testing
.IP \[bu] 2
\f[B]Routing problems\f[R]: Time exceeded messages indicating loops
.IP \[bu] 2
\f[B]MTU discovery\f[R]: Path MTU discovery using fragmentation needed
messages
.IP \[bu] 2
\f[B]Network configuration\f[R]: Redirect messages for routing
optimization
.SS RELATED EVENTS
.IP \[bu] 2
\f[B]net_packet_ipv4\f[R]: IPv4 packet capture (ICMP runs over IP)
.IP \[bu] 2
\f[B]net_packet_ipv6\f[R]: IPv6 packet capture (ICMPv6 for IPv6)
.IP \[bu] 2
\f[B]net_packet_icmpv6\f[R]: ICMPv6 packet capture for IPv6 networks
.IP \[bu] 2
\f[B]net_packet_udp\f[R]: UDP packet capture for comparison
