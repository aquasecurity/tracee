.\" Automatically generated by Pandoc 3.2
.\"
.TH "TRACEE\-PTRACE\-CODE\-INJECTION" "1" "" "" "Tracee Event Manual"
.SS NAME
\f[B]ptrace_code_injection\f[R] \- ptrace\-based code injection
detection
.SS DESCRIPTION
Triggered when code injection attempts are detected using the
\f[CR]ptrace\f[R] system call.
This security signature specifically monitors for
\f[CR]PTRACE_POKETEXT\f[R] and \f[CR]PTRACE_POKEDATA\f[R] requests,
which are commonly used to alter target process memory and inject
malicious code.
.PP
Code injection through ptrace allows attackers to execute arbitrary code
within the context of another process, evading detection and leveraging
the permissions of the injected process.
This technique is particularly dangerous as malicious operations appear
to originate from legitimate processes.
.PP
This signature is useful for:
.IP \[bu] 2
\f[B]Code injection detection\f[R]: Identify attempts to inject code
into other processes
.IP \[bu] 2
\f[B]Process manipulation monitoring\f[R]: Detect unauthorized process
memory modifications
.IP \[bu] 2
\f[B]Advanced attack detection\f[R]: Identify sophisticated evasion
techniques
.SS SIGNATURE METADATA
.IP \[bu] 2
\f[B]ID\f[R]: TRC\-103
.IP \[bu] 2
\f[B]Version\f[R]: 1
.IP \[bu] 2
\f[B]Severity\f[R]: 3 (Moderate to high threat level)
.IP \[bu] 2
\f[B]Category\f[R]: defense\-evasion
.IP \[bu] 2
\f[B]Technique\f[R]: Ptrace System Calls
.IP \[bu] 2
\f[B]MITRE ATT&CK\f[R]: T1055.008
.SS EVENT SETS
\f[B]signatures\f[R], \f[B]defense_evasion\f[R]
.SS DATA FIELDS
.TP
\f[B]ptrace_request\f[R] (\f[I]string\f[R])
The specific ptrace request used (PTRACE_POKETEXT or PTRACE_POKEDATA)
.TP
\f[B]target_process\f[R] (\f[I]object\f[R])
Information about the process being injected into
.TP
\f[B]injector_process\f[R] (\f[I]object\f[R])
Information about the process performing the injection
.SS DEPENDENCIES
\f[B]System Events:\f[R]
.IP \[bu] 2
ptrace (required): Monitors ptrace system call for specific memory
manipulation requests
.SS DETECTION LOGIC
The signature monitors for:
.IP "1." 3
\f[B]Ptrace system calls\f[R] with specific request types
.IP "2." 3
\f[B]PTRACE_POKETEXT requests\f[R]: Writing to target process text/code
segments
.IP "3." 3
\f[B]PTRACE_POKEDATA requests\f[R]: Writing to target process data
segments
.IP "4." 3
\f[B]Memory modification patterns\f[R]: Identifying potential code
injection signatures
.SS USE CASES
.IP \[bu] 2
\f[B]Malware detection\f[R]: Identify malware using process injection
techniques
.IP \[bu] 2
\f[B]Advanced threat hunting\f[R]: Detect sophisticated evasion
mechanisms
.IP \[bu] 2
\f[B]Incident response\f[R]: Investigate process manipulation during
security incidents
.IP \[bu] 2
\f[B]Security monitoring\f[R]: Detect unauthorized process memory
modifications
.IP \[bu] 2
\f[B]Forensic analysis\f[R]: Analyze code injection techniques used in
attacks
.SS PTRACE REQUESTS MONITORED
.IP \[bu] 2
\f[B]PTRACE_POKETEXT\f[R]: Write data to target process text segment
(code injection)
.IP \[bu] 2
\f[B]PTRACE_POKEDATA\f[R]: Write data to target process data segment
(data modification)
.SS ATTACK SCENARIOS
Common code injection scenarios:
.IP \[bu] 2
\f[B]Shellcode injection\f[R]: Injecting executable shellcode into
target processes
.IP \[bu] 2
\f[B]DLL injection\f[R]: Loading malicious libraries into target
processes
.IP \[bu] 2
\f[B]Process hollowing\f[R]: Replacing legitimate process code with
malicious code
.IP \[bu] 2
\f[B]API hooking\f[R]: Intercepting and modifying function calls
.IP \[bu] 2
\f[B]Return\-oriented programming\f[R]: Chaining existing code gadgets
.SS LEGITIMATE USE CASES
Ptrace is also used legitimately by:
.IP \[bu] 2
\f[B]Debuggers\f[R]: GDB, LLDB for debugging applications
.IP \[bu] 2
\f[B]Profilers\f[R]: Performance analysis tools
.IP \[bu] 2
\f[B]Security tools\f[R]: Anti\-malware and monitoring software
.IP \[bu] 2
\f[B]System administration\f[R]: Process monitoring and management tools
.SS EVASION TECHNIQUES
Attackers may attempt to evade detection through:
.IP \[bu] 2
\f[B]Timing\-based evasion\f[R]: Spacing out injection operations
.IP \[bu] 2
\f[B]Process selection\f[R]: Targeting specific processes less likely to
be monitored
.IP \[bu] 2
\f[B]Small payload injection\f[R]: Injecting minimal code to avoid
detection thresholds
.IP \[bu] 2
\f[B]Legitimate tool abuse\f[R]: Using debugging tools for malicious
purposes
.SS MITIGATION STRATEGIES
.IP \[bu] 2
\f[B]Process isolation\f[R]: Use containers and sandboxing
.IP \[bu] 2
\f[B]Privilege restriction\f[R]: Limit ptrace capabilities through
seccomp/AppArmor
.IP \[bu] 2
\f[B]Monitoring\f[R]: Deploy comprehensive process monitoring
.IP \[bu] 2
\f[B]Yama LSM\f[R]: Use Yama security module to restrict ptrace usage
.SS RELATED EVENTS
.IP \[bu] 2
\f[B]ptrace\f[R]: Primary system call monitored for injection attempts
.IP \[bu] 2
\f[B]process_vm_write_code_injection\f[R]: Alternative code injection
detection method
.IP \[bu] 2
\f[B]anti_debugging\f[R]: Related anti\-analysis technique detection
.IP \[bu] 2
\f[B]suspicious_syscall_source\f[R]: Unusual syscall source location
detection
