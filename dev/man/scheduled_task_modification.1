.\" Automatically generated by Pandoc 3.2
.\"
.TH "TRACEE\-SCHEDULED\-TASK\-MODIFICATION" "1" "" "" "Tracee Event Manual"
.SS NAME
\f[B]scheduled_task_mod\f[R] \- detect modifications to scheduled tasks
.SS DESCRIPTION
This event detects modifications to scheduled tasks and their
configurations, particularly focusing on crontab and related files.
Scheduled tasks are commonly used to execute commands at predefined
times, making them attractive targets for attackers seeking to establish
persistence or execute malicious code automatically.
.PP
The event monitors both direct file modifications and command executions
related to task scheduling, providing comprehensive coverage of
potential persistence mechanisms through scheduled tasks.
.SS SIGNATURE METADATA
.IP \[bu] 2
\f[B]ID\f[R]: TRC\-1027
.IP \[bu] 2
\f[B]Version\f[R]: 1
.IP \[bu] 2
\f[B]Severity\f[R]: 2
.IP \[bu] 2
\f[B]Category\f[R]: persistence
.IP \[bu] 2
\f[B]Technique\f[R]: Cron
.IP \[bu] 2
\f[B]MITRE ID\f[R]:
attack\-pattern\[en]2acf44aa\-542f\-4366\-b4eb\-55ef5747759c
.IP \[bu] 2
\f[B]MITRE External ID\f[R]: T1053.003
.SS EVENT SETS
\f[B]signatures\f[R], \f[B]default\f[R]
.SS DATA FIELDS
This signature event uses fields from multiple underlying events:
.TP
\f[B]pathname\f[R] (\f[I]string\f[R])
Path to the scheduling configuration being accessed
.TP
\f[B]flags\f[R] (\f[I]string\f[R])
File access flags indicating modification
.TP
\f[B]old_path\f[R] (\f[I]string\f[R])
Original path in rename operations
.TP
\f[B]new_path\f[R] (\f[I]string\f[R])
New path in rename operations
.TP
\f[B]comm\f[R] (\f[I]string\f[R])
Command being executed (for scheduling tools)
.SS DEPENDENCIES
.IP \[bu] 2
\f[CR]security_file_open\f[R]: Monitor file modifications
.IP \[bu] 2
\f[CR]security_inode_rename\f[R]: Track file renames
.IP \[bu] 2
\f[CR]sched_process_exec\f[R]: Monitor scheduling commands
.SS USE CASES
.IP \[bu] 2
\f[B]Persistence detection\f[R]: Identify unauthorized scheduling
.IP \[bu] 2
\f[B]Configuration control\f[R]: Track scheduling changes
.IP \[bu] 2
\f[B]System integrity\f[R]: Monitor task modifications
.IP \[bu] 2
\f[B]Compliance monitoring\f[R]: Track authorized changes
.SS SCHEDULING COMPONENTS
Critical files and commands:
.IP \[bu] 2
/etc/crontab
.IP \[bu] 2
/etc/cron.d/
.IP \[bu] 2
User crontabs
.IP \[bu] 2
Systemd timers
.IP \[bu] 2
at/batch jobs
.IP \[bu] 2
Anacron configurations
.IP \[bu] 2
Scheduling commands (crontab, at, batch)
.SS ATTACK VECTORS
Common malicious uses include:
.IP \[bu] 2
\f[B]Persistence\f[R]: Ensure malware survival
.IP \[bu] 2
\f[B]Privilege escalation\f[R]: Schedule privileged tasks
.IP \[bu] 2
\f[B]Command execution\f[R]: Run unauthorized code
.IP \[bu] 2
\f[B]Defense evasion\f[R]: Hide in legitimate jobs
.SS RISK ASSESSMENT
Risk factors to consider:
.IP \[bu] 2
\f[B]System\-Wide Impact\f[R]: Affects all users
.IP \[bu] 2
\f[B]Privilege Level\f[R]: Often runs as root
.IP \[bu] 2
\f[B]Time\-Based\f[R]: Delayed execution
.IP \[bu] 2
\f[B]Persistence\f[R]: Survives reboots
.SS LEGITIMATE USES
Valid modification scenarios:
.IP \[bu] 2
System maintenance
.IP \[bu] 2
Backup scheduling
.IP \[bu] 2
Update automation
.IP \[bu] 2
Log rotation
.IP \[bu] 2
Job scheduling
.SS MITIGATION
Recommended security controls:
.IP \[bu] 2
Access restrictions
.IP \[bu] 2
Change monitoring
.IP \[bu] 2
Audit logging
.IP \[bu] 2
Configuration control
.IP \[bu] 2
User permissions
.SS RELATED EVENTS
.IP \[bu] 2
\f[B]security_file_open\f[R]: File access monitoring
.IP \[bu] 2
\f[B]security_inode_rename\f[R]: File rename operations
.IP \[bu] 2
\f[B]sched_process_exec\f[R]: Command execution
.IP \[bu] 2
\f[B]rcd_modification\f[R]: Init script changes
