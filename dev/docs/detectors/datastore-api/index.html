
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Runtime security and forensics using eBPF.">
      
      
      
        <link rel="canonical" href="https://aquasecurity.github.io/tracee/dev/docs/detectors/datastore-api/">
      
      
        <link rel="prev" href="../api-reference/">
      
      
        <link rel="next" href="../../outputs/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0+insiders-4.53.17">
    
    
      
        <title>DataStore API - Tracee</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.22cc1d52.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#datastore-api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Tracee" class="md-header__button md-logo" aria-label="Tracee" data-md-component="logo">
      
  <img src="../../../images/tracee_logo_only.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Tracee
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              DataStore API
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/aquasecurity/tracee" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../overview/" class="md-tabs__link">
          
  
  
  Docs

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../traceectl/" class="md-tabs__link">
          
  
  
  Traceectl

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../tutorials/overview/" class="md-tabs__link">
          
  
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../contributing/overview/" class="md-tabs__link">
          
  
  
  Contributing

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Tracee" class="md-nav__button md-logo" aria-label="Tracee" data-md-component="logo">
      
  <img src="../../../images/tracee_logo_only.png" alt="logo">

    </a>
    Tracee
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aquasecurity/tracee" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Docs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Docs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Installation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2" id="__nav_2_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Requirements
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Requirements
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Prerequisites
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/kernel-symbols/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kernel Symbols
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/os-requirements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OS Requirements
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/capabilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Capabilities
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/lsm-support/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LSM BPF Support
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/mac-faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mac FAQ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_2_3" id="__nav_2_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/kubernetes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_2_4" id="__nav_2_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Configuration
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/config/kubernetes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/container-engines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Container Enrichment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/config/monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Monitoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4_5" >
        
          
          <label class="md-nav__link" for="__nav_2_2_4_5" id="__nav_2_2_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Flag Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Flag Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/artifacts.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    artifacts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/buffers.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    buffers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/capabilities.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    capabilities
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/config.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    config
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/detectors.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    detectors
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/enrichment.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    enrichment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/events.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    events
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/logging.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    logging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/output.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    output
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/policy.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    policy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/scope.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    scope
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/server.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/signatures-dir.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    signatures-dir
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/stores.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    stores
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4_6" >
        
          
          <label class="md-nav__link" for="__nav_2_2_4_6" id="__nav_2_2_4_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Commands Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_4_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Commands Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4_6_1" >
        
          
          <label class="md-nav__link" for="__nav_2_2_4_6_1" id="__nav_2_2_4_6_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    list
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_2_4_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_4_6_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    list
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/list.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/list-events.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    events
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/list-detectors.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    detectors
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/list-policies.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    policies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/version.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    version
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/man.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    man
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Policies
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Policies
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../policies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../policies/scopes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scopes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../policies/rules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_4" >
        
          
          <label class="md-nav__link" for="__nav_2_3_4" id="__nav_2_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Usage
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Usage
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../policies/usage/cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../policies/usage/kubernetes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Events
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Events
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_2" >
        
          
          <label class="md-nav__link" for="__nav_2_4_2" id="__nav_2_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Built-in Events
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Built-in Events
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_4_2_1" id="__nav_2_4_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Lifecycle
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_4_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Lifecycle
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/sched_process_fork/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    sched_process_fork
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/sched_process_exec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    sched_process_exec
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/sched_process_exit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    sched_process_exit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/do_exit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    do_exit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/sched_switch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    sched_switch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/container_create/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    container_create
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/container_remove/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    container_remove
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/existing_container/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    existing_container
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/init_namespaces/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    init_namespaces
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/switch_task_ns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    switch_task_ns
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/cgroup_mkdir/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cgroup_mkdir
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/cgroup_rmdir/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cgroup_rmdir
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/cgroup_attach_task/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cgroup_attach_task
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_4_2_2" id="__nav_2_4_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Security
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_4_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Security
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/security-events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/anti_debugging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Anti Debugging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/aslr_inspection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ASLR Inspection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/cgroup_notify_on_release_modification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cgroup Notify-On-Release
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/cgroup_release_agent_modification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cgroup Release-Agent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/core_pattern_modification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core Pattern Modification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/default_loader_modification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Default Loader Modification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/disk_mount/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Disk Mount
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/docker_abuse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docker Abuse
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/dropped_executable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dropped Executable
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/dynamic_code_loading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dynamic Code Loading
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/fileless_execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fileless Execution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/hidden_file_created/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hidden File Created
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/illegitimate_shell/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Illegitimate Shell
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/kubernetes_api_connection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    K8S API Connection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/kubernetes_certificate_theft_attempt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    K8S Certificate Theft
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/kernel_module_loading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kernel Module Loading
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/ld_preload/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Loader Preload
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/process_vm_write_code_injection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Process VM Write
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/proc_fops_hooking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Procfs File Ops Hooking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/proc_kcore_read/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Procfs Kcore Read
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/proc_mem_access/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Procfs Mem Access
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/proc_mem_code_injection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Procfs Mem Code Injection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/ptrace_code_injection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ptrace Code Injection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/rcd_modification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RCD Modification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/sched_debug_recon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sched Debug
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/scheduled_task_modification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scheduled Task Modification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/stack_pivot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stack Pivot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/stdio_over_socket/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Standard I/O Over Socket
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/sudoers_modification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sudoers Modification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/syscall_table_hooking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Syscall Table Hooking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/system_request_key_config_modification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SysRQ Modification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_4_2_3" id="__nav_2_4_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Network
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_4_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Network
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/network-events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_flow_tcp_begin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_flow_tcp_begin
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_flow_tcp_end/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_flow_tcp_end
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_ipv4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_ipv4
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_ipv6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_ipv6
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_tcp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_tcp
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_udp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_udp
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_icmp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_icmp
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_icmpv6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_icmpv6
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_dns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_dns
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_dns_request/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_dns_request
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_dns_response/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_dns_response
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_http/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_http
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_http_request/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_http_request
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_http_response/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_http_response
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4_2_4" id="__nav_2_4_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    LSM
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_4_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    LSM
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/cap_capable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cap_capable
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_bpf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_bpf
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_bpf_map/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_bpf_map
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_bpf_prog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_bpf_prog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_bprm_check/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_bprm_check
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_file_mprotect/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_file_mprotect
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_file_open/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_file_open
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_inode_mknod/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_inode_mknod
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_inode_rename/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_inode_rename
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_inode_unlink/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_inode_unlink
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_kernel_post_read_file/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_kernel_post_read_file
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_kernel_read_file/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_kernel_read_file
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_mmap_file/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_mmap_file
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_path_notify/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_path_notify
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_sb_mount/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_sb_mount
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_sb_umount/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_sb_umount
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_settime64/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_settime64
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_socket_accept/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_socket_accept
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_socket_bind/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_socket_bind
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_socket_connect/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_socket_connect
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_socket_create/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_socket_create
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_socket_listen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_socket_listen
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_socket_setsockopt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_socket_setsockopt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_task_setrlimit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_task_setrlimit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_4_2_5" id="__nav_2_4_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Misc
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_4_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Misc
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/__kernel_write/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    __kernel_write
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/bpf_attach/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    bpf_attach
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/call_usermodehelper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    call_usermodehelper
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/chmod_common/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    chmod_common
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/commit_creds/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    commit_creds
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/debugfs_create_dir/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    debugfs_create_dir
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/debugfs_create_file/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    debugfs_create_file
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/device_add/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    device_add
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/dirty_pipe_splice/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    dirty_pipe_splice
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/do_init_module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    do_init_module
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/do_mmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    do_mmap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/do_sigaction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    do_sigaction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/do_truncate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    do_truncate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/file_modification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    file_modification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/ftrace_hook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ftrace_hook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/hidden_kernel_module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    hidden_kernel_module
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/hooked_seq_ops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    hooked_seq_ops
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/hooked_syscall/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    hooked_syscall
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/inotify_watch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    inotify_watch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/kallsyms_lookup_name/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kallsyms_lookup_name
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/kprobe_attach/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kprobe_attach
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/load_elf_phdrs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    load_elf_phdrs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/magic_write/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    magic_write
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/mem_prot_alert/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    mem_prot_alert
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/net_tcp_connect/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_tcp_connect
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/print_mem_dump/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    print_mem_dump
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/proc_create/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    proc_create
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/process_execute_failed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    process_execute_failed
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/register_chrdev/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    register_chrdev
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/set_fs_pwd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    set_fs_pwd
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/shared_object_loaded/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    shared_object_loaded
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/socket_accept/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    socket_accept
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/socket_dup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    socket_dup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/suspicious_syscall_source/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    suspicious_syscall_source
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/symbols_collision/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    symbols_collision
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/symbols_loaded/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    symbols_loaded
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/task_rename/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    task_rename
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/tracee_info/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    tracee_info
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/vfs_read/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vfs_read
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/vfs_readv/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vfs_readv
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/vfs_utimes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vfs_utimes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/vfs_write/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vfs_write
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/vfs_writev/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vfs_writev
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_4_2_6" id="__nav_2_4_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Syscalls
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_4_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_2_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Syscalls
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/syscall-events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/syscalls/sys_enter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    sys_enter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/syscalls/sys_exit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    sys_exit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_3" >
        
          
          <label class="md-nav__link" for="__nav_2_4_3" id="__nav_2_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Custom Events
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Custom Events
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/custom/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/custom/golang/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Go
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" checked>
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Detectors
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Detectors
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../yaml-detectors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    YAML Detectors
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    DataStore API
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    DataStore API
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      
        Table of Contents
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-datastores-provide" class="md-nav__link">
    <span class="md-ellipsis">
      
        What DataStores Provide
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#registry-pattern" class="md-nav__link">
    <span class="md-ellipsis">
      
        Registry Pattern
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read-only-access-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Read-Only Access Model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thread-safety-guarantees" class="md-nav__link">
    <span class="md-ellipsis">
      
        Thread Safety Guarantees
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Concepts
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datastore-base-interface" class="md-nav__link">
    <span class="md-ellipsis">
      
        DataStore Base Interface
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        Common Errors
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#health-status" class="md-nav__link">
    <span class="md-ellipsis">
      
        Health Status
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#registry-interface" class="md-nav__link">
    <span class="md-ellipsis">
      
        Registry Interface
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Registry Interface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#registry-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Registry Methods
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Usage Examples
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#processstore" class="md-nav__link">
    <span class="md-ellipsis">
      
        ProcessStore
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ProcessStore">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interface" class="md-nav__link">
    <span class="md-ellipsis">
      
        Interface
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#processinfo-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        ProcessInfo Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#getprocess" class="md-nav__link">
    <span class="md-ellipsis">
      
        GetProcess
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getancestry" class="md-nav__link">
    <span class="md-ellipsis">
      
        GetAncestry
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getchildprocesses" class="md-nav__link">
    <span class="md-ellipsis">
      
        GetChildProcesses
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entityid-vs-pid" class="md-nav__link">
    <span class="md-ellipsis">
      
        EntityID vs PID
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#containerstore" class="md-nav__link">
    <span class="md-ellipsis">
      
        ContainerStore
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ContainerStore">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interface_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Interface
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#containerinfo-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        ContainerInfo Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#getcontainer" class="md-nav__link">
    <span class="md-ellipsis">
      
        GetContainer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getcontainerbyname" class="md-nav__link">
    <span class="md-ellipsis">
      
        GetContainerByName
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#listcontainers" class="md-nav__link">
    <span class="md-ellipsis">
      
        ListContainers
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#systemstore" class="md-nav__link">
    <span class="md-ellipsis">
      
        SystemStore
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SystemStore">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interface_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Interface
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#systeminfo-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        SystemInfo Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#getsysteminfo" class="md-nav__link">
    <span class="md-ellipsis">
      
        GetSystemInfo
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#syscallstore" class="md-nav__link">
    <span class="md-ellipsis">
      
        SyscallStore
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SyscallStore">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interface_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Interface
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#getsyscallname" class="md-nav__link">
    <span class="md-ellipsis">
      
        GetSyscallName
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getsyscallid" class="md-nav__link">
    <span class="md-ellipsis">
      
        GetSyscallID
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kernelsymbolstore" class="md-nav__link">
    <span class="md-ellipsis">
      
        KernelSymbolStore
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="KernelSymbolStore">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interface_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Interface
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#symbolinfo-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        SymbolInfo Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#resolvesymbolbyaddress" class="md-nav__link">
    <span class="md-ellipsis">
      
        ResolveSymbolByAddress
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getsymboladdress" class="md-nav__link">
    <span class="md-ellipsis">
      
        GetSymbolAddress
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resolvesymbolsbatch" class="md-nav__link">
    <span class="md-ellipsis">
      
        ResolveSymbolsBatch
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnsstore" class="md-nav__link">
    <span class="md-ellipsis">
      
        DNSStore
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DNSStore">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interface_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Interface
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dnsresponse-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        DNSResponse Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#getdnsresponse" class="md-nav__link">
    <span class="md-ellipsis">
      
        GetDNSResponse
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#health-and-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Health and Metrics
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Health and Metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#health-information" class="md-nav__link">
    <span class="md-ellipsis">
      
        Health Information
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metrics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Handling
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Error Handling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#error-classification" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Classification
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graceful-degradation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Graceful Degradation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        Advanced Usage
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#combining-multiple-stores" class="md-nav__link">
    <span class="md-ellipsis">
      
        Combining Multiple Stores
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#caching-store-references" class="md-nav__link">
    <span class="md-ellipsis">
      
        Caching Store References
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#writable-datastores" class="md-nav__link">
    <span class="md-ellipsis">
      
        Writable DataStores
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Writable DataStores">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick Start
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Concepts
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Summary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quick-reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick Reference
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      
        Best Practices
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Next Steps
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Output
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Output
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outputs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outputs/output-formats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Formats
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outputs/streams/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Streams
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outputs/event-structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Event Structure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outputs/sorting-events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sorting Events
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outputs/logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Logging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Forensics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Forensics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../forensics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Security Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Troubleshooting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Traceectl
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Traceectl
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../traceectl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../traceectl/usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Commands
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Commands
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../traceectl/commands/event/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    event
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../traceectl/commands/metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../traceectl/commands/stream/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    stream
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../traceectl/commands/version/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    version
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Flags
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Flags
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../traceectl/flags/output/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    output
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../traceectl/flags/format/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    format
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../traceectl/flags/server/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../traceectl/flags/policy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    policy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/verify-tracee-signature/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cosign - verify Tracee signature
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/deploy-grafana-dashboard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Access Tracee Metrics in Grafana and Prometheus
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/tracee-vagrant/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Using Tracee Container Image with Vagrant on Mac
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/k8s-policies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Working with Tracee's Policies on Kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/promtail/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Accessing Tracee Logs through Promtail and Loki
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/additional-resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Additional Resources
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Contributing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/guidelines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Guidelines
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/checkpatch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PR Validation (Checkpatch)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/adding-events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Adding New Events
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/event-documentation-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Event Documentation Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/testing-coverage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Code Coverage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/performance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Performance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/evt-tool/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Event Generator (evt)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/kubernetes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/setup-development-machine-with-vagrant/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Setup Development Machine with Vagrant
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_11" >
        
          
          <label class="md-nav__link" for="__nav_5_11" id="__nav_5_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Building
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    Building
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/building/building/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Building Tracee
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/building/environment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Building Environment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/building/containers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Building Containers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      
        Table of Contents
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-datastores-provide" class="md-nav__link">
    <span class="md-ellipsis">
      
        What DataStores Provide
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#registry-pattern" class="md-nav__link">
    <span class="md-ellipsis">
      
        Registry Pattern
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read-only-access-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Read-Only Access Model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thread-safety-guarantees" class="md-nav__link">
    <span class="md-ellipsis">
      
        Thread Safety Guarantees
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Concepts
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datastore-base-interface" class="md-nav__link">
    <span class="md-ellipsis">
      
        DataStore Base Interface
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        Common Errors
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#health-status" class="md-nav__link">
    <span class="md-ellipsis">
      
        Health Status
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#registry-interface" class="md-nav__link">
    <span class="md-ellipsis">
      
        Registry Interface
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Registry Interface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#registry-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Registry Methods
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Usage Examples
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#processstore" class="md-nav__link">
    <span class="md-ellipsis">
      
        ProcessStore
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ProcessStore">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interface" class="md-nav__link">
    <span class="md-ellipsis">
      
        Interface
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#processinfo-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        ProcessInfo Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#getprocess" class="md-nav__link">
    <span class="md-ellipsis">
      
        GetProcess
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getancestry" class="md-nav__link">
    <span class="md-ellipsis">
      
        GetAncestry
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getchildprocesses" class="md-nav__link">
    <span class="md-ellipsis">
      
        GetChildProcesses
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entityid-vs-pid" class="md-nav__link">
    <span class="md-ellipsis">
      
        EntityID vs PID
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#containerstore" class="md-nav__link">
    <span class="md-ellipsis">
      
        ContainerStore
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ContainerStore">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interface_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Interface
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#containerinfo-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        ContainerInfo Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#getcontainer" class="md-nav__link">
    <span class="md-ellipsis">
      
        GetContainer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getcontainerbyname" class="md-nav__link">
    <span class="md-ellipsis">
      
        GetContainerByName
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#listcontainers" class="md-nav__link">
    <span class="md-ellipsis">
      
        ListContainers
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#systemstore" class="md-nav__link">
    <span class="md-ellipsis">
      
        SystemStore
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SystemStore">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interface_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Interface
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#systeminfo-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        SystemInfo Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#getsysteminfo" class="md-nav__link">
    <span class="md-ellipsis">
      
        GetSystemInfo
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#syscallstore" class="md-nav__link">
    <span class="md-ellipsis">
      
        SyscallStore
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SyscallStore">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interface_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Interface
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#getsyscallname" class="md-nav__link">
    <span class="md-ellipsis">
      
        GetSyscallName
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getsyscallid" class="md-nav__link">
    <span class="md-ellipsis">
      
        GetSyscallID
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kernelsymbolstore" class="md-nav__link">
    <span class="md-ellipsis">
      
        KernelSymbolStore
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="KernelSymbolStore">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interface_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Interface
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#symbolinfo-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        SymbolInfo Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#resolvesymbolbyaddress" class="md-nav__link">
    <span class="md-ellipsis">
      
        ResolveSymbolByAddress
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getsymboladdress" class="md-nav__link">
    <span class="md-ellipsis">
      
        GetSymbolAddress
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resolvesymbolsbatch" class="md-nav__link">
    <span class="md-ellipsis">
      
        ResolveSymbolsBatch
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnsstore" class="md-nav__link">
    <span class="md-ellipsis">
      
        DNSStore
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DNSStore">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interface_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Interface
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dnsresponse-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        DNSResponse Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#getdnsresponse" class="md-nav__link">
    <span class="md-ellipsis">
      
        GetDNSResponse
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#health-and-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Health and Metrics
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Health and Metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#health-information" class="md-nav__link">
    <span class="md-ellipsis">
      
        Health Information
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metrics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Handling
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Error Handling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#error-classification" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Classification
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graceful-degradation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Graceful Degradation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        Advanced Usage
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#combining-multiple-stores" class="md-nav__link">
    <span class="md-ellipsis">
      
        Combining Multiple Stores
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#caching-store-references" class="md-nav__link">
    <span class="md-ellipsis">
      
        Caching Store References
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#writable-datastores" class="md-nav__link">
    <span class="md-ellipsis">
      
        Writable DataStores
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Writable DataStores">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick Start
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Concepts
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Summary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quick-reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick Reference
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      
        Best Practices
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Next Steps
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="datastore-api-reference">DataStore API Reference<a class="headerlink" href="#datastore-api-reference" title="Permanent link">&para;</a></h1>
<p>Complete API reference for Tracee's DataStore system. This provides read-only access to system state information for detectors.</p>
<h2 id="table-of-contents">Table of Contents<a class="headerlink" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#overview">Overview</a></li>
<li><a href="#core-concepts">Core Concepts</a></li>
<li><a href="#registry-interface">Registry Interface</a></li>
<li><a href="#processstore">ProcessStore</a></li>
<li><a href="#containerstore">ContainerStore</a></li>
<li><a href="#systemstore">SystemStore</a></li>
<li><a href="#syscallstore">SyscallStore</a></li>
<li><a href="#kernelsymbolstore">KernelSymbolStore</a></li>
<li><a href="#dnsstore">DNSStore</a></li>
<li><a href="#health-and-metrics">Health and Metrics</a></li>
<li><a href="#error-handling">Error Handling</a></li>
<li><a href="#advanced-usage">Advanced Usage</a></li>
<li><a href="#writable-datastores">Writable DataStores</a></li>
<li><a href="#summary">Summary</a></li>
</ol>
<hr />
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<h3 id="what-datastores-provide">What DataStores Provide<a class="headerlink" href="#what-datastores-provide" title="Permanent link">&para;</a></h3>
<p>DataStores give detectors read-only access to system state information collected by Tracee:</p>
<ul>
<li><strong>Process Tree</strong>: Process information, ancestry, and relationships</li>
<li><strong>Container Registry</strong>: Container metadata, Kubernetes pod information</li>
<li><strong>System Information</strong>: Immutable system details (architecture, kernel, OS)</li>
<li><strong>Syscall Mapping</strong>: Syscall ID  name conversion</li>
<li><strong>Kernel Symbols</strong>: Symbol resolution for addresses</li>
<li><strong>DNS Cache</strong>: DNS query responses</li>
</ul>
<h3 id="registry-pattern">Registry Pattern<a class="headerlink" href="#registry-pattern" title="Permanent link">&para;</a></h3>
<p>All datastores are accessed through a single <code>Registry</code> interface provided to detectors via <code>DetectorParams</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">Init</span><span class="p">(</span><span class="nx">params</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorParams</span><span class="p">)</span><span class="w"> </span><span class="kt">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">params</span><span class="p">.</span><span class="nx">DataStores</span><span class="w">  </span><span class="c1">// Registry interface</span>

<span class="w">    </span><span class="c1">// Access individual stores</span>
<span class="w">    </span><span class="nx">processStore</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Processes</span><span class="p">()</span>
<span class="w">    </span><span class="nx">containerStore</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Containers</span><span class="p">()</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="read-only-access-model">Read-Only Access Model<a class="headerlink" href="#read-only-access-model" title="Permanent link">&para;</a></h3>
<p>DataStores are <strong>read-only</strong> from the detector perspective:</p>
<ul>
<li> Query existing data</li>
<li> Iterate over collections</li>
<li> Check health and metrics</li>
<li> No writes or modifications</li>
<li> No data deletion</li>
</ul>
<p>The engine manages datastore lifecycle (initialization, updates, shutdown).</p>
<h3 id="thread-safety-guarantees">Thread Safety Guarantees<a class="headerlink" href="#thread-safety-guarantees" title="Permanent link">&para;</a></h3>
<p>All datastores are <strong>thread-safe</strong> for concurrent access:</p>
<ul>
<li>Multiple detectors can query the same store simultaneously</li>
<li>No locking required in detector code</li>
<li>Internal RWMutex protects shared state</li>
</ul>
<hr />
<h2 id="core-concepts">Core Concepts<a class="headerlink" href="#core-concepts" title="Permanent link">&para;</a></h2>
<h3 id="datastore-base-interface">DataStore Base Interface<a class="headerlink" href="#datastore-base-interface" title="Permanent link">&para;</a></h3>
<p>All datastores implement this base interface:</p>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">DataStore</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Name returns the name of this datastore</span>
<span class="w">    </span><span class="nx">Name</span><span class="p">()</span><span class="w"> </span><span class="kt">string</span>

<span class="w">    </span><span class="c1">// GetHealth returns the current health status</span>
<span class="w">    </span><span class="nx">GetHealth</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="nx">HealthInfo</span>

<span class="w">    </span><span class="c1">// GetMetrics returns operational metrics</span>
<span class="w">    </span><span class="nx">GetMetrics</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="nx">DataStoreMetrics</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="common-errors">Common Errors<a class="headerlink" href="#common-errors" title="Permanent link">&para;</a></h3>
<p>Sentinel errors for standard error cases:</p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="nx">ErrNotFound</span><span class="w">        </span><span class="p">=</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">New</span><span class="p">(</span><span class="s">&quot;entity not found&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nx">ErrStoreUnhealthy</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">New</span><span class="p">(</span><span class="s">&quot;datastore is unhealthy&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nx">ErrNotImplemented</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">New</span><span class="p">(</span><span class="s">&quot;operation not implemented&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nx">ErrInvalidArgument</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">New</span><span class="p">(</span><span class="s">&quot;invalid argument&quot;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
<p><strong>StoreError</strong> wraps errors with context:</p>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">StoreError</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">StoreName</span><span class="w"> </span><span class="kt">string</span><span class="w">  </span><span class="c1">// Which store</span>
<span class="w">    </span><span class="nx">Operation</span><span class="w"> </span><span class="kt">string</span><span class="w">  </span><span class="c1">// Which operation</span>
<span class="w">    </span><span class="nx">Err</span><span class="w">       </span><span class="kt">error</span><span class="w">   </span><span class="c1">// Underlying error</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="health-status">Health Status<a class="headerlink" href="#health-status" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">HealthStatus</span><span class="w"> </span><span class="kt">int</span>

<span class="kd">const</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="nx">HealthUnknown</span><span class="w">   </span><span class="nx">HealthStatus</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">iota</span><span class="w">  </span><span class="c1">// 0: Unknown state</span>
<span class="w">    </span><span class="nx">HealthHealthy</span><span class="w">                        </span><span class="c1">// 1: Operating normally</span>
<span class="w">    </span><span class="nx">HealthUnhealthy</span><span class="w">                      </span><span class="c1">// 2: Degraded or unavailable</span>
<span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="registry-interface">Registry Interface<a class="headerlink" href="#registry-interface" title="Permanent link">&para;</a></h2>
<h3 id="registry-methods">Registry Methods<a class="headerlink" href="#registry-methods" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">Registry</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Core stores (always return non-nil, but may be unavailable)</span>
<span class="w">    </span><span class="nx">Processes</span><span class="p">()</span><span class="w"> </span><span class="nx">ProcessStore</span>
<span class="w">    </span><span class="nx">Containers</span><span class="p">()</span><span class="w"> </span><span class="nx">ContainerStore</span>
<span class="w">    </span><span class="nx">KernelSymbols</span><span class="p">()</span><span class="w"> </span><span class="nx">KernelSymbolStore</span>
<span class="w">    </span><span class="nx">DNS</span><span class="p">()</span><span class="w"> </span><span class="nx">DNSStore</span>
<span class="w">    </span><span class="nx">System</span><span class="p">()</span><span class="w"> </span><span class="nx">SystemStore</span>
<span class="w">    </span><span class="nx">Syscalls</span><span class="p">()</span><span class="w"> </span><span class="nx">SyscallStore</span>

<span class="w">    </span><span class="c1">// Custom stores (returns error if not found)</span>
<span class="w">    </span><span class="nx">GetCustom</span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nx">DataStore</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// Introspection</span>
<span class="w">    </span><span class="nx">List</span><span class="p">()</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span>
<span class="w">    </span><span class="nx">IsAvailable</span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kt">bool</span>
<span class="w">    </span><span class="nx">GetMetadata</span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="nx">DataStoreMetadata</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>
<span class="w">    </span><span class="nx">GetMetrics</span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="nx">DataStoreMetrics</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Nil-Safety Guarantee:</strong></p>
<p>Accessor methods (<code>Processes()</code>, <code>Containers()</code>, etc.) <strong>never return nil</strong>. If a store is not registered or unavailable, they return a null object that:</p>
<ul>
<li>Implements the store interface</li>
<li>Returns <code>ErrStoreUnhealthy</code> for all operations</li>
<li>Has health status set to <code>HealthUnhealthy</code></li>
</ul>
<p>This eliminates nil checks and allows safe method chaining:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Always safe - no nil check needed</span>
<span class="nx">proc</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">Processes</span><span class="p">().</span><span class="nx">GetProcess</span><span class="p">(</span><span class="nx">entityID</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrStoreUnhealthy</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Store not available</span>
<span class="p">}</span>
<span class="k">if</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrNotFound</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Process not found</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="usage-examples">Usage Examples<a class="headerlink" href="#usage-examples" title="Permanent link">&para;</a></h3>
<p><strong>Basic access</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Direct access to core stores</span>
<span class="nx">processStore</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Processes</span><span class="p">()</span>
<span class="nx">containerStore</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Containers</span><span class="p">()</span>

<span class="c1">// Use immediately</span>
<span class="nx">proc</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">processStore</span><span class="p">.</span><span class="nx">GetProcess</span><span class="p">(</span><span class="nx">entityId</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrNotFound</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Process not found</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Check availability</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Check if optional store is available</span>
<span class="k">if</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">IsAvailable</span><span class="p">(</span><span class="s">&quot;system&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">systemStore</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">System</span><span class="p">()</span>
<span class="w">    </span><span class="nx">sysInfo</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">systemStore</span><span class="p">.</span><span class="nx">GetSystemInfo</span><span class="p">()</span>
<span class="w">    </span><span class="c1">// Use system info</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>List all stores</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">stores</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">List</span><span class="p">()</span>
<span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Infow</span><span class="p">(</span><span class="s">&quot;Available datastores&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;stores&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">stores</span><span class="p">)</span>
<span class="c1">// Output: [&quot;process&quot;, &quot;container&quot;, &quot;symbol&quot;, &quot;dns&quot;, &quot;system&quot;, &quot;syscall&quot;]</span>
</code></pre></div>
<p><strong>Get store metadata</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">metadata</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">GetMetadata</span><span class="p">(</span><span class="s">&quot;process&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Infow</span><span class="p">(</span><span class="s">&quot;Process store info&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;name&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">metadata</span><span class="p">.</span><span class="nx">Name</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;description&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">metadata</span><span class="p">.</span><span class="nx">Description</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="processstore">ProcessStore<a class="headerlink" href="#processstore" title="Permanent link">&para;</a></h2>
<h3 id="interface">Interface<a class="headerlink" href="#interface" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">ProcessStore</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">DataStore</span>

<span class="w">    </span><span class="c1">// GetProcess retrieves process information by entity ID</span>
<span class="w">    </span><span class="c1">// Returns ErrNotFound if not found</span>
<span class="w">    </span><span class="nx">GetProcess</span><span class="p">(</span><span class="nx">entityId</span><span class="w"> </span><span class="kt">uint32</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="nx">ProcessInfo</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// GetChildProcesses returns all child processes</span>
<span class="w">    </span><span class="c1">// Returns empty slice if no children</span>
<span class="w">    </span><span class="nx">GetChildProcesses</span><span class="p">(</span><span class="nx">entityId</span><span class="w"> </span><span class="kt">uint32</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="o">*</span><span class="nx">ProcessInfo</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// GetAncestry retrieves the ancestry chain up to maxDepth levels</span>
<span class="w">    </span><span class="c1">// [0] = process itself, [1] = parent, [2] = grandparent, etc.</span>
<span class="w">    </span><span class="c1">// Returns empty slice if maxDepth &lt;= 0 or process not found</span>
<span class="w">    </span><span class="nx">GetAncestry</span><span class="p">(</span><span class="nx">entityId</span><span class="w"> </span><span class="kt">uint32</span><span class="p">,</span><span class="w"> </span><span class="nx">maxDepth</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="o">*</span><span class="nx">ProcessInfo</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="processinfo-structure">ProcessInfo Structure<a class="headerlink" href="#processinfo-structure" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">ProcessInfo</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">EntityID</span><span class="w">  </span><span class="kt">uint32</span><span class="w">    </span><span class="c1">// Primary key (hash) - matches Event.Process.EntityId</span>
<span class="w">    </span><span class="nx">PID</span><span class="w">       </span><span class="kt">uint32</span><span class="w">    </span><span class="c1">// OS process ID (for display/logging)</span>
<span class="w">    </span><span class="nx">PPID</span><span class="w">      </span><span class="kt">uint32</span><span class="w">    </span><span class="c1">// OS parent PID (for display/logging)</span>
<span class="w">    </span><span class="nx">Name</span><span class="w">      </span><span class="kt">string</span><span class="w">    </span><span class="c1">// Binary name: &quot;bash&quot;</span>
<span class="w">    </span><span class="nx">Exe</span><span class="w">       </span><span class="kt">string</span><span class="w">    </span><span class="c1">// Full executable path: &quot;/usr/bin/bash&quot;</span>
<span class="w">    </span><span class="nx">StartTime</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="w"> </span><span class="c1">// Process start time</span>
<span class="w">    </span><span class="nx">UID</span><span class="w">       </span><span class="kt">uint32</span><span class="w">    </span><span class="c1">// User ID</span>
<span class="w">    </span><span class="nx">GID</span><span class="w">       </span><span class="kt">uint32</span><span class="w">    </span><span class="c1">// Group ID</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="methods">Methods<a class="headerlink" href="#methods" title="Permanent link">&para;</a></h3>
<h4 id="getprocess">GetProcess<a class="headerlink" href="#getprocess" title="Permanent link">&para;</a></h4>
<p>Retrieve process information by entity ID.</p>
<p><strong>Signature</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">GetProcess</span><span class="p">(</span><span class="nx">entityId</span><span class="w"> </span><span class="kt">uint32</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="nx">ProcessInfo</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>
</code></pre></div>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>entityId</code>: Process entity ID (hash from ProcessTree, matches <code>event.Workload.Process.EntityId</code>)</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>*ProcessInfo</code>: Process information if found</li>
<li><code>error</code>: <code>ErrNotFound</code> if not found, <code>nil</code> on success</li>
</ul>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">entityId</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">Workload</span><span class="p">.</span><span class="nx">Process</span><span class="p">.</span><span class="nx">EntityId</span><span class="p">.</span><span class="nx">Value</span>
<span class="nx">proc</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Processes</span><span class="p">().</span><span class="nx">GetProcess</span><span class="p">(</span><span class="nx">entityId</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrNotFound</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Warnw</span><span class="p">(</span><span class="s">&quot;Process not found&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;entity_id&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">entityId</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;failed to get process: %w&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Infow</span><span class="p">(</span><span class="s">&quot;Found process&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;pid&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">proc</span><span class="p">.</span><span class="nx">PID</span><span class="p">,</span><span class="w">           </span><span class="c1">// OS PID for logging</span>
<span class="w">    </span><span class="s">&quot;name&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">proc</span><span class="p">.</span><span class="nx">Name</span><span class="p">,</span><span class="w">         </span><span class="c1">// &quot;bash&quot;</span>
<span class="w">    </span><span class="s">&quot;exe&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">proc</span><span class="p">.</span><span class="nx">Exe</span><span class="p">,</span><span class="w">           </span><span class="c1">// &quot;/usr/bin/bash&quot;</span>
<span class="w">    </span><span class="s">&quot;uid&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">proc</span><span class="p">.</span><span class="nx">UID</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;start_time&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">proc</span><span class="p">.</span><span class="nx">StartTime</span><span class="p">)</span>
</code></pre></div>
<h4 id="getancestry">GetAncestry<a class="headerlink" href="#getancestry" title="Permanent link">&para;</a></h4>
<p>Retrieve process ancestry chain up to specified depth.</p>
<p><strong>Signature</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">GetAncestry</span><span class="p">(</span><span class="nx">entityId</span><span class="w"> </span><span class="kt">uint32</span><span class="p">,</span><span class="w"> </span><span class="nx">maxDepth</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="o">*</span><span class="nx">ProcessInfo</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>
</code></pre></div>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>entityId</code>: Process entity ID</li>
<li><code>maxDepth</code>: Maximum ancestry depth (typically 5)</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>[]*ProcessInfo</code>: Ancestry chain where <code>[0]</code> = process itself, <code>[1]</code> = parent, <code>[2]</code> = grandparent, etc.</li>
<li><code>error</code>: Error if query fails</li>
</ul>
<p><strong>Behavior</strong>:</p>
<ul>
<li>Returns empty slice if <code>maxDepth &lt;= 0</code></li>
<li>Returns empty slice if process not found</li>
<li>Stops if parent not found in tree</li>
<li>Stops if circular reference detected</li>
</ul>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">ancestry</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Processes</span><span class="p">().</span><span class="nx">GetAncestry</span><span class="p">(</span><span class="nx">entityId</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;failed to get ancestry: %w&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">if</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nx">ancestry</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Debugw</span><span class="p">(</span><span class="s">&quot;No ancestry found&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>

<span class="c1">// ancestry[0] is the process itself</span>
<span class="c1">// ancestry[1] is the parent</span>
<span class="c1">// ancestry[2] is the grandparent, etc.</span>

<span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="nx">ancestor</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">ancestry</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Debugw</span><span class="p">(</span><span class="s">&quot;Ancestor&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;level&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;pid&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">ancestor</span><span class="p">.</span><span class="nx">PID</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;name&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">ancestor</span><span class="p">.</span><span class="nx">Name</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;exe&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">ancestor</span><span class="p">.</span><span class="nx">Exe</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// Check if parent is suspicious</span>
<span class="k">if</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nx">ancestry</span><span class="p">)</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">parent</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">ancestry</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">strings</span><span class="p">.</span><span class="nx">Contains</span><span class="p">(</span><span class="nx">parent</span><span class="p">.</span><span class="nx">Exe</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;suspicious&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Trigger detection</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="getchildprocesses">GetChildProcesses<a class="headerlink" href="#getchildprocesses" title="Permanent link">&para;</a></h4>
<p>Retrieve all child processes of a given process.</p>
<p><strong>Signature</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">GetChildProcesses</span><span class="p">(</span><span class="nx">entityId</span><span class="w"> </span><span class="kt">uint32</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="o">*</span><span class="nx">ProcessInfo</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>
</code></pre></div>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>entityId</code>: Parent process entity ID</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>[]*ProcessInfo</code>: List of child processes (empty if no children)</li>
<li><code>error</code>: Error if query fails</li>
</ul>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">children</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Processes</span><span class="p">().</span><span class="nx">GetChildProcesses</span><span class="p">(</span><span class="nx">entityId</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span>
<span class="p">}</span>

<span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Infow</span><span class="p">(</span><span class="s">&quot;Process has children&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;count&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nx">children</span><span class="p">))</span>
<span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">child</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">children</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Debugw</span><span class="p">(</span><span class="s">&quot;Child process&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;pid&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">child</span><span class="p">.</span><span class="nx">PID</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;name&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">child</span><span class="p">.</span><span class="nx">Name</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;exe&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">child</span><span class="p">.</span><span class="nx">Exe</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="entityid-vs-pid">EntityID vs PID<a class="headerlink" href="#entityid-vs-pid" title="Permanent link">&para;</a></h3>
<div class="admonition important">
<p class="admonition-title">Always Use EntityID for Lookups</p>
<p><strong>EntityID</strong> is the primary key for process lookups, not PID.</p>
<p><strong>Why?</strong></p>
<ul>
<li>PIDs can be reused after a process exits</li>
<li>EntityID is unique for the lifetime of the process</li>
<li>EntityID matches <code>event.Workload.Process.EntityId</code></li>
</ul>
<p><strong>Usage</strong>:</p>
<ul>
<li><strong>EntityID</strong>: For all datastore lookups (<code>GetProcess</code>, <code>GetAncestry</code>, etc.)</li>
<li><strong>PID</strong>: Only for display, logging, and debugging</li>
</ul>
</div>
<p><strong>Correct</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Get EntityID from event</span>
<span class="nx">entityId</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">Workload</span><span class="p">.</span><span class="nx">Process</span><span class="p">.</span><span class="nx">EntityId</span><span class="p">.</span><span class="nx">Value</span>

<span class="c1">// Use EntityID for lookup</span>
<span class="nx">proc</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Processes</span><span class="p">().</span><span class="nx">GetProcess</span><span class="p">(</span><span class="nx">entityId</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrNotFound</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>

<span class="c1">// Use PID for logging only</span>
<span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Infow</span><span class="p">(</span><span class="s">&quot;Process found&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pid&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">proc</span><span class="p">.</span><span class="nx">PID</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">proc</span><span class="p">.</span><span class="nx">Name</span><span class="p">)</span>
</code></pre></div>
<p><strong>Incorrect</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">//  Don&#39;t use PID for lookups</span>
<span class="nx">pid</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">Workload</span><span class="p">.</span><span class="nx">Process</span><span class="p">.</span><span class="nx">Pid</span><span class="p">.</span><span class="nx">Value</span>
<span class="nx">proc</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Processes</span><span class="p">().</span><span class="nx">GetProcess</span><span class="p">(</span><span class="nb">uint32</span><span class="p">(</span><span class="nx">pid</span><span class="p">))</span><span class="w">  </span><span class="c1">// Wrong!</span>
</code></pre></div>
<hr />
<h2 id="containerstore">ContainerStore<a class="headerlink" href="#containerstore" title="Permanent link">&para;</a></h2>
<h3 id="interface_1">Interface<a class="headerlink" href="#interface_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">ContainerStore</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">DataStore</span>

<span class="w">    </span><span class="c1">// GetContainer retrieves container by ID</span>
<span class="w">    </span><span class="c1">// Returns ErrNotFound if not found</span>
<span class="w">    </span><span class="nx">GetContainer</span><span class="p">(</span><span class="nx">id</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="nx">ContainerInfo</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// GetContainerByName retrieves container by name</span>
<span class="w">    </span><span class="c1">// Returns ErrNotFound if not found</span>
<span class="w">    </span><span class="nx">GetContainerByName</span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="nx">ContainerInfo</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// ListContainers returns currently running containers, optionally filtered</span>
<span class="w">    </span><span class="c1">// Pass nil filter to return all containers</span>
<span class="w">    </span><span class="c1">// Returns empty slice if no containers match the filter</span>
<span class="w">    </span><span class="nx">ListContainers</span><span class="p">(</span><span class="nx">filter</span><span class="w"> </span><span class="o">*</span><span class="nx">ContainerFilter</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="o">*</span><span class="nx">ContainerInfo</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// ContainerFilter allows filtering containers by various criteria</span>
<span class="c1">// All fields are optional - nil values mean the field is not used for filtering</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">ContainerFilter</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Name</span><span class="w">    </span><span class="o">*</span><span class="kt">string</span><span class="w">  </span><span class="c1">// Filter by container name (exact match)</span>
<span class="w">    </span><span class="nx">Image</span><span class="w">   </span><span class="o">*</span><span class="kt">string</span><span class="w">  </span><span class="c1">// Filter by image name (exact match)</span>
<span class="w">    </span><span class="nx">Runtime</span><span class="w"> </span><span class="o">*</span><span class="kt">string</span><span class="w">  </span><span class="c1">// Filter by runtime (e.g., &quot;docker&quot;, &quot;containerd&quot;)</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Important:</strong> Container enrichment (<code>--enrichment container</code>) is required for container metadata:</p>
<p>When <code>--enrichment container</code> is enabled, Tracee:
1. Queries container runtimes (Docker, containerd, CRI-O, Podman) at userspace
2. Populates the container datastore with Name, Image, Pod info, etc.
3. Attaches this metadata to Event.Workload.Container fields</p>
<p><strong>Without <code>--enrichment container</code>:</strong>
- Only <code>Event.Workload.Container.Id</code> is available (from cgroup context)
- Container datastore queries will NOT return Name, Image, or Pod information
- Both Event fields and datastore will lack enriched metadata</p>
<p><strong>With <code>--enrichment container</code>:</strong>
- <code>Event.Workload.Container.Name</code>, <code>.Image</code>, <code>.Pod</code> are populated in events
- Container datastore can return full metadata when queried
- Detectors can choose: read from Event fields directly OR query datastore</p>
<p><strong>Why use datastore queries if enrichment is required anyway?</strong>
- More flexible error handling (e.g., handle not-found containers)
- Access to additional methods like <code>GetContainerByName()</code>
- Useful when container info is needed conditionally in detection logic</p>
<h3 id="containerinfo-structure">ContainerInfo Structure<a class="headerlink" href="#containerinfo-structure" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">ContainerInfo</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">ID</span><span class="w">          </span><span class="kt">string</span><span class="w">      </span><span class="c1">// Container ID</span>
<span class="w">    </span><span class="nx">Name</span><span class="w">        </span><span class="kt">string</span><span class="w">      </span><span class="c1">// Container name</span>
<span class="w">    </span><span class="nx">Image</span><span class="w">       </span><span class="kt">string</span><span class="w">      </span><span class="c1">// Container image</span>
<span class="w">    </span><span class="nx">ImageDigest</span><span class="w"> </span><span class="kt">string</span><span class="w">      </span><span class="c1">// Image digest (SHA256)</span>
<span class="w">    </span><span class="nx">Runtime</span><span class="w">     </span><span class="kt">string</span><span class="w">      </span><span class="c1">// Runtime: &quot;docker&quot;, &quot;containerd&quot;, &quot;crio&quot;</span>
<span class="w">    </span><span class="nx">StartTime</span><span class="w">   </span><span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="w">   </span><span class="c1">// Container start time</span>
<span class="w">    </span><span class="nx">Pod</span><span class="w">         </span><span class="o">*</span><span class="nx">K8sPodInfo</span><span class="w"> </span><span class="c1">// Kubernetes pod info (nil for non-K8s)</span>
<span class="p">}</span>

<span class="kd">type</span><span class="w"> </span><span class="nx">K8sPodInfo</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Name</span><span class="w">      </span><span class="kt">string</span><span class="w"> </span><span class="c1">// Pod name</span>
<span class="w">    </span><span class="nx">UID</span><span class="w">       </span><span class="kt">string</span><span class="w"> </span><span class="c1">// Pod UID</span>
<span class="w">    </span><span class="nx">Namespace</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="c1">// Pod namespace</span>
<span class="w">    </span><span class="nx">Sandbox</span><span class="w">   </span><span class="kt">bool</span><span class="w">   </span><span class="c1">// Whether this is a sandbox container</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="methods_1">Methods<a class="headerlink" href="#methods_1" title="Permanent link">&para;</a></h3>
<h4 id="getcontainer">GetContainer<a class="headerlink" href="#getcontainer" title="Permanent link">&para;</a></h4>
<p>Retrieve container information by container ID.</p>
<p><strong>Signature</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">GetContainer</span><span class="p">(</span><span class="nx">id</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="nx">ContainerInfo</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>
</code></pre></div>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>id</code>: Container ID (full ID or short form)</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>*ContainerInfo</code>: Container information if found</li>
<li><code>error</code>: <code>ErrNotFound</code> if not found, <code>nil</code> on success</li>
</ul>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">containerID</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">GetContainerID</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="nx">containerID</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Not a container event</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>

<span class="nx">container</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Containers</span><span class="p">().</span><span class="nx">GetContainer</span><span class="p">(</span><span class="nx">containerID</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrNotFound</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Warnw</span><span class="p">(</span><span class="s">&quot;Container not found&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;id&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">containerID</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;failed to get container: %w&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Infow</span><span class="p">(</span><span class="s">&quot;Container info&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;id&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">container</span><span class="p">.</span><span class="nx">ID</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;name&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">container</span><span class="p">.</span><span class="nx">Name</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;image&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">container</span><span class="p">.</span><span class="nx">Image</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;runtime&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">container</span><span class="p">.</span><span class="nx">Runtime</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;start_time&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">container</span><span class="p">.</span><span class="nx">StartTime</span><span class="p">)</span>

<span class="c1">// Access Kubernetes pod information</span>
<span class="k">if</span><span class="w"> </span><span class="nx">container</span><span class="p">.</span><span class="nx">Pod</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Infow</span><span class="p">(</span><span class="s">&quot;Pod info&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;name&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">container</span><span class="p">.</span><span class="nx">Pod</span><span class="p">.</span><span class="nx">Name</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;namespace&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">container</span><span class="p">.</span><span class="nx">Pod</span><span class="p">.</span><span class="nx">Namespace</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;uid&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">container</span><span class="p">.</span><span class="nx">Pod</span><span class="p">.</span><span class="nx">UID</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;sandbox&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">container</span><span class="p">.</span><span class="nx">Pod</span><span class="p">.</span><span class="nx">Sandbox</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="getcontainerbyname">GetContainerByName<a class="headerlink" href="#getcontainerbyname" title="Permanent link">&para;</a></h4>
<p>Retrieve container information by container name.</p>
<p><strong>Signature</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">GetContainerByName</span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="nx">ContainerInfo</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>
</code></pre></div>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>name</code>: Container name</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>*ContainerInfo</code>: Container information if found</li>
<li><code>error</code>: <code>ErrNotFound</code> if not found, <code>nil</code> on success</li>
</ul>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">container</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Containers</span><span class="p">().</span><span class="nx">GetContainerByName</span><span class="p">(</span><span class="s">&quot;web-server&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrNotFound</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Debugw</span><span class="p">(</span><span class="s">&quot;Container not found&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;web-server&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;failed to get container: %w&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Infow</span><span class="p">(</span><span class="s">&quot;Found container&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;id&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">container</span><span class="p">.</span><span class="nx">ID</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;image&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">container</span><span class="p">.</span><span class="nx">Image</span><span class="p">)</span>
</code></pre></div>
<h4 id="listcontainers">ListContainers<a class="headerlink" href="#listcontainers" title="Permanent link">&para;</a></h4>
<p>List all currently running containers, with optional filtering by name, image, or runtime using functional options.</p>
<p><strong>Signature</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">ListContainers</span><span class="p">(</span><span class="nx">opts</span><span class="w"> </span><span class="o">...</span><span class="nx">ContainerFilterOption</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="o">*</span><span class="nx">ContainerInfo</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>
</code></pre></div>
<p><strong>Filter Options</strong>:</p>
<ul>
<li><code>WithName(name string)</code>: Filter by exact container name match</li>
<li><code>WithImage(image string)</code>: Filter by exact image name match</li>
<li><code>WithRuntime(runtime string)</code>: Filter by runtime type ("docker", "containerd", "crio", "podman")</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>[]*ContainerInfo</code>: Slice of containers matching the filter (empty if none found)</li>
<li><code>error</code>: Error if the operation fails (never returns <code>ErrNotFound</code>)</li>
</ul>
<p><strong>Use Cases</strong>:</p>
<ul>
<li>Container discovery at startup</li>
<li>Periodic container inventory</li>
<li>Finding all containers running a specific image</li>
<li>Filtering containers by runtime type</li>
</ul>
<p><strong>Examples</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// List all containers (no filter)</span>
<span class="nx">containers</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Containers</span><span class="p">().</span><span class="nx">ListContainers</span><span class="p">()</span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;failed to list containers: %w&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// Filter by image</span>
<span class="nx">nginxContainers</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Containers</span><span class="p">().</span><span class="nx">ListContainers</span><span class="p">(</span>
<span class="w">    </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">WithImage</span><span class="p">(</span><span class="s">&quot;nginx:latest&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1">// Filter by multiple criteria (AND logic)</span>
<span class="nx">containers</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Containers</span><span class="p">().</span><span class="nx">ListContainers</span><span class="p">(</span>
<span class="w">    </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">WithImage</span><span class="p">(</span><span class="s">&quot;redis:7&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">WithRuntime</span><span class="p">(</span><span class="s">&quot;docker&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1">// Discover containers at detector initialization</span>
<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">Init</span><span class="p">(</span><span class="nx">params</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorParams</span><span class="p">)</span><span class="w"> </span><span class="kt">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">containers</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">params</span><span class="p">.</span><span class="nx">DataStores</span><span class="p">.</span><span class="nx">Containers</span><span class="p">().</span><span class="nx">ListContainers</span><span class="p">()</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;failed to discover containers: %w&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">// Initialize state based on existing containers</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">containers</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">d</span><span class="p">.</span><span class="nx">trackContainer</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Notes</strong>:</p>
<ul>
<li>Pass <code>nil</code> filter to list all containers</li>
<li>All filters use AND logic (must match all specified criteria)</li>
<li>Returns only live, running containers (excludes expired/dead)</li>
<li>Cleaner alternative to buffering <code>existing_container</code> events</li>
</ul>
<p><strong>Container Enrichment</strong>:</p>
<p>When <code>--enrichment container</code> flag is used, containers discovered at startup are automatically enriched with runtime metadata (name, image, digest, pod information). Without enrichment, only container ID and runtime are available from cgroup paths.</p>
<hr />
<h2 id="systemstore">SystemStore<a class="headerlink" href="#systemstore" title="Permanent link">&para;</a></h2>
<h3 id="interface_2">Interface<a class="headerlink" href="#interface_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">SystemStore</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">DataStore</span>

<span class="w">    </span><span class="c1">// GetSystemInfo returns immutable system information</span>
<span class="w">    </span><span class="c1">// Collected at Tracee startup, never changes</span>
<span class="w">    </span><span class="nx">GetSystemInfo</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="nx">SystemInfo</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="systeminfo-structure">SystemInfo Structure<a class="headerlink" href="#systeminfo-structure" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">SystemInfo</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Architecture</span><span class="w">    </span><span class="kt">string</span><span class="w">            </span><span class="c1">// CPU architecture: &quot;x86_64&quot;, &quot;aarch64&quot;</span>
<span class="w">    </span><span class="nx">KernelRelease</span><span class="w">   </span><span class="kt">string</span><span class="w">            </span><span class="c1">// Kernel version: &quot;5.15.0-generic&quot;</span>
<span class="w">    </span><span class="nx">Hostname</span><span class="w">        </span><span class="kt">string</span><span class="w">            </span><span class="c1">// System hostname</span>
<span class="w">    </span><span class="nx">BootTime</span><span class="w">        </span><span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="w">         </span><span class="c1">// System boot time</span>
<span class="w">    </span><span class="nx">TraceeStartTime</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="w">         </span><span class="c1">// When Tracee started</span>
<span class="w">    </span><span class="nx">OSName</span><span class="w">          </span><span class="kt">string</span><span class="w">            </span><span class="c1">// OS name: &quot;Ubuntu&quot;</span>
<span class="w">    </span><span class="nx">OSVersion</span><span class="w">       </span><span class="kt">string</span><span class="w">            </span><span class="c1">// OS version: &quot;22.04&quot;</span>
<span class="w">    </span><span class="nx">OSPrettyName</span><span class="w">    </span><span class="kt">string</span><span class="w">            </span><span class="c1">// Full OS name: &quot;Ubuntu 22.04 LTS&quot;</span>
<span class="w">    </span><span class="nx">TraceeVersion</span><span class="w">   </span><span class="kt">string</span><span class="w">            </span><span class="c1">// Tracee version string</span>
<span class="w">    </span><span class="nx">InitNamespaces</span><span class="w">  </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">uint32</span><span class="w"> </span><span class="c1">// Init process namespaces</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="methods_2">Methods<a class="headerlink" href="#methods_2" title="Permanent link">&para;</a></h3>
<h4 id="getsysteminfo">GetSystemInfo<a class="headerlink" href="#getsysteminfo" title="Permanent link">&para;</a></h4>
<p>Retrieve immutable system information.</p>
<p><strong>Signature</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">GetSystemInfo</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="nx">SystemInfo</span>
</code></pre></div>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>*SystemInfo</code>: System information (never nil if store available)</li>
</ul>
<p><strong>Characteristics</strong>:</p>
<ul>
<li><strong>Immutable</strong>: Data never changes during Tracee lifetime</li>
<li><strong>Fast</strong>: No lookup, just returns cached data</li>
<li><strong>Always available</strong>: Returns immediately with no errors</li>
</ul>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// System store always returns non-nil (per registry contract)</span>
<span class="c1">// Check IsAvailable() if you need to verify store is ready</span>
<span class="nx">systemStore</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">System</span><span class="p">()</span>
<span class="nx">sysInfo</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">systemStore</span><span class="p">.</span><span class="nx">GetSystemInfo</span><span class="p">()</span>

<span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Infow</span><span class="p">(</span><span class="s">&quot;System information&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;arch&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">sysInfo</span><span class="p">.</span><span class="nx">Architecture</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;kernel&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">sysInfo</span><span class="p">.</span><span class="nx">KernelRelease</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;os&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">sysInfo</span><span class="p">.</span><span class="nx">OSPrettyName</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;hostname&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">sysInfo</span><span class="p">.</span><span class="nx">Hostname</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;tracee_version&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">sysInfo</span><span class="p">.</span><span class="nx">TraceeVersion</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;boot_time&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">sysInfo</span><span class="p">.</span><span class="nx">BootTime</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;tracee_start&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">sysInfo</span><span class="p">.</span><span class="nx">TraceeStartTime</span><span class="p">)</span>

<span class="c1">// Check architecture for platform-specific logic</span>
<span class="k">if</span><span class="w"> </span><span class="nx">sysInfo</span><span class="p">.</span><span class="nx">Architecture</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;x86_64&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// x86-specific detection logic</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">sysInfo</span><span class="p">.</span><span class="nx">Architecture</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;aarch64&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ARM-specific detection logic</span>
<span class="p">}</span>

<span class="c1">// Add to detection metadata</span>
<span class="nx">detection</span><span class="p">.</span><span class="nx">Data</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">append</span><span class="p">(</span><span class="nx">detection</span><span class="p">.</span><span class="nx">Data</span><span class="p">,</span>
<span class="w">    </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewStringValue</span><span class="p">(</span><span class="s">&quot;system_arch&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">sysInfo</span><span class="p">.</span><span class="nx">Architecture</span><span class="p">),</span>
<span class="w">    </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewStringValue</span><span class="p">(</span><span class="s">&quot;kernel_version&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">sysInfo</span><span class="p">.</span><span class="nx">KernelRelease</span><span class="p">),</span>
<span class="w">    </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewStringValue</span><span class="p">(</span><span class="s">&quot;os&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">sysInfo</span><span class="p">.</span><span class="nx">OSPrettyName</span><span class="p">))</span>
</code></pre></div>
<hr />
<h2 id="syscallstore">SyscallStore<a class="headerlink" href="#syscallstore" title="Permanent link">&para;</a></h2>
<h3 id="interface_3">Interface<a class="headerlink" href="#interface_3" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">SyscallStore</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">DataStore</span>

<span class="w">    </span><span class="c1">// GetSyscallName returns syscall name for given ID</span>
<span class="w">    </span><span class="c1">// Returns ErrNotFound if not found</span>
<span class="w">    </span><span class="nx">GetSyscallName</span><span class="p">(</span><span class="nx">id</span><span class="w"> </span><span class="kt">int32</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// GetSyscallID returns syscall ID for given name</span>
<span class="w">    </span><span class="c1">// Returns ErrNotFound if not found</span>
<span class="w">    </span><span class="nx">GetSyscallID</span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">int32</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="methods_3">Methods<a class="headerlink" href="#methods_3" title="Permanent link">&para;</a></h3>
<h4 id="getsyscallname">GetSyscallName<a class="headerlink" href="#getsyscallname" title="Permanent link">&para;</a></h4>
<p>Get syscall name from syscall ID.</p>
<p><strong>Signature</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">GetSyscallName</span><span class="p">(</span><span class="nx">id</span><span class="w"> </span><span class="kt">int32</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>
</code></pre></div>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>id</code>: Syscall ID (architecture-specific)</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>string</code>: Syscall name if found</li>
<li><code>error</code>: <code>ErrNotFound</code> if not found, <code>nil</code> on success</li>
</ul>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">syscallID</span><span class="p">,</span><span class="w"> </span><span class="nx">found</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">GetData</span><span class="p">[</span><span class="kt">int32</span><span class="p">](</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;syscall_id&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">found</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>

<span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Syscalls</span><span class="p">().</span><span class="nx">GetSyscallName</span><span class="p">(</span><span class="nx">syscallID</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrNotFound</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Debugw</span><span class="p">(</span><span class="s">&quot;Unknown syscall&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;id&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">syscallID</span><span class="p">)</span>
<span class="w">    </span><span class="nx">name</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">&quot;syscall_%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">syscallID</span><span class="p">)</span>
<span class="p">}</span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">!</span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrNotFound</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;failed to get syscall name: %w&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Infow</span><span class="p">(</span><span class="s">&quot;Syscall detected&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;id&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">syscallID</span><span class="p">)</span>
</code></pre></div>
<h4 id="getsyscallid">GetSyscallID<a class="headerlink" href="#getsyscallid" title="Permanent link">&para;</a></h4>
<p>Get syscall ID from syscall name.</p>
<p><strong>Signature</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">GetSyscallID</span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">int32</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>
</code></pre></div>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>name</code>: Syscall name (e.g., "execve", "openat")</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>int32</code>: Syscall ID if found</li>
<li><code>error</code>: <code>ErrNotFound</code> if not found, <code>nil</code> on success</li>
</ul>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">id</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Syscalls</span><span class="p">().</span><span class="nx">GetSyscallID</span><span class="p">(</span><span class="s">&quot;execve&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Infow</span><span class="p">(</span><span class="s">&quot;Syscall&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;execve&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;id&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">id</span><span class="p">)</span>
<span class="w">    </span><span class="c1">// ID = 59 on x86_64</span>
<span class="p">}</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Architecture-Specific</p>
<p>Syscall IDs are <strong>architecture-specific</strong>:</p>
<ul>
<li>ID 59 = <code>execve</code> on x86_64</li>
<li>ID 221 = <code>execve</code> on ARM64</li>
</ul>
<p>The store returns IDs for the <strong>current architecture</strong> only.</p>
</div>
<hr />
<h2 id="kernelsymbolstore">KernelSymbolStore<a class="headerlink" href="#kernelsymbolstore" title="Permanent link">&para;</a></h2>
<h3 id="interface_4">Interface<a class="headerlink" href="#interface_4" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">KernelSymbolStore</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">DataStore</span>

<span class="w">    </span><span class="c1">// ResolveSymbolByAddress resolves address to symbols</span>
<span class="w">    </span><span class="c1">// Returns multiple symbols if aliases exist</span>
<span class="w">    </span><span class="c1">// Returns ErrNotFound if address cannot be resolved</span>
<span class="w">    </span><span class="nx">ResolveSymbolByAddress</span><span class="p">(</span><span class="nx">addr</span><span class="w"> </span><span class="kt">uint64</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="o">*</span><span class="nx">SymbolInfo</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// GetSymbolAddress returns address of named symbol</span>
<span class="w">    </span><span class="c1">// If multiple symbols exist, returns first one found</span>
<span class="w">    </span><span class="c1">// Returns ErrNotFound if symbol not found</span>
<span class="w">    </span><span class="nx">GetSymbolAddress</span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">uint64</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// ResolveSymbolsBatch resolves multiple addresses at once</span>
<span class="w">    </span><span class="c1">// Returns map of address -&gt; symbols for found addresses</span>
<span class="w">    </span><span class="c1">// Missing addresses are not included in result</span>
<span class="w">    </span><span class="nx">ResolveSymbolsBatch</span><span class="p">(</span><span class="nx">addrs</span><span class="w"> </span><span class="p">[]</span><span class="kt">uint64</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kd">map</span><span class="p">[</span><span class="kt">uint64</span><span class="p">][]</span><span class="o">*</span><span class="nx">SymbolInfo</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="symbolinfo-structure">SymbolInfo Structure<a class="headerlink" href="#symbolinfo-structure" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">SymbolInfo</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Name</span><span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="c1">// Symbol name: &quot;do_sys_open&quot;</span>
<span class="w">    </span><span class="nx">Address</span><span class="w"> </span><span class="kt">uint64</span><span class="w"> </span><span class="c1">// Symbol address: 0xffffffff81234567</span>
<span class="w">    </span><span class="nx">Module</span><span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="c1">// Module name: &quot;system&quot; for kernel, or module name</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="methods_4">Methods<a class="headerlink" href="#methods_4" title="Permanent link">&para;</a></h3>
<h4 id="resolvesymbolbyaddress">ResolveSymbolByAddress<a class="headerlink" href="#resolvesymbolbyaddress" title="Permanent link">&para;</a></h4>
<p>Resolve kernel address to symbol information.</p>
<p><strong>Signature</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">ResolveSymbolByAddress</span><span class="p">(</span><span class="nx">addr</span><span class="w"> </span><span class="kt">uint64</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="o">*</span><span class="nx">SymbolInfo</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>
</code></pre></div>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>addr</code>: Kernel address to resolve</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>[]*SymbolInfo</code>: List of symbols at this address (usually one, but aliases possible)</li>
<li><code>error</code>: <code>ErrNotFound</code> if address cannot be resolved</li>
</ul>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">address</span><span class="p">,</span><span class="w"> </span><span class="nx">found</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">GetData</span><span class="p">[</span><span class="kt">uint64</span><span class="p">](</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;address&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">found</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>

<span class="nx">symbols</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">KernelSymbols</span><span class="p">().</span><span class="nx">ResolveSymbolByAddress</span><span class="p">(</span><span class="nx">address</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrNotFound</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Warnw</span><span class="p">(</span><span class="s">&quot;Unknown address&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;addr&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">&quot;0x%x&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">address</span><span class="p">))</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span>
<span class="p">}</span>

<span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">symbol</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">symbols</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Infow</span><span class="p">(</span><span class="s">&quot;Symbol&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;name&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">symbol</span><span class="p">.</span><span class="nx">Name</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;address&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">&quot;0x%x&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">symbol</span><span class="p">.</span><span class="nx">Address</span><span class="p">),</span>
<span class="w">        </span><span class="s">&quot;module&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">symbol</span><span class="p">.</span><span class="nx">Module</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// Check if this is a kernel module (rootkit detection)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">symbol</span><span class="p">.</span><span class="nx">Module</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;system&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Potential hook detected</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">{{</span>
<span class="w">            </span><span class="nx">Data</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">EventValue</span><span class="p">{</span>
<span class="w">                </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewStringValue</span><span class="p">(</span><span class="s">&quot;symbol&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">symbol</span><span class="p">.</span><span class="nx">Name</span><span class="p">),</span>
<span class="w">                </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewStringValue</span><span class="p">(</span><span class="s">&quot;module&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">symbol</span><span class="p">.</span><span class="nx">Module</span><span class="p">),</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">        </span><span class="p">}},</span><span class="w"> </span><span class="kc">nil</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="getsymboladdress">GetSymbolAddress<a class="headerlink" href="#getsymboladdress" title="Permanent link">&para;</a></h4>
<p>Get the address of a named kernel symbol.</p>
<p><strong>Signature</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">GetSymbolAddress</span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">uint64</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>
</code></pre></div>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>name</code>: Symbol name (e.g., "do_sys_open")</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>uint64</code>: Symbol address</li>
<li><code>error</code>: <code>ErrNotFound</code> if symbol not found</li>
</ul>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">addr</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">KernelSymbols</span><span class="p">().</span><span class="nx">GetSymbolAddress</span><span class="p">(</span><span class="s">&quot;do_sys_open&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrNotFound</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Warnw</span><span class="p">(</span><span class="s">&quot;Symbol not found&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;do_sys_open&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span>
<span class="p">}</span>

<span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Infow</span><span class="p">(</span><span class="s">&quot;Symbol address&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;name&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;do_sys_open&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;address&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">&quot;0x%x&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">addr</span><span class="p">))</span>
</code></pre></div>
<h4 id="resolvesymbolsbatch">ResolveSymbolsBatch<a class="headerlink" href="#resolvesymbolsbatch" title="Permanent link">&para;</a></h4>
<p>Resolve multiple addresses in a single call (more efficient).</p>
<p><strong>Signature</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">ResolveSymbolsBatch</span><span class="p">(</span><span class="nx">addrs</span><span class="w"> </span><span class="p">[]</span><span class="kt">uint64</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kd">map</span><span class="p">[</span><span class="kt">uint64</span><span class="p">][]</span><span class="o">*</span><span class="nx">SymbolInfo</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>
</code></pre></div>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>addrs</code>: List of addresses to resolve</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>map[uint64][]*SymbolInfo</code>: Map of address to symbols (only includes found addresses)</li>
<li><code>error</code>: Error if batch operation fails</li>
</ul>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Get syscall table addresses from event</span>
<span class="nx">addresses</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">[]</span><span class="kt">uint64</span><span class="p">{</span><span class="mh">0xffffffff81234567</span><span class="p">,</span><span class="w"> </span><span class="mh">0xffffffff81abcdef</span><span class="p">,</span><span class="w"> </span><span class="o">...</span><span class="p">}</span>

<span class="c1">// Batch resolve (more efficient than individual lookups)</span>
<span class="nx">symbols</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">KernelSymbols</span><span class="p">().</span><span class="nx">ResolveSymbolsBatch</span><span class="p">(</span><span class="nx">addresses</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span>
<span class="p">}</span>

<span class="c1">// Process results</span>
<span class="k">for</span><span class="w"> </span><span class="nx">addr</span><span class="p">,</span><span class="w"> </span><span class="nx">symbolList</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">symbols</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">symbol</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">symbolList</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Infow</span><span class="p">(</span><span class="s">&quot;Resolved&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s">&quot;address&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">&quot;0x%x&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">addr</span><span class="p">),</span>
<span class="w">            </span><span class="s">&quot;symbol&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">symbol</span><span class="p">.</span><span class="nx">Name</span><span class="p">,</span>
<span class="w">            </span><span class="s">&quot;module&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">symbol</span><span class="p">.</span><span class="nx">Module</span><span class="p">)</span>

<span class="w">        </span><span class="c1">// Detect hooks by checking module</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">symbol</span><span class="p">.</span><span class="nx">Module</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;system&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Hook detected</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Check for addresses that couldn&#39;t be resolved</span>
<span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">addr</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">addresses</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">found</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">symbols</span><span class="p">[</span><span class="nx">addr</span><span class="p">];</span><span class="w"> </span><span class="p">!</span><span class="nx">found</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Warnw</span><span class="p">(</span><span class="s">&quot;Address not resolved&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;addr&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">&quot;0x%x&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">addr</span><span class="p">))</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="dnsstore">DNSStore<a class="headerlink" href="#dnsstore" title="Permanent link">&para;</a></h2>
<h3 id="interface_5">Interface<a class="headerlink" href="#interface_5" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">DNSStore</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">DataStore</span>

<span class="w">    </span><span class="c1">// GetDNSResponse retrieves cached DNS response</span>
<span class="w">    </span><span class="c1">// Returns ErrNotFound if no cached response found</span>
<span class="w">    </span><span class="nx">GetDNSResponse</span><span class="p">(</span><span class="nx">query</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="nx">DNSResponse</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="dnsresponse-structure">DNSResponse Structure<a class="headerlink" href="#dnsresponse-structure" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">DNSResponse</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Query</span><span class="w">   </span><span class="kt">string</span><span class="w">   </span><span class="c1">// DNS query (domain name)</span>
<span class="w">    </span><span class="nx">IPs</span><span class="w">     </span><span class="p">[]</span><span class="kt">string</span><span class="w"> </span><span class="c1">// Resolved IP addresses</span>
<span class="w">    </span><span class="nx">Domains</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="w"> </span><span class="c1">// Resolved domains (for reverse lookups)</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="methods_5">Methods<a class="headerlink" href="#methods_5" title="Permanent link">&para;</a></h3>
<h4 id="getdnsresponse">GetDNSResponse<a class="headerlink" href="#getdnsresponse" title="Permanent link">&para;</a></h4>
<p>Retrieve cached DNS query response.</p>
<p><strong>Signature</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">GetDNSResponse</span><span class="p">(</span><span class="nx">query</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="nx">DNSResponse</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>
</code></pre></div>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>query</code>: DNS query (domain name)</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>*DNSResponse</code>: DNS response if cached</li>
<li><code>error</code>: <code>ErrNotFound</code> if not cached, <code>nil</code> on success</li>
</ul>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">domain</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;malicious.example.com&quot;</span>
<span class="nx">response</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">DNS</span><span class="p">().</span><span class="nx">GetDNSResponse</span><span class="p">(</span><span class="nx">domain</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrNotFound</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Debugw</span><span class="p">(</span><span class="s">&quot;No DNS cache entry&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;domain&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">domain</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;failed to query DNS cache: %w&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Infow</span><span class="p">(</span><span class="s">&quot;DNS cache hit&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;domain&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">domain</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;ips&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">IPs</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;resolved_domains&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">Domains</span><span class="p">)</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Cache Scope</p>
<p>The DNS cache only contains queries observed by Tracee while running.
It does <strong>not</strong> contain historical or system-wide DNS data.</p>
</div>
<hr />
<h2 id="health-and-metrics">Health and Metrics<a class="headerlink" href="#health-and-metrics" title="Permanent link">&para;</a></h2>
<h3 id="health-information">Health Information<a class="headerlink" href="#health-information" title="Permanent link">&para;</a></h3>
<p>All datastores expose health status:</p>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">HealthInfo</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Status</span><span class="w">    </span><span class="nx">HealthStatus</span><span class="w"> </span><span class="c1">// Current health status</span>
<span class="w">    </span><span class="nx">Message</span><span class="w">   </span><span class="kt">string</span><span class="w">       </span><span class="c1">// Empty if healthy, error details if not</span>
<span class="w">    </span><span class="nx">LastCheck</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="w">    </span><span class="c1">// When health was last checked</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">processStore</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Processes</span><span class="p">()</span>
<span class="nx">health</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">processStore</span><span class="p">.</span><span class="nx">GetHealth</span><span class="p">()</span>

<span class="k">if</span><span class="w"> </span><span class="nx">health</span><span class="p">.</span><span class="nx">Status</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">HealthHealthy</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Warnw</span><span class="p">(</span><span class="s">&quot;Process store unhealthy&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;status&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">health</span><span class="p">.</span><span class="nx">Status</span><span class="p">.</span><span class="nx">String</span><span class="p">(),</span>
<span class="w">        </span><span class="s">&quot;message&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">health</span><span class="p">.</span><span class="nx">Message</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;last_check&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">health</span><span class="p">.</span><span class="nx">LastCheck</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// Decide whether to continue or fail</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">health</span><span class="p">.</span><span class="nx">Status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">HealthUnhealthy</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;process store unhealthy: %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">health</span><span class="p">.</span><span class="nx">Message</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="metrics">Metrics<a class="headerlink" href="#metrics" title="Permanent link">&para;</a></h3>
<p>Datastores expose operational metrics:</p>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">DataStoreMetrics</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">ItemCount</span><span class="w">    </span><span class="kt">int64</span><span class="w">     </span><span class="c1">// Number of items in store</span>
<span class="w">    </span><span class="nx">SuccessCount</span><span class="w"> </span><span class="kt">uint64</span><span class="w">    </span><span class="c1">// Successful requests</span>
<span class="w">    </span><span class="nx">ErrorCount</span><span class="w">   </span><span class="kt">uint64</span><span class="w">    </span><span class="c1">// Failed requests</span>
<span class="w">    </span><span class="nx">CacheHits</span><span class="w">    </span><span class="kt">uint64</span><span class="w">    </span><span class="c1">// Cache hits (if applicable)</span>
<span class="w">    </span><span class="nx">CacheMisses</span><span class="w">  </span><span class="kt">uint64</span><span class="w">    </span><span class="c1">// Cache misses (if applicable)</span>
<span class="w">    </span><span class="nx">LastAccess</span><span class="w">   </span><span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="w"> </span><span class="c1">// Last access time</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">processStore</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Processes</span><span class="p">()</span>
<span class="nx">metrics</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">processStore</span><span class="p">.</span><span class="nx">GetMetrics</span><span class="p">()</span>

<span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Infow</span><span class="p">(</span><span class="s">&quot;Process store metrics&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;item_count&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">metrics</span><span class="p">.</span><span class="nx">ItemCount</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;success_count&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">metrics</span><span class="p">.</span><span class="nx">SuccessCount</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;error_count&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">metrics</span><span class="p">.</span><span class="nx">ErrorCount</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;cache_hits&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">metrics</span><span class="p">.</span><span class="nx">CacheHits</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;cache_misses&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">metrics</span><span class="p">.</span><span class="nx">CacheMisses</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;hit_rate&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">float64</span><span class="p">(</span><span class="nx">metrics</span><span class="p">.</span><span class="nx">CacheHits</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">float64</span><span class="p">(</span><span class="nx">metrics</span><span class="p">.</span><span class="nx">CacheHits</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">metrics</span><span class="p">.</span><span class="nx">CacheMisses</span><span class="p">),</span>
<span class="w">    </span><span class="s">&quot;last_access&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">metrics</span><span class="p">.</span><span class="nx">LastAccess</span><span class="p">)</span>

<span class="c1">// Alert if error rate is high</span>
<span class="k">if</span><span class="w"> </span><span class="nx">metrics</span><span class="p">.</span><span class="nx">ErrorCount</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">errorRate</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">float64</span><span class="p">(</span><span class="nx">metrics</span><span class="p">.</span><span class="nx">ErrorCount</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">float64</span><span class="p">(</span><span class="nx">metrics</span><span class="p">.</span><span class="nx">SuccessCount</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">metrics</span><span class="p">.</span><span class="nx">ErrorCount</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">errorRate</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="mf">0.01</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Warnw</span><span class="p">(</span><span class="s">&quot;High error rate&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;rate&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">errorRate</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="error-handling">Error Handling<a class="headerlink" href="#error-handling" title="Permanent link">&para;</a></h2>
<h3 id="error-classification">Error Classification<a class="headerlink" href="#error-classification" title="Permanent link">&para;</a></h3>
<p><strong>Not Found (common, non-error)</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">proc</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Processes</span><span class="p">().</span><span class="nx">GetProcess</span><span class="p">(</span><span class="nx">entityId</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrNotFound</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Process not in tree (maybe exited) - this is normal</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Debugw</span><span class="p">(</span><span class="s">&quot;Process not found&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;entity_id&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">entityId</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span><span class="w">  </span><span class="c1">// Skip gracefully</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Store Errors (critical)</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">symbols</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">KernelSymbols</span><span class="p">().</span><span class="nx">ResolveSymbolByAddress</span><span class="p">(</span><span class="nx">addr</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Check for specific error types</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrNotFound</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Warnw</span><span class="p">(</span><span class="s">&quot;Address not in symbol table&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;addr&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">addr</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span><span class="w">  </span><span class="c1">// Skip gracefully</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrStoreUnhealthy</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Store is unhealthy - critical</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;symbol store unhealthy: %w&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Other error - log and return</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;symbol resolution failed: %w&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="graceful-degradation">Graceful Degradation<a class="headerlink" href="#graceful-degradation" title="Permanent link">&para;</a></h3>
<p>Always handle missing/unavailable stores gracefully:</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">OnEvent</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">Context</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="w"> </span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Event</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Check if optional store is available (use IsAvailable for readiness check)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">IsAvailable</span><span class="p">(</span><span class="s">&quot;system&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">systemStore</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">System</span><span class="p">()</span>
<span class="w">        </span><span class="nx">sysInfo</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">systemStore</span><span class="p">.</span><span class="nx">GetSystemInfo</span><span class="p">()</span>
<span class="w">        </span><span class="c1">// Use system info for enrichment</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Debugw</span><span class="p">(</span><span class="s">&quot;System store unavailable, continuing without system info&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="c1">// Continue detection without system info</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Check for optional data</span>
<span class="w">    </span><span class="nx">container</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Containers</span><span class="p">().</span><span class="nx">GetContainer</span><span class="p">(</span><span class="nx">containerID</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrNotFound</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Debugw</span><span class="p">(</span><span class="s">&quot;Container not found, continuing without container context&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="c1">// Continue detection without container info</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;container store error: %w&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Use container info for enrichment</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Core detection logic...</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="advanced-usage">Advanced Usage<a class="headerlink" href="#advanced-usage" title="Permanent link">&para;</a></h2>
<h3 id="combining-multiple-stores">Combining Multiple Stores<a class="headerlink" href="#combining-multiple-stores" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">ContainerEscapeDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">analyzeEscape</span><span class="p">(</span><span class="nx">event</span><span class="w"> </span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Event</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Get process information</span>
<span class="w">    </span><span class="nx">entityId</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">Workload</span><span class="p">.</span><span class="nx">Process</span><span class="p">.</span><span class="nx">EntityId</span><span class="p">.</span><span class="nx">Value</span>
<span class="w">    </span><span class="nx">proc</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Processes</span><span class="p">().</span><span class="nx">GetProcess</span><span class="p">(</span><span class="nx">entityId</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrNotFound</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;process store error: %w&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Get process ancestry</span>
<span class="w">    </span><span class="nx">ancestry</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Processes</span><span class="p">().</span><span class="nx">GetAncestry</span><span class="p">(</span><span class="nx">entityId</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Get container information</span>
<span class="w">    </span><span class="nx">containerID</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">GetContainerID</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span>
<span class="w">    </span><span class="nx">container</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Containers</span><span class="p">().</span><span class="nx">GetContainer</span><span class="p">(</span><span class="nx">containerID</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrNotFound</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;container store error: %w&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Get system information</span>
<span class="w">    </span><span class="nx">sysInfo</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">System</span><span class="p">().</span><span class="nx">GetSystemInfo</span><span class="p">()</span>

<span class="w">    </span><span class="c1">// Analyze all together</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">detectEscape</span><span class="p">(</span><span class="nx">proc</span><span class="p">,</span><span class="w"> </span><span class="nx">ancestry</span><span class="p">,</span><span class="w"> </span><span class="nx">container</span><span class="p">,</span><span class="w"> </span><span class="nx">sysInfo</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">{{</span>
<span class="w">            </span><span class="nx">Data</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">EventValue</span><span class="p">{</span>
<span class="w">                </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewStringValue</span><span class="p">(</span><span class="s">&quot;process&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">proc</span><span class="p">.</span><span class="nx">Exe</span><span class="p">),</span>
<span class="w">                </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewStringValue</span><span class="p">(</span><span class="s">&quot;container&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">container</span><span class="p">.</span><span class="nx">Name</span><span class="p">),</span>
<span class="w">                </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewStringValue</span><span class="p">(</span><span class="s">&quot;kernel&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">sysInfo</span><span class="p">.</span><span class="nx">KernelRelease</span><span class="p">),</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">        </span><span class="p">}},</span><span class="w"> </span><span class="kc">nil</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="caching-store-references">Caching Store References<a class="headerlink" href="#caching-store-references" title="Permanent link">&para;</a></h3>
<p>Cache store references in Init() for better performance:</p>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">MyDetector</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">logger</span><span class="w">         </span><span class="nx">detection</span><span class="p">.</span><span class="nx">Logger</span>
<span class="w">    </span><span class="nx">processStore</span><span class="w">   </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ProcessStore</span>
<span class="w">    </span><span class="nx">containerStore</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ContainerStore</span>
<span class="w">    </span><span class="nx">systemStore</span><span class="w">    </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">SystemStore</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">Init</span><span class="p">(</span><span class="nx">params</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorParams</span><span class="p">)</span><span class="w"> </span><span class="kt">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">params</span><span class="p">.</span><span class="nx">Logger</span>

<span class="w">    </span><span class="c1">// Cache store references (registry always returns non-nil stores)</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">processStore</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">params</span><span class="p">.</span><span class="nx">DataStores</span><span class="p">.</span><span class="nx">Processes</span><span class="p">()</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">containerStore</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">params</span><span class="p">.</span><span class="nx">DataStores</span><span class="p">.</span><span class="nx">Containers</span><span class="p">()</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">systemStore</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">params</span><span class="p">.</span><span class="nx">DataStores</span><span class="p">.</span><span class="nx">System</span><span class="p">()</span>

<span class="w">    </span><span class="c1">// Validate required stores are available</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">params</span><span class="p">.</span><span class="nx">DataStores</span><span class="p">.</span><span class="nx">IsAvailable</span><span class="p">(</span><span class="s">&quot;process&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;process store required but not available&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Warn about optional stores</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">params</span><span class="p">.</span><span class="nx">DataStores</span><span class="p">.</span><span class="nx">IsAvailable</span><span class="p">(</span><span class="s">&quot;system&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Warnw</span><span class="p">(</span><span class="s">&quot;System store unavailable, some features disabled&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">OnEvent</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">Context</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="w"> </span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Event</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Use cached references (no registry lookup)</span>
<span class="w">    </span><span class="nx">proc</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">processStore</span><span class="p">.</span><span class="nx">GetProcess</span><span class="p">(</span><span class="nx">entityId</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrNotFound</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">container</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">containerStore</span><span class="p">.</span><span class="nx">GetContainer</span><span class="p">(</span><span class="nx">containerID</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrNotFound</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// System store always available (cached reference)</span>
<span class="w">    </span><span class="nx">sysInfo</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">systemStore</span><span class="p">.</span><span class="nx">GetSystemInfo</span><span class="p">()</span>
<span class="w">    </span><span class="c1">// Use system info</span>

<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="writable-datastores">Writable DataStores<a class="headerlink" href="#writable-datastores" title="Permanent link">&para;</a></h2>
<p>Writable datastores allow detectors to store and share custom data, enabling use cases like:
- <strong>Threat intelligence</strong>: Store IP/domain reputation from external feeds
- <strong>State tracking</strong>: Maintain correlation state across events
- <strong>Cross-detector sharing</strong>: Share enrichment data between detectors</p>
<h3 id="quick-start">Quick Start<a class="headerlink" href="#quick-start" title="Permanent link">&para;</a></h3>
<p><strong>Register a writable store</strong> (owner):</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">IPReputationDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">Init</span><span class="p">(</span><span class="nx">params</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorParams</span><span class="p">)</span><span class="w"> </span><span class="kt">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Create and configure store</span>
<span class="w">    </span><span class="nx">store</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">ipreputation</span><span class="p">.</span><span class="nx">NewIPReputationStore</span><span class="p">(</span>
<span class="w">        </span><span class="nx">ipreputation</span><span class="p">.</span><span class="nx">MaxSeverity</span><span class="p">,</span><span class="w">   </span><span class="c1">// Conflict resolution policy</span>
<span class="w">        </span><span class="kc">nil</span><span class="p">,</span><span class="w">                        </span><span class="c1">// Source priorities (optional)</span>
<span class="w">    </span><span class="p">)</span>

<span class="w">    </span><span class="c1">// Register - you become the owner</span>
<span class="w">    </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">params</span><span class="p">.</span><span class="nx">DataStores</span><span class="p">.</span><span class="nx">RegisterWritableStore</span><span class="p">(</span><span class="s">&quot;ip_reputation&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">store</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">err</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">ipRepStore</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">store</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Write to the store</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">IPReputationDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">OnEvent</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">Context</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="w"> </span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Event</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">srcIP</span><span class="p">,</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">GetData</span><span class="p">[</span><span class="kt">string</span><span class="p">](</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;src_ip&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// Write reputation data</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">ipRepStore</span><span class="p">.</span><span class="nx">WriteReputation</span><span class="p">(</span><span class="s">&quot;local_detector&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">srcIP</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">ipreputation</span><span class="p">.</span><span class="nx">IPReputation</span><span class="p">{</span>
<span class="w">        </span><span class="nx">IP</span><span class="p">:</span><span class="w">          </span><span class="nx">srcIP</span><span class="p">,</span>
<span class="w">        </span><span class="nx">Status</span><span class="p">:</span><span class="w">      </span><span class="nx">ipreputation</span><span class="p">.</span><span class="nx">ReputationBlacklisted</span><span class="p">,</span>
<span class="w">        </span><span class="nx">Severity</span><span class="p">:</span><span class="w">    </span><span class="mi">8</span><span class="p">,</span>
<span class="w">        </span><span class="nx">Tags</span><span class="p">:</span><span class="w">        </span><span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="s">&quot;malware&quot;</span><span class="p">},</span>
<span class="w">        </span><span class="nx">LastUpdated</span><span class="p">:</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Now</span><span class="p">(),</span>
<span class="w">    </span><span class="p">})</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Read from the store</strong> (other detectors):</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">ThreatAnalyzer</span><span class="p">)</span><span class="w"> </span><span class="nx">Init</span><span class="p">(</span><span class="nx">params</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorParams</span><span class="p">)</span><span class="w"> </span><span class="kt">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Access as read-only</span>
<span class="w">    </span><span class="nx">store</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">params</span><span class="p">.</span><span class="nx">DataStores</span><span class="p">.</span><span class="nx">GetCustom</span><span class="p">(</span><span class="s">&quot;ip_reputation&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="w">  </span><span class="c1">// Optional dependency - degrade gracefully</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">ipRepStore</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">store</span><span class="p">.(</span><span class="o">*</span><span class="nx">ipreputation</span><span class="p">.</span><span class="nx">IPReputationStore</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">ThreatAnalyzer</span><span class="p">)</span><span class="w"> </span><span class="nx">OnEvent</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">Context</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="w"> </span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Event</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">srcIP</span><span class="p">,</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">GetData</span><span class="p">[</span><span class="kt">string</span><span class="p">](</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;src_ip&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// Query the store</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">ipRepStore</span><span class="p">.</span><span class="nx">IsBlacklisted</span><span class="p">(</span><span class="nx">srcIP</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">{{</span>
<span class="w">            </span><span class="nx">Data</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">EventValue</span><span class="p">{</span>
<span class="w">                </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewStringValue</span><span class="p">(</span><span class="s">&quot;malicious_ip&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">srcIP</span><span class="p">),</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">        </span><span class="p">}},</span><span class="w"> </span><span class="kc">nil</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="key-concepts">Key Concepts<a class="headerlink" href="#key-concepts" title="Permanent link">&para;</a></h3>
<p><strong>Ownership Model:</strong></p>
<ul>
<li>The detector that calls <code>RegisterWritableStore()</code> owns the store</li>
<li>Owner has read/write access (keeps concrete type reference)</li>
<li>Others have read-only access (via <code>GetCustom()</code>)</li>
<li>No authorization code needed - access control via typing</li>
</ul>
<p><strong>Source Isolation:</strong></p>
<ul>
<li>All write operations include a <code>source</code> parameter (e.g., <code>"local_detector"</code>, <code>"some_feed"</code>)</li>
<li>Enables data provenance tracking</li>
<li>Supports multi-source aggregation with conflict resolution</li>
<li>Cleanup by source: <code>Clear("external_feed")</code></li>
</ul>
<p><strong>Implementation-Specific:</strong></p>
<ul>
<li>Stores define their own behavior (conflict resolution, retention, etc.)</li>
<li>See <code>pkg/datastores/ipreputation/</code> for reference implementation</li>
<li>Custom stores implement the <code>WritableStore</code> interface</li>
</ul>
<hr />
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<h3 id="quick-reference">Quick Reference<a class="headerlink" href="#quick-reference" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Store</th>
<th>Primary Use</th>
<th>Key Methods</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ProcessStore</strong></td>
<td>Process info &amp; ancestry</td>
<td><code>GetProcess()</code>, <code>GetAncestry()</code>, <code>GetChildProcesses()</code></td>
</tr>
<tr>
<td><strong>ContainerStore</strong></td>
<td>Container metadata</td>
<td><code>GetContainer()</code>, <code>GetContainerByName()</code></td>
</tr>
<tr>
<td><strong>SystemStore</strong></td>
<td>System information</td>
<td><code>GetSystemInfo()</code></td>
</tr>
<tr>
<td><strong>SyscallStore</strong></td>
<td>Syscall ID/name mapping</td>
<td><code>GetSyscallName()</code>, <code>GetSyscallID()</code></td>
</tr>
<tr>
<td><strong>KernelSymbolStore</strong></td>
<td>Symbol resolution</td>
<td><code>ResolveSymbolByAddress()</code>, <code>ResolveSymbolsBatch()</code></td>
</tr>
<tr>
<td><strong>DNSStore</strong></td>
<td>DNS cache</td>
<td><code>GetDNSResponse()</code></td>
</tr>
</tbody>
</table>
<h3 id="best-practices">Best Practices<a class="headerlink" href="#best-practices" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Use EntityID, not PID</strong> for process lookups</li>
<li><strong>Cache store references</strong> in Init() for performance</li>
<li><strong>Handle missing data gracefully</strong> (stores may be unavailable)</li>
<li><strong>Use batch operations</strong> when resolving multiple items</li>
<li><strong>Check health status</strong> before critical operations</li>
<li><strong>Monitor metrics</strong> for performance insights</li>
<li><strong>Fail fast</strong> on critical errors, degrade gracefully on optional failures</li>
</ol>
<h3 id="next-steps">Next Steps<a class="headerlink" href="#next-steps" title="Permanent link">&para;</a></h3>
<ul>
<li>Read the <a href="../api-reference/">Detector API Reference</a> for complete detector development</li>
<li>Start with the <a href="../quickstart/">Quick Start Guide</a> to write your first detector</li>
<li>Study real detector implementations in <code>detectors/</code> directory</li>
</ul>
<hr />
<p><strong>API Version</strong>: v1beta1
<strong>Last Updated</strong>: From implementation commits (60 commits analyzing detector and datastore system)</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "content.tabs.link", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.26099bd0.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"method": "mike", "provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.9d1edc04.min.js"></script>
      
    
  </body>
</html>