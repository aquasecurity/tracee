
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Runtime security and forensics using eBPF.">
      
      
      
        <link rel="canonical" href="https://aquasecurity.github.io/tracee/dev/docs/detectors/api-reference/">
      
      
        <link rel="prev" href="../yaml-detectors/">
      
      
        <link rel="next" href="../datastore-api/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0+insiders-4.53.17">
    
    
      
        <title>API Reference - Tracee</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.22cc1d52.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#detector-api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Tracee" class="md-header__button md-logo" aria-label="Tracee" data-md-component="logo">
      
  <img src="../../../images/tracee_logo_only.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Tracee
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/aquasecurity/tracee" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../overview/" class="md-tabs__link">
          
  
  
  Docs

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../traceectl/" class="md-tabs__link">
          
  
  
  Traceectl

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../tutorials/overview/" class="md-tabs__link">
          
  
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../contributing/overview/" class="md-tabs__link">
          
  
  
  Contributing

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Tracee" class="md-nav__button md-logo" aria-label="Tracee" data-md-component="logo">
      
  <img src="../../../images/tracee_logo_only.png" alt="logo">

    </a>
    Tracee
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aquasecurity/tracee" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Docs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Docs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Installation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2" id="__nav_2_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Requirements
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Requirements
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Prerequisites
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/kernel-symbols/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kernel Symbols
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/os-requirements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OS Requirements
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/capabilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Capabilities
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/lsm-support/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LSM BPF Support
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/mac-faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mac FAQ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_2_3" id="__nav_2_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/kubernetes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_2_4" id="__nav_2_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Configuration
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/config/kubernetes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/container-engines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Container Enrichment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/config/monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Monitoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4_5" >
        
          
          <label class="md-nav__link" for="__nav_2_2_4_5" id="__nav_2_2_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Flag Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Flag Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/artifacts.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    artifacts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/buffers.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    buffers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/capabilities.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    capabilities
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/config.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    config
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/enrichment.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    enrichment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/events.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    events
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/logging.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    logging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/output.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    output
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/policy.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    policy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/scope.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    scope
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/server.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/signatures-dir.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    signatures-dir
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/stores.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    stores
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4_6" >
        
          
          <label class="md-nav__link" for="__nav_2_2_4_6" id="__nav_2_2_4_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Commands Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_4_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Commands Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4_6_1" >
        
          
          <label class="md-nav__link" for="__nav_2_2_4_6_1" id="__nav_2_2_4_6_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    list
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_2_4_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_4_6_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    list
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/list.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/list-events.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    events
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/list-detectors.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    detectors
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/list-policies.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    policies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/version.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    version
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/man.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    man
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Policies
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Policies
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../policies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../policies/scopes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scopes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../policies/rules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_4" >
        
          
          <label class="md-nav__link" for="__nav_2_3_4" id="__nav_2_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Usage
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Usage
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../policies/usage/cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../policies/usage/kubernetes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Events
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Events
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_2" >
        
          
          <label class="md-nav__link" for="__nav_2_4_2" id="__nav_2_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Built-in Events
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Built-in Events
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_4_2_1" id="__nav_2_4_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Lifecycle
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_4_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Lifecycle
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/sched_process_fork/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    sched_process_fork
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/sched_process_exec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    sched_process_exec
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/sched_process_exit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    sched_process_exit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/do_exit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    do_exit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/sched_switch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    sched_switch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/container_create/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    container_create
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/container_remove/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    container_remove
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/existing_container/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    existing_container
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/init_namespaces/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    init_namespaces
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/switch_task_ns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    switch_task_ns
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/cgroup_mkdir/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cgroup_mkdir
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/cgroup_rmdir/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cgroup_rmdir
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lifecycle/cgroup_attach_task/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cgroup_attach_task
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_4_2_2" id="__nav_2_4_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Security
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_4_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Security
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/security-events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/anti_debugging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Anti Debugging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/aslr_inspection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ASLR Inspection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/cgroup_notify_on_release_modification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cgroup Notify-On-Release
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/cgroup_release_agent_modification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cgroup Release-Agent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/core_pattern_modification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core Pattern Modification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/default_loader_modification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Default Loader Modification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/disk_mount/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Disk Mount
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/docker_abuse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docker Abuse
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/dropped_executable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dropped Executable
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/dynamic_code_loading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dynamic Code Loading
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/fileless_execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fileless Execution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/hidden_file_created/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hidden File Created
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/illegitimate_shell/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Illegitimate Shell
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/kubernetes_api_connection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    K8S API Connection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/kubernetes_certificate_theft_attempt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    K8S Certificate Theft
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/kernel_module_loading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kernel Module Loading
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/ld_preload/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Loader Preload
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/process_vm_write_code_injection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Process VM Write
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/proc_fops_hooking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Procfs File Ops Hooking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/proc_kcore_read/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Procfs Kcore Read
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/proc_mem_access/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Procfs Mem Access
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/proc_mem_code_injection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Procfs Mem Code Injection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/ptrace_code_injection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ptrace Code Injection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/rcd_modification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RCD Modification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/sched_debug_recon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sched Debug
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/scheduled_task_modification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scheduled Task Modification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/stack_pivot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stack Pivot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/stdio_over_socket/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Standard I/O Over Socket
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/sudoers_modification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sudoers Modification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/syscall_table_hooking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Syscall Table Hooking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/system_request_key_config_modification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SysRQ Modification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_4_2_3" id="__nav_2_4_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Network
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_4_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Network
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/network-events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_flow_tcp_begin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_flow_tcp_begin
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_flow_tcp_end/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_flow_tcp_end
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_ipv4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_ipv4
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_ipv6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_ipv6
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_tcp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_tcp
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_udp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_udp
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_icmp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_icmp
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_icmpv6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_icmpv6
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_dns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_dns
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_dns_request/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_dns_request
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_dns_response/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_dns_response
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_http/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_http
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_http_request/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_http_request
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/network/net_packet_http_response/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_packet_http_response
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4_2_4" id="__nav_2_4_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    LSM
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_4_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    LSM
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/cap_capable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cap_capable
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_bpf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_bpf
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_bpf_map/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_bpf_map
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_bpf_prog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_bpf_prog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_bprm_check/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_bprm_check
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_file_mprotect/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_file_mprotect
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_file_open/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_file_open
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_inode_mknod/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_inode_mknod
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_inode_rename/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_inode_rename
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_inode_unlink/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_inode_unlink
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_kernel_post_read_file/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_kernel_post_read_file
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_kernel_read_file/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_kernel_read_file
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_mmap_file/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_mmap_file
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_path_notify/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_path_notify
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_sb_mount/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_sb_mount
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_sb_umount/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_sb_umount
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_settime64/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_settime64
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_socket_accept/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_socket_accept
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_socket_bind/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_socket_bind
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_socket_connect/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_socket_connect
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_socket_create/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_socket_create
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_socket_listen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_socket_listen
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_socket_setsockopt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_socket_setsockopt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/lsm/security_task_setrlimit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    security_task_setrlimit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_4_2_5" id="__nav_2_4_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Misc
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_4_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Misc
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/__kernel_write/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    __kernel_write
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/bpf_attach/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    bpf_attach
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/call_usermodehelper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    call_usermodehelper
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/chmod_common/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    chmod_common
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/commit_creds/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    commit_creds
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/debugfs_create_dir/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    debugfs_create_dir
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/debugfs_create_file/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    debugfs_create_file
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/device_add/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    device_add
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/dirty_pipe_splice/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    dirty_pipe_splice
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/do_init_module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    do_init_module
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/do_mmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    do_mmap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/do_sigaction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    do_sigaction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/do_truncate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    do_truncate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/file_modification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    file_modification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/ftrace_hook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ftrace_hook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/hidden_kernel_module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    hidden_kernel_module
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/hooked_seq_ops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    hooked_seq_ops
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/hooked_syscall/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    hooked_syscall
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/inotify_watch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    inotify_watch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/kallsyms_lookup_name/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kallsyms_lookup_name
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/kprobe_attach/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kprobe_attach
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/load_elf_phdrs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    load_elf_phdrs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/magic_write/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    magic_write
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/mem_prot_alert/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    mem_prot_alert
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/net_tcp_connect/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    net_tcp_connect
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/print_mem_dump/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    print_mem_dump
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/proc_create/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    proc_create
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/process_execute_failed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    process_execute_failed
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/register_chrdev/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    register_chrdev
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/set_fs_pwd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    set_fs_pwd
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/shared_object_loaded/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    shared_object_loaded
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/socket_accept/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    socket_accept
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/socket_dup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    socket_dup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/suspicious_syscall_source/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    suspicious_syscall_source
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/symbols_collision/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    symbols_collision
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/security/symbols_loaded/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    symbols_loaded
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/task_rename/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    task_rename
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/tracee_info/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    tracee_info
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/vfs_read/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vfs_read
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/vfs_readv/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vfs_readv
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/vfs_utimes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vfs_utimes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/vfs_write/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vfs_write
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/misc/vfs_writev/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vfs_writev
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_4_2_6" id="__nav_2_4_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Syscalls
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_4_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_2_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Syscalls
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/syscall-events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/syscalls/sys_enter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    sys_enter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/builtin/man/syscalls/sys_exit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    sys_exit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_3" >
        
          
          <label class="md-nav__link" for="__nav_2_4_3" id="__nav_2_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Custom Events
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Custom Events
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/custom/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../events/custom/golang/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Go
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" checked>
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Detectors
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Detectors
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../yaml-detectors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    YAML Detectors
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      
        Table of Contents
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-interfaces" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Interfaces
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Interfaces">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#eventdetector-interface" class="md-nav__link">
    <span class="md-ellipsis">
      
        EventDetector Interface
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detectorparams" class="md-nav__link">
    <span class="md-ellipsis">
      
        DetectorParams
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#detectordefinition" class="md-nav__link">
    <span class="md-ellipsis">
      
        DetectorDefinition
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DetectorDefinition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#complete-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Complete Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detector-id-conventions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Detector ID Conventions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#producedevent-event-definition" class="md-nav__link">
    <span class="md-ellipsis">
      
        ProducedEvent: Event Definition
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#threatmetadata-threat-template" class="md-nav__link">
    <span class="md-ellipsis">
      
        ThreatMetadata: Threat Template
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#detector-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        Detector Requirements
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Detector Requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#detectorrequirements-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        DetectorRequirements Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventrequirement-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        EventRequirement Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#basic-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        Basic Requirements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datafilters-filtering-event-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        DataFilters: Filtering Event Data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scopefilters-filtering-by-origin" class="md-nav__link">
    <span class="md-ellipsis">
      
        ScopeFilters: Filtering by Origin
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-version-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      
        Event Version Constraints
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#required-vs-optional-events" class="md-nav__link">
    <span class="md-ellipsis">
      
        Required vs Optional Events
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datastore-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        DataStore Requirements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enrichment-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        Enrichment Requirements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#architecture-filtering" class="md-nav__link">
    <span class="md-ellipsis">
      
        Architecture Filtering
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tracee-version-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tracee Version Constraints
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complete-requirements-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        Complete Requirements Example
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#detectoroutput" class="md-nav__link">
    <span class="md-ellipsis">
      
        DetectorOutput
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DetectorOutput">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helper-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Helper Functions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-event-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating Event Data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-outputs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multiple Outputs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#no-detection" class="md-nav__link">
    <span class="md-ellipsis">
      
        No Detection
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auto-population" class="md-nav__link">
    <span class="md-ellipsis">
      
        Auto-Population
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Auto-Population">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#threat-automatic-threat-metadata" class="md-nav__link">
    <span class="md-ellipsis">
      
        Threat: Automatic Threat Metadata
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detectedfrom-provenance-tracking" class="md-nav__link">
    <span class="md-ellipsis">
      
        DetectedFrom: Provenance Tracking
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DetectedFrom: Provenance Tracking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#detection-chain-preservation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Detection Chain Preservation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#processancestry-automatic-ancestry-enrichment" class="md-nav__link">
    <span class="md-ellipsis">
      
        ProcessAncestry: Automatic Ancestry Enrichment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complete-auto-population-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        Complete Auto-Population Example
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overriding-auto-population-per-output" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overriding Auto-Population Per Output
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lifecycle-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lifecycle Management
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lifecycle Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#init-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      
        Init() Best Practices
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#onevent-guidelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        OnEvent() Guidelines
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-handling-guidelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Handling Guidelines
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Testing
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unit-testing-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unit Testing Patterns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mock-logger-and-datastores" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mock Logger and DataStores
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-helpers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Test Helpers
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      
        Best Practices
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#detector-design-principles" class="md-nav__link">
    <span class="md-ellipsis">
      
        Detector Design Principles
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Performance Considerations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-organization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Code Organization
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-access-helpers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data Access Helpers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Access Helpers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#type-safe-event-data-extraction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Type-Safe Event Data Extraction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#null-safe-accessors" class="md-nav__link">
    <span class="md-ellipsis">
      
        Null-Safe Accessors
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-access-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Common Access Patterns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Next Steps
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-help" class="md-nav__link">
    <span class="md-ellipsis">
      
        Getting Help
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migration-from-signatures" class="md-nav__link">
    <span class="md-ellipsis">
      
        Migration from Signatures
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migration from Signatures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quick-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick Comparison
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-by-step-migration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step-by-Step Migration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#migration-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        Migration Checklist
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-pattern-translations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Common Pattern Translations
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Troubleshooting
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#problem-detector-not-running" class="md-nav__link">
    <span class="md-ellipsis">
      
        Problem: Detector Not Running
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#problem-no-events-received" class="md-nav__link">
    <span class="md-ellipsis">
      
        Problem: No Events Received
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#problem-datastore-returns-errnotfound" class="md-nav__link">
    <span class="md-ellipsis">
      
        Problem: DataStore Returns ErrNotFound
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#problem-high-cpu-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        Problem: High CPU Usage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#problem-memory-leaks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Problem: Memory Leaks
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../datastore-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DataStore API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Output
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Output
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outputs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outputs/output-formats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Formats
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outputs/streams/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Streams
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outputs/event-structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Event Structure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outputs/sorting-events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sorting Events
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outputs/logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Logging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Forensics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Forensics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../forensics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Security Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Troubleshooting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Traceectl
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Traceectl
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../traceectl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../traceectl/usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Commands
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Commands
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../traceectl/commands/event/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    event
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../traceectl/commands/metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../traceectl/commands/stream/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    stream
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../traceectl/commands/version/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    version
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Flags
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Flags
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../traceectl/flags/output/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    output
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../traceectl/flags/format/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    format
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../traceectl/flags/server/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../traceectl/flags/policy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    policy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/verify-tracee-signature/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cosign - verify Tracee signature
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/deploy-grafana-dashboard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Access Tracee Metrics in Grafana and Prometheus
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/tracee-vagrant/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Using Tracee Container Image with Vagrant on Mac
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/k8s-policies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Working with Tracee's Policies on Kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/promtail/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Accessing Tracee Logs through Promtail and Loki
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/additional-resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Additional Resources
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Contributing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/guidelines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Guidelines
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/checkpatch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PR Validation (Checkpatch)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/adding-events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Adding New Events
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/event-documentation-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Event Documentation Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/testing-coverage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Code Coverage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/performance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Performance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/evt-tool/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Event Generator (evt)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/kubernetes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/setup-development-machine-with-vagrant/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Setup Development Machine with Vagrant
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_11" >
        
          
          <label class="md-nav__link" for="__nav_5_11" id="__nav_5_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Building
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    Building
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/building/building/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Building Tracee
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/building/environment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Building Environment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/building/containers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Building Containers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      
        Table of Contents
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-interfaces" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Interfaces
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Interfaces">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#eventdetector-interface" class="md-nav__link">
    <span class="md-ellipsis">
      
        EventDetector Interface
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detectorparams" class="md-nav__link">
    <span class="md-ellipsis">
      
        DetectorParams
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#detectordefinition" class="md-nav__link">
    <span class="md-ellipsis">
      
        DetectorDefinition
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DetectorDefinition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#complete-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Complete Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detector-id-conventions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Detector ID Conventions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#producedevent-event-definition" class="md-nav__link">
    <span class="md-ellipsis">
      
        ProducedEvent: Event Definition
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#threatmetadata-threat-template" class="md-nav__link">
    <span class="md-ellipsis">
      
        ThreatMetadata: Threat Template
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#detector-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        Detector Requirements
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Detector Requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#detectorrequirements-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        DetectorRequirements Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventrequirement-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        EventRequirement Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#basic-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        Basic Requirements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datafilters-filtering-event-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        DataFilters: Filtering Event Data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scopefilters-filtering-by-origin" class="md-nav__link">
    <span class="md-ellipsis">
      
        ScopeFilters: Filtering by Origin
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-version-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      
        Event Version Constraints
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#required-vs-optional-events" class="md-nav__link">
    <span class="md-ellipsis">
      
        Required vs Optional Events
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datastore-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        DataStore Requirements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enrichment-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        Enrichment Requirements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#architecture-filtering" class="md-nav__link">
    <span class="md-ellipsis">
      
        Architecture Filtering
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tracee-version-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tracee Version Constraints
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complete-requirements-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        Complete Requirements Example
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#detectoroutput" class="md-nav__link">
    <span class="md-ellipsis">
      
        DetectorOutput
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DetectorOutput">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helper-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Helper Functions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-event-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating Event Data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-outputs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multiple Outputs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#no-detection" class="md-nav__link">
    <span class="md-ellipsis">
      
        No Detection
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auto-population" class="md-nav__link">
    <span class="md-ellipsis">
      
        Auto-Population
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Auto-Population">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#threat-automatic-threat-metadata" class="md-nav__link">
    <span class="md-ellipsis">
      
        Threat: Automatic Threat Metadata
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detectedfrom-provenance-tracking" class="md-nav__link">
    <span class="md-ellipsis">
      
        DetectedFrom: Provenance Tracking
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DetectedFrom: Provenance Tracking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#detection-chain-preservation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Detection Chain Preservation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#processancestry-automatic-ancestry-enrichment" class="md-nav__link">
    <span class="md-ellipsis">
      
        ProcessAncestry: Automatic Ancestry Enrichment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complete-auto-population-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        Complete Auto-Population Example
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overriding-auto-population-per-output" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overriding Auto-Population Per Output
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lifecycle-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lifecycle Management
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lifecycle Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#init-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      
        Init() Best Practices
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#onevent-guidelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        OnEvent() Guidelines
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-handling-guidelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Handling Guidelines
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Testing
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unit-testing-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unit Testing Patterns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mock-logger-and-datastores" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mock Logger and DataStores
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-helpers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Test Helpers
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      
        Best Practices
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#detector-design-principles" class="md-nav__link">
    <span class="md-ellipsis">
      
        Detector Design Principles
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Performance Considerations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-organization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Code Organization
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-access-helpers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data Access Helpers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Access Helpers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#type-safe-event-data-extraction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Type-Safe Event Data Extraction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#null-safe-accessors" class="md-nav__link">
    <span class="md-ellipsis">
      
        Null-Safe Accessors
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-access-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Common Access Patterns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Next Steps
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-help" class="md-nav__link">
    <span class="md-ellipsis">
      
        Getting Help
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migration-from-signatures" class="md-nav__link">
    <span class="md-ellipsis">
      
        Migration from Signatures
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migration from Signatures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quick-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick Comparison
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-by-step-migration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step-by-Step Migration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#migration-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        Migration Checklist
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-pattern-translations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Common Pattern Translations
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Troubleshooting
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#problem-detector-not-running" class="md-nav__link">
    <span class="md-ellipsis">
      
        Problem: Detector Not Running
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#problem-no-events-received" class="md-nav__link">
    <span class="md-ellipsis">
      
        Problem: No Events Received
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#problem-datastore-returns-errnotfound" class="md-nav__link">
    <span class="md-ellipsis">
      
        Problem: DataStore Returns ErrNotFound
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#problem-high-cpu-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        Problem: High CPU Usage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#problem-memory-leaks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Problem: Memory Leaks
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="detector-api-reference">Detector API Reference<a class="headerlink" href="#detector-api-reference" title="Permanent link">&para;</a></h1>
<p>Complete reference documentation for the Tracee Detector API. This guide documents all interfaces, structures, and features for writing custom detectors.</p>
<p><strong>New to detectors?</strong> Start with the <a href="../quickstart/">Quick Start Guide</a> first.</p>
<h2 id="table-of-contents">Table of Contents<a class="headerlink" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#core-interfaces">Core Interfaces</a></li>
<li><a href="#detectordefinition">DetectorDefinition</a></li>
<li><a href="#detector-requirements">Detector Requirements</a></li>
<li><a href="#detectoroutput">DetectorOutput</a></li>
<li><a href="#auto-population">Auto-Population</a></li>
<li><a href="#lifecycle-management">Lifecycle Management</a></li>
<li><a href="#testing">Testing</a></li>
<li><a href="#best-practices">Best Practices</a></li>
</ol>
<hr />
<h2 id="core-interfaces">Core Interfaces<a class="headerlink" href="#core-interfaces" title="Permanent link">&para;</a></h2>
<h3 id="eventdetector-interface">EventDetector Interface<a class="headerlink" href="#eventdetector-interface" title="Permanent link">&para;</a></h3>
<p>All detectors must implement this interface:</p>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">EventDetector</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// GetDefinition returns the detector&#39;s metadata and requirements</span>
<span class="w">    </span><span class="c1">// Called once during registration - result is cached</span>
<span class="w">    </span><span class="nx">GetDefinition</span><span class="p">()</span><span class="w"> </span><span class="nx">DetectorDefinition</span>

<span class="w">    </span><span class="c1">// Init is called once at startup with shared resources</span>
<span class="w">    </span><span class="c1">// Use this to store logger, datastores, and initialize state</span>
<span class="w">    </span><span class="nx">Init</span><span class="p">(</span><span class="nx">params</span><span class="w"> </span><span class="nx">DetectorParams</span><span class="p">)</span><span class="w"> </span><span class="kt">error</span>

<span class="w">    </span><span class="c1">// OnEvent processes each matching event</span>
<span class="w">    </span><span class="c1">// Return one or more DetectorOutput, nil for no detection, or error</span>
<span class="w">    </span><span class="nx">OnEvent</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">Context</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="w"> </span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Event</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="nx">DetectorOutput</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="detectorparams">DetectorParams<a class="headerlink" href="#detectorparams" title="Permanent link">&para;</a></h3>
<p>Provided to <code>Init()</code> with shared resources:</p>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">DetectorParams</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Logger</span><span class="w">     </span><span class="nx">Logger</span><span class="w">                 </span><span class="c1">// Structured logger (zap-based)</span>
<span class="w">    </span><span class="nx">DataStores</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">Registry</span><span class="w">    </span><span class="c1">// Access to all datastores</span>
<span class="w">    </span><span class="nx">Config</span><span class="w">     </span><span class="nx">DetectorConfig</span><span class="w">         </span><span class="c1">// Detector-specific configuration</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">Init</span><span class="p">(</span><span class="nx">params</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorParams</span><span class="p">)</span><span class="w"> </span><span class="kt">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">params</span><span class="p">.</span><span class="nx">Logger</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">params</span><span class="p">.</span><span class="nx">DataStores</span>

<span class="w">    </span><span class="c1">// Check required datastore availability</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">params</span><span class="p">.</span><span class="nx">DataStores</span><span class="p">.</span><span class="nx">IsAvailable</span><span class="p">(</span><span class="s">&quot;process&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">New</span><span class="p">(</span><span class="s">&quot;process store required but unavailable&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Debugw</span><span class="p">(</span><span class="s">&quot;Detector initialized&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;id&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">GetDefinition</span><span class="p">().</span><span class="nx">ID</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="detectordefinition">DetectorDefinition<a class="headerlink" href="#detectordefinition" title="Permanent link">&para;</a></h2>
<h3 id="complete-structure">Complete Structure<a class="headerlink" href="#complete-structure" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">DetectorDefinition</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Unique identifier (required)</span>
<span class="w">    </span><span class="nx">ID</span><span class="w"> </span><span class="kt">string</span>

<span class="w">    </span><span class="c1">// Event and datastore requirements (required)</span>
<span class="w">    </span><span class="nx">Requirements</span><span class="w"> </span><span class="nx">DetectorRequirements</span>

<span class="w">    </span><span class="c1">// Output event specification (required)</span>
<span class="w">    </span><span class="nx">ProducedEvent</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">EventDefinition</span>

<span class="w">    </span><span class="c1">// Default threat metadata (optional, recommended for threats)</span>
<span class="w">    </span><span class="nx">ThreatMetadata</span><span class="w"> </span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Threat</span>

<span class="w">    </span><span class="c1">// Auto-population configuration (optional, recommended)</span>
<span class="w">    </span><span class="nx">AutoPopulate</span><span class="w"> </span><span class="nx">AutoPopulateFields</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="detector-id-conventions">Detector ID Conventions<a class="headerlink" href="#detector-id-conventions" title="Permanent link">&para;</a></h3>
<p>Choose an appropriate ID format:</p>
<p><strong>Threat Detectors</strong> (TRC-XXX):</p>
<div class="highlight"><pre><span></span><code><span class="nx">ID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TRC-001&quot;</span><span class="w">  </span><span class="c1">// Sensitive file access</span>
<span class="nx">ID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TRC-014&quot;</span><span class="w">  </span><span class="c1">// Process injection detection</span>
</code></pre></div>
<p><strong>Derived Events</strong> (DRV-XXX):</p>
<div class="highlight"><pre><span></span><code><span class="nx">ID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;DRV-001&quot;</span><span class="w">  </span><span class="c1">// Container lifecycle events</span>
<span class="nx">ID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;DRV-003&quot;</span><span class="w">  </span><span class="c1">// Hooked syscall detector</span>
</code></pre></div>
<p><strong>Custom/Vendor</strong> (VENDOR-XXX):</p>
<div class="highlight"><pre><span></span><code><span class="nx">ID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ACME-001&quot;</span><span class="w">  </span><span class="c1">// Custom company detection</span>
</code></pre></div>
<h3 id="producedevent-event-definition">ProducedEvent: Event Definition<a class="headerlink" href="#producedevent-event-definition" title="Permanent link">&para;</a></h3>
<p>Defines the event your detector produces:</p>
<div class="highlight"><pre><span></span><code><span class="nx">ProducedEvent</span><span class="p">:</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">EventDefinition</span><span class="p">{</span>
<span class="w">    </span><span class="nx">Name</span><span class="p">:</span><span class="w">        </span><span class="s">&quot;my_detection&quot;</span><span class="p">,</span><span class="w">           </span><span class="c1">// Required: unique snake_case name</span>
<span class="w">    </span><span class="nx">Description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Detailed description&quot;</span><span class="p">,</span><span class="w">    </span><span class="c1">// Required: clear explanation</span>
<span class="w">    </span><span class="nx">Version</span><span class="p">:</span><span class="w">     </span><span class="o">&amp;</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Version</span><span class="p">{</span><span class="w">         </span><span class="c1">// Required: semantic version</span>
<span class="w">        </span><span class="nx">Major</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nx">Minor</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nx">Patch</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nx">Fields</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">EventField</span><span class="p">{</span><span class="w">         </span><span class="c1">// Required: output fields schema</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;field_name&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nx">Type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;const char*&quot;</span><span class="p">,</span><span class="w">            </span><span class="c1">// Type for display/docs</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nx">Tags</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="s">&quot;security&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;file&quot;</span><span class="p">},</span><span class="w">    </span><span class="c1">// Optional: categorization</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Field Types</strong> (documentation only):</p>
<ul>
<li><code>const char*</code> - String</li>
<li><code>int</code>, <code>u32</code>, <code>u64</code> - Integers</li>
<li><code>bool</code> - Boolean</li>
<li>Custom types for complex data</li>
</ul>
<p><strong>Example with all fields</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">ProducedEvent</span><span class="p">:</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">EventDefinition</span><span class="p">{</span>
<span class="w">    </span><span class="nx">Name</span><span class="p">:</span><span class="w">        </span><span class="s">&quot;suspicious_shell_execution&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">Description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Detects suspicious shell command execution patterns&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">Version</span><span class="p">:</span><span class="w">     </span><span class="o">&amp;</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Version</span><span class="p">{</span><span class="nx">Major</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">Minor</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nx">Patch</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span>
<span class="w">    </span><span class="nx">Fields</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">EventField</span><span class="p">{</span>
<span class="w">        </span><span class="p">{</span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;command&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;const char*&quot;</span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;shell_type&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;const char*&quot;</span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;risk_score&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;indicators&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;const char*[]&quot;</span><span class="p">},</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nx">Tags</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="s">&quot;execution&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;defense-evasion&quot;</span><span class="p">},</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="threatmetadata-threat-template">ThreatMetadata: Threat Template<a class="headerlink" href="#threatmetadata-threat-template" title="Permanent link">&para;</a></h3>
<p>Default threat information, copied to outputs when <code>AutoPopulate.Threat=true</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">ThreatMetadata</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Threat</span><span class="p">{</span>
<span class="w">    </span><span class="nx">Name</span><span class="p">:</span><span class="w">        </span><span class="s">&quot;Short threat name&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">Description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Detailed threat description&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">Severity</span><span class="p">:</span><span class="w">    </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Severity_MEDIUM</span><span class="p">,</span>
<span class="w">    </span><span class="nx">Signature</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">ThreatSignature</span><span class="p">{</span>
<span class="w">        </span><span class="nx">ID</span><span class="p">:</span><span class="w">   </span><span class="s">&quot;MITRE T1055&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Process Injection&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nx">Mitre</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">MitreAttack</span><span class="p">{</span>
<span class="w">        </span><span class="nx">Tactic</span><span class="p">:</span><span class="w">     </span><span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="s">&quot;Defense Evasion&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Privilege Escalation&quot;</span><span class="p">},</span>
<span class="w">        </span><span class="nx">Technique</span><span class="p">:</span><span class="w">  </span><span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="s">&quot;T1055&quot;</span><span class="p">},</span>
<span class="w">        </span><span class="nx">SubTechnique</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="s">&quot;T1055.001&quot;</span><span class="p">},</span>
<span class="w">    </span><span class="p">},</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Severity Levels</strong>:</p>
<ul>
<li><code>Severity_INFO</code> - Informational events</li>
<li><code>Severity_LOW</code> - Low-risk threats</li>
<li><code>Severity_MEDIUM</code> - Moderate threats (default for most detections)</li>
<li><code>Severity_HIGH</code> - Serious threats requiring immediate attention</li>
<li><code>Severity_CRITICAL</code> - Critical threats (data exfiltration, rootkits)</li>
</ul>
<p><strong>Override per detection</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="k">return</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">{{</span>
<span class="w">    </span><span class="nx">Data</span><span class="p">:</span><span class="w"> </span><span class="nx">data</span><span class="p">,</span>
<span class="w">    </span><span class="nx">Threat</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Threat</span><span class="p">{</span>
<span class="w">        </span><span class="nx">Name</span><span class="p">:</span><span class="w">     </span><span class="s">&quot;Critical System Compromise&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">Severity</span><span class="p">:</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Severity_CRITICAL</span><span class="p">,</span><span class="w">  </span><span class="c1">// Override default MEDIUM</span>
<span class="w">    </span><span class="p">},</span>
<span class="p">}},</span><span class="w"> </span><span class="kc">nil</span>
</code></pre></div>
<hr />
<h2 id="detector-requirements">Detector Requirements<a class="headerlink" href="#detector-requirements" title="Permanent link">&para;</a></h2>
<h3 id="detectorrequirements-structure">DetectorRequirements Structure<a class="headerlink" href="#detectorrequirements-structure" title="Permanent link">&para;</a></h3>
<p>Declare what your detector needs:</p>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">DetectorRequirements</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Events lists the events this detector needs to receive</span>
<span class="w">    </span><span class="nx">Events</span><span class="w"> </span><span class="p">[]</span><span class="nx">EventRequirement</span>

<span class="w">    </span><span class="c1">// DataStores lists required datastores with their dependency types</span>
<span class="w">    </span><span class="nx">DataStores</span><span class="w"> </span><span class="p">[]</span><span class="nx">DataStoreRequirement</span>

<span class="w">    </span><span class="c1">// Enrichments lists required event enrichment options</span>
<span class="w">    </span><span class="nx">Enrichments</span><span class="w"> </span><span class="p">[]</span><span class="nx">EnrichmentRequirement</span>

<span class="w">    </span><span class="c1">// Architectures lists supported CPU architectures (empty = all)</span>
<span class="w">    </span><span class="nx">Architectures</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span>

<span class="w">    </span><span class="c1">// MinTraceeVersion specifies minimum Tracee version (optional, inclusive)</span>
<span class="w">    </span><span class="nx">MinTraceeVersion</span><span class="w"> </span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Version</span>

<span class="w">    </span><span class="c1">// MaxTraceeVersion specifies maximum Tracee version (optional, exclusive)</span>
<span class="w">    </span><span class="nx">MaxTraceeVersion</span><span class="w"> </span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Version</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="eventrequirement-structure">EventRequirement Structure<a class="headerlink" href="#eventrequirement-structure" title="Permanent link">&para;</a></h3>
<p>Declare which events your detector needs:</p>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">EventRequirement</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Name</span><span class="w">             </span><span class="kt">string</span><span class="w">            </span><span class="c1">// Event name (required)</span>
<span class="w">    </span><span class="nx">DataFilters</span><span class="w">      </span><span class="p">[]</span><span class="kt">string</span><span class="w">          </span><span class="c1">// Filter by event data (optional)</span>
<span class="w">    </span><span class="nx">ScopeFilters</span><span class="w">     </span><span class="p">[]</span><span class="kt">string</span><span class="w">          </span><span class="c1">// Filter by origin (optional)</span>
<span class="w">    </span><span class="nx">MinVersion</span><span class="w">       </span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Version</span><span class="w">  </span><span class="c1">// Minimum event version (optional)</span>
<span class="w">    </span><span class="nx">MaxVersion</span><span class="w">       </span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Version</span><span class="w">  </span><span class="c1">// Maximum event version (optional, exclusive)</span>
<span class="w">    </span><span class="nx">Dependency</span><span class="w">       </span><span class="nx">DependencyType</span><span class="w">    </span><span class="c1">// Required vs optional (optional, default Required)</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="basic-requirements">Basic Requirements<a class="headerlink" href="#basic-requirements" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nx">Requirements</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorRequirements</span><span class="p">{</span>
<span class="w">    </span><span class="nx">Events</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">EventRequirement</span><span class="p">{</span>
<span class="w">        </span><span class="p">{</span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;security_file_open&quot;</span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;security_inode_unlink&quot;</span><span class="p">},</span>
<span class="w">    </span><span class="p">},</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="datafilters-filtering-event-data">DataFilters: Filtering Event Data<a class="headerlink" href="#datafilters-filtering-event-data" title="Permanent link">&para;</a></h3>
<p>Engine-level filtering - only matching events reach your detector:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;security_file_open&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">DataFilters</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">{</span>
<span class="w">        </span><span class="s">&quot;pathname=/etc/shadow&quot;</span><span class="p">,</span><span class="w">          </span><span class="c1">// Exact match</span>
<span class="w">        </span><span class="s">&quot;pathname=/etc/sudoers&quot;</span><span class="p">,</span><span class="w">          </span><span class="c1">// OR condition</span>
<span class="w">    </span><span class="p">},</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Filter operators</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="s">&quot;field=value&quot;</span><span class="w">       </span><span class="c1">// Exact match</span>
<span class="s">&quot;field=/path/*&quot;</span><span class="w">     </span><span class="c1">// Glob pattern (*, ?)</span>
<span class="s">&quot;field!=value&quot;</span><span class="w">      </span><span class="c1">// Not equal</span>
<span class="s">&quot;field&gt;100&quot;</span><span class="w">         </span><span class="c1">// Greater than (numeric)</span>
<span class="s">&quot;field&lt;100&quot;</span><span class="w">         </span><span class="c1">// Less than (numeric)</span>
<span class="s">&quot;field&gt;=100&quot;</span><span class="w">        </span><span class="c1">// Greater or equal</span>
<span class="s">&quot;field&lt;=100&quot;</span><span class="w">        </span><span class="c1">// Less or equal</span>
</code></pre></div>
<p><strong>Multiple filters</strong> (AND logic):</p>
<div class="highlight"><pre><span></span><code><span class="nx">DataFilters</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">{</span>
<span class="w">    </span><span class="s">&quot;pathname=/tmp/*&quot;</span><span class="p">,</span><span class="w">       </span><span class="c1">// Must match /tmp/*</span>
<span class="w">    </span><span class="s">&quot;flags&gt;0&quot;</span><span class="p">,</span><span class="w">               </span><span class="c1">// AND flags &gt; 0</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Common patterns</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Sensitive paths</span>
<span class="nx">DataFilters</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">{</span>
<span class="w">    </span><span class="s">&quot;pathname=/etc/shadow&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;pathname=/etc/passwd&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;pathname=/root/.ssh/*&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1">// Specific flags</span>
<span class="nx">DataFilters</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">{</span>
<span class="w">    </span><span class="s">&quot;flags=0x80000&quot;</span><span class="p">,</span><span class="w">  </span><span class="c1">// O_CLOEXEC</span>
<span class="p">}</span>

<span class="c1">// Suspicious syscalls</span>
<span class="nx">DataFilters</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">{</span>
<span class="w">    </span><span class="s">&quot;syscall=ptrace&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;syscall=process_vm_writev&quot;</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="scopefilters-filtering-by-origin">ScopeFilters: Filtering by Origin<a class="headerlink" href="#scopefilters-filtering-by-origin" title="Permanent link">&para;</a></h3>
<p>Filter by where events originated:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;security_file_open&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">ScopeFilters</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">{</span>
<span class="w">        </span><span class="s">&quot;container=started&quot;</span><span class="p">,</span><span class="w">  </span><span class="c1">// Only containers</span>
<span class="w">    </span><span class="p">},</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Scope options</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="s">&quot;container=started&quot;</span><span class="w">      </span><span class="c1">// Only from containers</span>
<span class="s">&quot;not-container&quot;</span><span class="w">          </span><span class="c1">// Only from host (not containers)</span>
<span class="s">&quot;pid=1000&quot;</span><span class="w">              </span><span class="c1">// Specific PID</span>
<span class="s">&quot;pid!=1&quot;</span><span class="w">                </span><span class="c1">// Exclude init process</span>
</code></pre></div>
<h3 id="event-version-constraints">Event Version Constraints<a class="headerlink" href="#event-version-constraints" title="Permanent link">&para;</a></h3>
<p>Require minimum event version:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;security_bprm_check&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">MinVersion</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Version</span><span class="p">{</span>
<span class="w">        </span><span class="nx">Major</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">        </span><span class="nx">Minor</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="required-vs-optional-events">Required vs Optional Events<a class="headerlink" href="#required-vs-optional-events" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">DependencyType</span><span class="w"> </span><span class="kt">int</span>

<span class="kd">const</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="nx">DependencyRequired</span><span class="w"> </span><span class="nx">DependencyType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">iota</span><span class="w">  </span><span class="c1">// Detector fails if event unavailable</span>
<span class="w">    </span><span class="nx">DependencyOptional</span><span class="w">                         </span><span class="c1">// Detector works without event</span>
<span class="p">)</span>
</code></pre></div>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">Events</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">EventRequirement</span><span class="p">{</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nx">Name</span><span class="p">:</span><span class="w">       </span><span class="s">&quot;security_file_open&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">Dependency</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DependencyRequired</span><span class="p">,</span><span class="w">  </span><span class="c1">// Must have</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nx">Name</span><span class="p">:</span><span class="w">       </span><span class="s">&quot;hooked_syscalls&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">Dependency</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DependencyOptional</span><span class="p">,</span><span class="w">  </span><span class="c1">// Nice to have</span>
<span class="w">    </span><span class="p">},</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="datastore-requirements">DataStore Requirements<a class="headerlink" href="#datastore-requirements" title="Permanent link">&para;</a></h3>
<p>Declare datastore dependencies:</p>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">DataStoreRequirement</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Name</span><span class="w">       </span><span class="kt">string</span><span class="w">          </span><span class="c1">// Datastore name</span>
<span class="w">    </span><span class="nx">Dependency</span><span class="w"> </span><span class="nx">DependencyType</span><span class="w">  </span><span class="c1">// Required vs optional</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Available datastores</strong>:</p>
<ul>
<li><code>process</code> - Process tree and ancestry</li>
<li><code>container</code> - Container metadata</li>
<li><code>dns</code> - DNS cache</li>
<li><code>system</code> - System information</li>
<li><code>syscall</code> - Syscall mappings</li>
<li><code>symbol</code> - Kernel symbols</li>
</ul>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">Requirements</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorRequirements</span><span class="p">{</span>
<span class="w">    </span><span class="nx">Events</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">EventRequirement</span><span class="p">{</span>
<span class="w">        </span><span class="p">{</span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;security_file_open&quot;</span><span class="p">},</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nx">DataStores</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DataStoreRequirement</span><span class="p">{</span>
<span class="w">        </span><span class="p">{</span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;process&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">Dependency</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DependencyRequired</span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;container&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">Dependency</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DependencyOptional</span><span class="p">},</span>
<span class="w">    </span><span class="p">},</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="enrichment-requirements">Enrichment Requirements<a class="headerlink" href="#enrichment-requirements" title="Permanent link">&para;</a></h3>
<p>Request specific data enrichments on input events:</p>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">EnrichmentRequirement</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Name</span><span class="w">       </span><span class="kt">string</span><span class="w">          </span><span class="c1">// Enrichment option name</span>
<span class="w">    </span><span class="nx">Dependency</span><span class="w"> </span><span class="nx">DependencyType</span><span class="w">  </span><span class="c1">// Required vs optional</span>
<span class="w">    </span><span class="nx">Config</span><span class="w">     </span><span class="kt">string</span><span class="w">          </span><span class="c1">// Enrichment-specific config (optional)</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Available enrichments</strong>:</p>
<ul>
<li><code>environment</code> - Execution environment variables</li>
<li><code>executable-hash</code> - Executable file hashes (Config: "inode", "dev-inode", "digest-inode")</li>
<li><code>container</code> - Container metadata fields in Event struct (Name, Image, Pod info)</li>
</ul>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">DetectorDefinition</span><span class="p">{</span>
<span class="w">    </span><span class="nx">ID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TRC-001&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">Requirements</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorRequirements</span><span class="p">{</span>
<span class="w">        </span><span class="nx">Enrichments</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">EnrichmentRequirement</span><span class="p">{</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="nx">Name</span><span class="p">:</span><span class="w">       </span><span class="s">&quot;executable-hash&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nx">Config</span><span class="p">:</span><span class="w">     </span><span class="s">&quot;digest-inode&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nx">Dependency</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DependencyRequired</span><span class="p">,</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">    </span><span class="p">},</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Container enrichment example</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">DetectorDefinition</span><span class="p">{</span>
<span class="w">    </span><span class="nx">ID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TRC-CONTAINER-001&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">Requirements</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorRequirements</span><span class="p">{</span>
<span class="w">        </span><span class="nx">Events</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">EventRequirement</span><span class="p">{</span>
<span class="w">            </span><span class="p">{</span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;security_file_open&quot;</span><span class="p">},</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">Enrichments</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">EnrichmentRequirement</span><span class="p">{</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="nx">Name</span><span class="p">:</span><span class="w">       </span><span class="nx">detection</span><span class="p">.</span><span class="nx">EnrichmentContainer</span><span class="p">,</span>
<span class="w">                </span><span class="nx">Dependency</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DependencyRequired</span><span class="p">,</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">    </span><span class="p">},</span>
<span class="p">}</span>
</code></pre></div>
<p>This detector requires container fields to be pre-populated in the Event struct. Without <code>--enrichment container</code>, registration will fail.</p>
<h3 id="architecture-filtering">Architecture Filtering<a class="headerlink" href="#architecture-filtering" title="Permanent link">&para;</a></h3>
<p>Restrict detector to specific CPU architectures (rarely needed):</p>
<div class="highlight"><pre><span></span><code><span class="nx">DetectorDefinition</span><span class="p">{</span>
<span class="w">    </span><span class="nx">ID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TRC-X86-001&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">Requirements</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorRequirements</span><span class="p">{</span>
<span class="w">        </span><span class="nx">Architectures</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="s">&quot;amd64&quot;</span><span class="p">},</span><span class="w">  </span><span class="c1">// Only x86-64</span>
<span class="w">        </span><span class="c1">// ... rest of requirements</span>
<span class="w">    </span><span class="p">},</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Supported architectures</strong>:</p>
<ul>
<li><code>amd64</code> (x86-64)</li>
<li><code>arm64</code> (AArch64)</li>
</ul>
<p><strong>Default</strong>: Empty slice (or omit field) means the detector supports all architectures.</p>
<p><strong>When to use</strong>: Only when your detector uses architecture-specific logic or syscalls that don't exist on all platforms.</p>
<h3 id="tracee-version-constraints">Tracee Version Constraints<a class="headerlink" href="#tracee-version-constraints" title="Permanent link">&para;</a></h3>
<p>Require minimum/maximum Tracee version:</p>
<div class="highlight"><pre><span></span><code><span class="nx">DetectorDefinition</span><span class="p">{</span>
<span class="w">    </span><span class="nx">ID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TRC-NEW-001&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">Requirements</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorRequirements</span><span class="p">{</span>
<span class="w">        </span><span class="nx">MinTraceeVersion</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Version</span><span class="p">{</span>
<span class="w">            </span><span class="nx">Major</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">            </span><span class="nx">Minor</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span>
<span class="w">            </span><span class="nx">Patch</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="c1">// MaxTraceeVersion is optional (exclusive)</span>
<span class="w">    </span><span class="p">},</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>When to use</strong>: Your detector relies on features introduced in specific Tracee versions.</p>
<h3 id="complete-requirements-example">Complete Requirements Example<a class="headerlink" href="#complete-requirements-example" title="Permanent link">&para;</a></h3>
<p>Putting it all together - a detector with all requirement types:</p>
<div class="highlight"><pre><span></span><code><span class="nx">DetectorDefinition</span><span class="p">{</span>
<span class="w">    </span><span class="nx">ID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TRC-COMPREHENSIVE-001&quot;</span><span class="p">,</span>

<span class="w">    </span><span class="nx">Requirements</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorRequirements</span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Event requirements with filters</span>
<span class="w">        </span><span class="nx">Events</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">EventRequirement</span><span class="p">{</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;security_file_open&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nx">DataFilters</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">{</span>
<span class="w">                    </span><span class="s">&quot;pathname=/etc/shadow&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="s">&quot;pathname=/etc/sudoers&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="s">&quot;pathname=/root/.ssh/*&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nx">ScopeFilters</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">{</span>
<span class="w">                    </span><span class="s">&quot;container=started&quot;</span><span class="p">,</span><span class="w">  </span><span class="c1">// Containers only</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nx">MinVersion</span><span class="p">:</span><span class="w">  </span><span class="o">&amp;</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Version</span><span class="p">{</span><span class="nx">Major</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">Minor</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">},</span>
<span class="w">                </span><span class="nx">Dependency</span><span class="p">:</span><span class="w">  </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DependencyRequired</span><span class="p">,</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="nx">Name</span><span class="p">:</span><span class="w">       </span><span class="s">&quot;security_inode_unlink&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nx">DataFilters</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="s">&quot;pathname=/var/log/*&quot;</span><span class="p">},</span>
<span class="w">                </span><span class="nx">Dependency</span><span class="p">:</span><span class="w">  </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DependencyOptional</span><span class="p">,</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">        </span><span class="p">},</span>

<span class="w">        </span><span class="c1">// Datastore requirements</span>
<span class="w">        </span><span class="nx">DataStores</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DataStoreRequirement</span><span class="p">{</span>
<span class="w">            </span><span class="p">{</span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;process&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">Dependency</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DependencyRequired</span><span class="p">},</span>
<span class="w">            </span><span class="p">{</span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;container&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">Dependency</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DependencyOptional</span><span class="p">},</span>
<span class="w">        </span><span class="p">},</span>

<span class="w">        </span><span class="c1">// Enrichment requirements</span>
<span class="w">        </span><span class="nx">Enrichments</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">EnrichmentRequirement</span><span class="p">{</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="nx">Name</span><span class="p">:</span><span class="w">       </span><span class="s">&quot;executable-hash&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nx">Config</span><span class="p">:</span><span class="w">     </span><span class="s">&quot;digest-inode&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nx">Dependency</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DependencyRequired</span><span class="p">,</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="nx">Name</span><span class="p">:</span><span class="w">       </span><span class="s">&quot;environment&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nx">Dependency</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DependencyOptional</span><span class="p">,</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">        </span><span class="p">},</span>

<span class="w">        </span><span class="c1">// Architecture constraints (rarely needed)</span>
<span class="w">        </span><span class="nx">Architectures</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="s">&quot;amd64&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;arm64&quot;</span><span class="p">},</span>

<span class="w">        </span><span class="c1">// Version constraints (if detector uses new features)</span>
<span class="w">        </span><span class="nx">MinTraceeVersion</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Version</span><span class="p">{</span>
<span class="w">            </span><span class="nx">Major</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">            </span><span class="nx">Minor</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span>
<span class="w">            </span><span class="nx">Patch</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="c1">// MaxTraceeVersion is optional (exclusive upper bound)</span>
<span class="w">    </span><span class="p">},</span>

<span class="w">    </span><span class="c1">// ... rest of definition (ProducedEvent, ThreatMetadata, etc.)</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="detectoroutput">DetectorOutput<a class="headerlink" href="#detectoroutput" title="Permanent link">&para;</a></h2>
<h3 id="structure">Structure<a class="headerlink" href="#structure" title="Permanent link">&para;</a></h3>
<p>What your <code>OnEvent()</code> returns:</p>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">DetectorOutput</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Event data fields (required) - corresponds to ProducedEvent.Fields</span>
<span class="w">    </span><span class="nx">Data</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">EventValue</span>

<span class="w">    </span><span class="c1">// Override auto-population settings for this output (optional)</span>
<span class="w">    </span><span class="c1">// If nil, uses Definition.AutoPopulate</span>
<span class="w">    </span><span class="nx">AutoPopulate</span><span class="w"> </span><span class="o">*</span><span class="nx">AutoPopulateFields</span>

<span class="w">    </span><span class="c1">// Override threat metadata (optional) - overrides Definition.ThreatMetadata</span>
<span class="w">    </span><span class="nx">Threat</span><span class="w"> </span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Threat</span>

<span class="w">    </span><span class="c1">// Override ancestry depth (optional) - overrides AutoPopulate.ProcessAncestry</span>
<span class="w">    </span><span class="nx">AncestryDepth</span><span class="w"> </span><span class="o">*</span><span class="kt">uint32</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="helper-functions">Helper Functions<a class="headerlink" href="#helper-functions" title="Permanent link">&para;</a></h3>
<p>For cleaner, self-documenting code, use these helpers instead of constructing <code>DetectorOutput</code> directly:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Simple detection - all info in triggering event, auto-populated by engine</span>
<span class="k">return</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">Detected</span><span class="p">(),</span><span class="w"> </span><span class="kc">nil</span>

<span class="c1">// Detection with additional data</span>
<span class="k">return</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectedWithData</span><span class="p">([]</span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">EventValue</span><span class="p">{</span>
<span class="w">    </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewStringValue</span><span class="p">(</span><span class="s">&quot;env_var&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">envValue</span><span class="p">),</span>
<span class="p">}),</span><span class="w"> </span><span class="kc">nil</span>

<span class="c1">// Complex cases - use struct literal for multiple fields</span>
<span class="k">return</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">{{</span>
<span class="w">    </span><span class="nx">Data</span><span class="p">:</span><span class="w">          </span><span class="nx">data</span><span class="p">,</span>
<span class="w">    </span><span class="nx">Threat</span><span class="p">:</span><span class="w">        </span><span class="nx">customThreat</span><span class="p">,</span>
<span class="w">    </span><span class="nx">AncestryDepth</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">depth</span><span class="p">,</span>
<span class="p">}},</span><span class="w"> </span><span class="kc">nil</span>
</code></pre></div>
<h3 id="creating-event-data">Creating Event Data<a class="headerlink" href="#creating-event-data" title="Permanent link">&para;</a></h3>
<p>Use helper functions to create type-safe event values:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// String values</span>
<span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewStringValue</span><span class="p">(</span><span class="s">&quot;field_name&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;value&quot;</span><span class="p">)</span>

<span class="c1">// Integer values</span>
<span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewInt32Value</span><span class="p">(</span><span class="s">&quot;count&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">int32</span><span class="p">(</span><span class="mi">42</span><span class="p">))</span>
<span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewInt64Value</span><span class="p">(</span><span class="s">&quot;count&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">int64</span><span class="p">(</span><span class="mi">42</span><span class="p">))</span>
<span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewUInt32Value</span><span class="p">(</span><span class="s">&quot;flags&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">uint32</span><span class="p">(</span><span class="mh">0x1234</span><span class="p">))</span>
<span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewUInt64Value</span><span class="p">(</span><span class="s">&quot;flags&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">uint64</span><span class="p">(</span><span class="mh">0x1234</span><span class="p">))</span>

<span class="c1">// Boolean values</span>
<span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewBoolValue</span><span class="p">(</span><span class="s">&quot;is_suspicious&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>

<span class="c1">// Byte array values</span>
<span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewBytesValue</span><span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">[]</span><span class="kt">byte</span><span class="p">{</span><span class="mh">0x01</span><span class="p">,</span><span class="w"> </span><span class="mh">0x02</span><span class="p">})</span>

<span class="c1">// Complex example with multiple data fields</span>
<span class="k">return</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectedWithData</span><span class="p">([]</span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">EventValue</span><span class="p">{</span>
<span class="w">    </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewStringValue</span><span class="p">(</span><span class="s">&quot;command&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/bin/bash -c &#39;curl evil.com&#39;&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewStringValue</span><span class="p">(</span><span class="s">&quot;shell&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;bash&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewInt32Value</span><span class="p">(</span><span class="s">&quot;risk_score&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">int32</span><span class="p">(</span><span class="mi">85</span><span class="p">)),</span>
<span class="w">    </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewBoolValue</span><span class="p">(</span><span class="s">&quot;known_ioc&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">),</span>
<span class="p">}),</span><span class="w"> </span><span class="kc">nil</span>
</code></pre></div>
<h3 id="multiple-outputs">Multiple Outputs<a class="headerlink" href="#multiple-outputs" title="Permanent link">&para;</a></h3>
<p>Return multiple detections from a single input:</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">OnEvent</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">Context</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="w"> </span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Event</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">outputs</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">condition1</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">outputs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">append</span><span class="p">(</span><span class="nx">outputs</span><span class="p">,</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">{</span>
<span class="w">            </span><span class="nx">Data</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">EventValue</span><span class="p">{</span>
<span class="w">                </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewStringValue</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pattern_a&quot;</span><span class="p">),</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">        </span><span class="p">})</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">condition2</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">outputs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">append</span><span class="p">(</span><span class="nx">outputs</span><span class="p">,</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">{</span>
<span class="w">            </span><span class="nx">Data</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">EventValue</span><span class="p">{</span>
<span class="w">                </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewStringValue</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pattern_b&quot;</span><span class="p">),</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nx">Threat</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Threat</span><span class="p">{</span>
<span class="w">                </span><span class="nx">Severity</span><span class="p">:</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Severity_HIGH</span><span class="p">,</span><span class="w">  </span><span class="c1">// Different severity</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">        </span><span class="p">})</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">outputs</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="no-detection">No Detection<a class="headerlink" href="#no-detection" title="Permanent link">&para;</a></h3>
<p>Return <code>nil, nil</code> when no detection occurred:</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">OnEvent</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">Context</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="w"> </span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Event</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">value</span><span class="p">,</span><span class="w"> </span><span class="nx">found</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">GetData</span><span class="p">[</span><span class="kt">string</span><span class="p">](</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;field&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">found</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">!</span><span class="nx">d</span><span class="p">.</span><span class="nx">isSuspicious</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span><span class="w">  </span><span class="c1">// No detection</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">{{</span><span class="o">...</span><span class="p">}},</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="auto-population">Auto-Population<a class="headerlink" href="#auto-population" title="Permanent link">&para;</a></h2>
<p>Declaratively specify automatic field enrichment:</p>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">AutoPopulateFields</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Threat</span><span class="w">          </span><span class="kt">bool</span><span class="w">  </span><span class="c1">// Copy ThreatMetadata to output</span>
<span class="w">    </span><span class="nx">DetectedFrom</span><span class="w">    </span><span class="kt">bool</span><span class="w">  </span><span class="c1">// Link to triggering event</span>
<span class="w">    </span><span class="nx">ProcessAncestry</span><span class="w"> </span><span class="kt">bool</span><span class="w">  </span><span class="c1">// Fetch 5 levels of process ancestry</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="threat-automatic-threat-metadata">Threat: Automatic Threat Metadata<a class="headerlink" href="#threat-automatic-threat-metadata" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nx">AutoPopulate</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">AutoPopulateFields</span><span class="p">{</span>
<span class="w">    </span><span class="nx">Threat</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Behavior</strong>:</p>
<ul>
<li>If <code>output.Threat</code> is nil, engine copies <code>Definition.ThreatMetadata</code></li>
<li>If <code>output.Threat</code> is set, that takes precedence</li>
<li><code>Definition.ThreatMetadata</code> acts as a template/default</li>
</ul>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// In definition</span>
<span class="nx">ThreatMetadata</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Threat</span><span class="p">{</span>
<span class="w">    </span><span class="nx">Name</span><span class="p">:</span><span class="w">     </span><span class="s">&quot;Suspicious File Access&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">Severity</span><span class="p">:</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Severity_MEDIUM</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1">// In OnEvent - uses default</span>
<span class="k">return</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">{{</span>
<span class="w">    </span><span class="nx">Data</span><span class="p">:</span><span class="w"> </span><span class="nx">data</span><span class="p">,</span>
<span class="w">    </span><span class="c1">// Threat: nil - engine copies ThreatMetadata above</span>
<span class="p">}},</span><span class="w"> </span><span class="kc">nil</span>

<span class="c1">// In OnEvent - overrides default</span>
<span class="k">return</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">{{</span>
<span class="w">    </span><span class="nx">Data</span><span class="p">:</span><span class="w"> </span><span class="nx">data</span><span class="p">,</span>
<span class="w">    </span><span class="nx">Threat</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Threat</span><span class="p">{</span>
<span class="w">        </span><span class="nx">Name</span><span class="p">:</span><span class="w">     </span><span class="s">&quot;Critical System File Access&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">Severity</span><span class="p">:</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Severity_CRITICAL</span><span class="p">,</span><span class="w">  </span><span class="c1">// Higher severity</span>
<span class="w">    </span><span class="p">},</span>
<span class="p">}},</span><span class="w"> </span><span class="kc">nil</span>
</code></pre></div>
<h3 id="detectedfrom-provenance-tracking">DetectedFrom: Provenance Tracking<a class="headerlink" href="#detectedfrom-provenance-tracking" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nx">AutoPopulate</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">AutoPopulateFields</span><span class="p">{</span>
<span class="w">    </span><span class="nx">DetectedFrom</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Behavior</strong>: Engine sets <code>output.DetectedFrom</code> with:</p>
<ul>
<li><code>event_id</code> - Triggering event's ID</li>
<li><code>event_name</code> - Triggering event's name</li>
<li><code>stack_addresses</code> - Stack trace (if available)</li>
</ul>
<p><strong>Output structure</strong>:
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;detected_from&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;event_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">257</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;event_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;security_file_open&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;stack_addresses&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">...</span><span class="p">]</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p><strong>Use cases</strong>:
- Debugging: Understand why detector fired
- Forensics: Reconstruct detection chains
- Correlation: Link detections to root causes</p>
<h4 id="detection-chain-preservation">Detection Chain Preservation<a class="headerlink" href="#detection-chain-preservation" title="Permanent link">&para;</a></h4>
<p>When detectors form chains (detector consuming another detector's output), the engine automatically preserves the complete provenance chain via <code>DetectedFrom.parent</code>:</p>
<p><strong>Example 3-level chain:</strong></p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;critical_threat_in_production&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;detected_from&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;7001&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;suspicious_container_exec&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;binary&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;nc&quot;</span><span class="p">}],</span>
<span class="w">    </span><span class="nt">&quot;parent&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;7000&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;suspicious_binary_exec&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pathname&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/usr/bin/nc&quot;</span><span class="p">}],</span>
<span class="w">      </span><span class="nt">&quot;parent&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;700&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sched_process_exec&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pathname&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/usr/bin/nc&quot;</span><span class="p">}]</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Traversal helpers:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Get full chain (immediate parent to root)</span>
<span class="nx">chain</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">GetDetectionChain</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span>

<span class="c1">// Get original triggering event</span>
<span class="nx">root</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">GetRootDetection</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span>

<span class="c1">// Get chain depth</span>
<span class="nx">depth</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">GetChainDepth</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span><span class="w">  </span><span class="c1">// 3 for example above</span>
</code></pre></div>
<p>This chaining is automatic - detectors don't need to do anything special.</p>
<h3 id="processancestry-automatic-ancestry-enrichment">ProcessAncestry: Automatic Ancestry Enrichment<a class="headerlink" href="#processancestry-automatic-ancestry-enrichment" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nx">AutoPopulate</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">AutoPopulateFields</span><span class="p">{</span>
<span class="w">    </span><span class="nx">ProcessAncestry</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">  </span><span class="c1">// Default: 5 levels</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Requirements</strong>:</p>
<ul>
<li>Tracee must run with <code>--stores process</code></li>
<li>Process must be in the process tree</li>
<li>Default depth: 5 levels (parent  grandparent  great-grandparent  ...)</li>
</ul>
<p><strong>Ancestry structure</strong>:
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;workload&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;process&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;entity_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">12345</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;pid&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">67890</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;executable&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/bin/cat&quot;</span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;ancestors&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span><span class="nt">&quot;entity_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">12344</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;pid&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">67889</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;executable&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/bin/bash&quot;</span><span class="p">}},</span>
<span class="w">        </span><span class="p">{</span><span class="nt">&quot;entity_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">12343</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;pid&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">67888</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;thread&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sshd&quot;</span><span class="p">}},</span>
<span class="w">        </span><span class="p">{</span><span class="nt">&quot;entity_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;pid&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;thread&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;systemd&quot;</span><span class="p">}}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p><strong>Per-detection ancestry depth control</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">OnEvent</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">Context</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="w"> </span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Event</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">severity</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">analyzeThreat</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">severity</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;critical&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Deep ancestry for forensics</span>
<span class="w">        </span><span class="nx">depth</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">uint32</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">{{</span>
<span class="w">            </span><span class="nx">Data</span><span class="p">:</span><span class="w">          </span><span class="nx">data</span><span class="p">,</span>
<span class="w">            </span><span class="nx">AncestryDepth</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">depth</span><span class="p">,</span>
<span class="w">        </span><span class="p">}},</span><span class="w"> </span><span class="kc">nil</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">severity</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;low&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Disable ancestry for performance</span>
<span class="w">        </span><span class="nx">depth</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">uint32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">{{</span>
<span class="w">            </span><span class="nx">Data</span><span class="p">:</span><span class="w">          </span><span class="nx">data</span><span class="p">,</span>
<span class="w">            </span><span class="nx">AncestryDepth</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">depth</span><span class="p">,</span>
<span class="w">        </span><span class="p">}},</span><span class="w"> </span><span class="kc">nil</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Use default (ProcessAncestry=true  5 levels)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">{{</span>
<span class="w">        </span><span class="nx">Data</span><span class="p">:</span><span class="w"> </span><span class="nx">data</span><span class="p">,</span>
<span class="w">        </span><span class="c1">// AncestryDepth: nil</span>
<span class="w">    </span><span class="p">}},</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="complete-auto-population-example">Complete Auto-Population Example<a class="headerlink" href="#complete-auto-population-example" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nx">DetectorDefinition</span><span class="p">{</span>
<span class="w">    </span><span class="nx">ID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TRC-001&quot;</span><span class="p">,</span>

<span class="w">    </span><span class="nx">ThreatMetadata</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Threat</span><span class="p">{</span>
<span class="w">        </span><span class="nx">Name</span><span class="p">:</span><span class="w">     </span><span class="s">&quot;Sensitive File Access&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">Severity</span><span class="p">:</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Severity_MEDIUM</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span>

<span class="w">    </span><span class="nx">AutoPopulate</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">AutoPopulateFields</span><span class="p">{</span>
<span class="w">        </span><span class="nx">Threat</span><span class="p">:</span><span class="w">          </span><span class="kc">true</span><span class="p">,</span><span class="w">  </span><span class="c1">// Copy ThreatMetadata</span>
<span class="w">        </span><span class="nx">DetectedFrom</span><span class="p">:</span><span class="w">    </span><span class="kc">true</span><span class="p">,</span><span class="w">  </span><span class="c1">// Add provenance</span>
<span class="w">        </span><span class="nx">ProcessAncestry</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">  </span><span class="c1">// Add 5-level ancestry</span>
<span class="w">    </span><span class="p">},</span>
<span class="p">}</span>

<span class="c1">// OnEvent just returns data - engine enriches everything else</span>
<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">OnEvent</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">Context</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="w"> </span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Event</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">{{</span>
<span class="w">        </span><span class="nx">Data</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">EventValue</span><span class="p">{</span>
<span class="w">            </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewStringValue</span><span class="p">(</span><span class="s">&quot;file&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/etc/shadow&quot;</span><span class="p">),</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="c1">// Engine automatically adds:</span>
<span class="w">        </span><span class="c1">// - Threat (from ThreatMetadata)</span>
<span class="w">        </span><span class="c1">// - DetectedFrom (provenance)</span>
<span class="w">        </span><span class="c1">// - Workload.Process.Ancestors (5 levels)</span>
<span class="w">    </span><span class="p">}},</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="overriding-auto-population-per-output">Overriding Auto-Population Per Output<a class="headerlink" href="#overriding-auto-population-per-output" title="Permanent link">&para;</a></h3>
<p>You can override auto-population settings for specific outputs using the <code>AutoPopulate</code> field in <code>DetectorOutput</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">OnEvent</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">Context</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="w"> </span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Event</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">severity</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">analyzeThreat</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">severity</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;critical&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Enable all enrichment for critical threats</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">{{</span>
<span class="w">            </span><span class="nx">Data</span><span class="p">:</span><span class="w"> </span><span class="nx">data</span><span class="p">,</span>
<span class="w">            </span><span class="nx">AutoPopulate</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">detection</span><span class="p">.</span><span class="nx">AutoPopulateFields</span><span class="p">{</span>
<span class="w">                </span><span class="nx">Threat</span><span class="p">:</span><span class="w">          </span><span class="kc">true</span><span class="p">,</span>
<span class="w">                </span><span class="nx">DetectedFrom</span><span class="p">:</span><span class="w">    </span><span class="kc">true</span><span class="p">,</span>
<span class="w">                </span><span class="nx">ProcessAncestry</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">        </span><span class="p">}},</span><span class="w"> </span><span class="kc">nil</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">severity</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;low&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Disable enrichment for low-severity detections (performance)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">{{</span>
<span class="w">            </span><span class="nx">Data</span><span class="p">:</span><span class="w"> </span><span class="nx">data</span><span class="p">,</span>
<span class="w">            </span><span class="nx">AutoPopulate</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">detection</span><span class="p">.</span><span class="nx">AutoPopulateFields</span><span class="p">{</span>
<span class="w">                </span><span class="nx">Threat</span><span class="p">:</span><span class="w">          </span><span class="kc">true</span><span class="p">,</span>
<span class="w">                </span><span class="nx">DetectedFrom</span><span class="p">:</span><span class="w">    </span><span class="kc">false</span><span class="p">,</span><span class="w">  </span><span class="c1">// Skip provenance</span>
<span class="w">                </span><span class="nx">ProcessAncestry</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">  </span><span class="c1">// Skip ancestry</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">        </span><span class="p">}},</span><span class="w"> </span><span class="kc">nil</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Use default from Definition.AutoPopulate</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">{{</span>
<span class="w">        </span><span class="nx">Data</span><span class="p">:</span><span class="w"> </span><span class="nx">data</span><span class="p">,</span>
<span class="w">        </span><span class="c1">// AutoPopulate: nil - uses Definition.AutoPopulate</span>
<span class="w">    </span><span class="p">}},</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Use cases for per-output overrides</strong>:</p>
<ul>
<li>Vary enrichment based on threat severity</li>
<li>Skip expensive enrichment for low-confidence detections</li>
<li>Add extra context for high-priority alerts</li>
</ul>
<hr />
<h2 id="lifecycle-management">Lifecycle Management<a class="headerlink" href="#lifecycle-management" title="Permanent link">&para;</a></h2>
<h3 id="init-best-practices">Init() Best Practices<a class="headerlink" href="#init-best-practices" title="Permanent link">&para;</a></h3>
<p>Called once at startup - use for initialization:</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">Init</span><span class="p">(</span><span class="nx">params</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorParams</span><span class="p">)</span><span class="w"> </span><span class="kt">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 1. Store logger (always do this)</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">params</span><span class="p">.</span><span class="nx">Logger</span>

<span class="w">    </span><span class="c1">// 2. Store datastores if needed</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">params</span><span class="p">.</span><span class="nx">DataStores</span>

<span class="w">    </span><span class="c1">// 3. Validate required datastores</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">params</span><span class="p">.</span><span class="nx">DataStores</span><span class="p">.</span><span class="nx">IsAvailable</span><span class="p">(</span><span class="s">&quot;process&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">New</span><span class="p">(</span><span class="s">&quot;process store required but unavailable&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 4. Initialize detector state</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">cache</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">int</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// 5. Log initialization</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Debugw</span><span class="p">(</span><span class="s">&quot;Detector initialized&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;id&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">GetDefinition</span><span class="p">().</span><span class="nx">ID</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;version&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">GetDefinition</span><span class="p">().</span><span class="nx">ProducedEvent</span><span class="p">.</span><span class="nx">Version</span><span class="p">,</span>
<span class="w">    </span><span class="p">)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Don't do in Init()</strong>:</p>
<ul>
<li>Heavy computation (blocks startup)</li>
<li>Network requests</li>
<li>File I/O (except small config files)</li>
</ul>
<h3 id="onevent-guidelines">OnEvent() Guidelines<a class="headerlink" href="#onevent-guidelines" title="Permanent link">&para;</a></h3>
<p>Called for every matching event - must be fast:</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">OnEvent</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">Context</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="w"> </span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Event</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 1. Respect context cancellation</span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="o">&lt;-</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">Done</span><span class="p">():</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">ctx</span><span class="p">.</span><span class="nx">Err</span><span class="p">()</span>
<span class="w">    </span><span class="k">default</span><span class="p">:</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 2. Extract required data early</span>
<span class="w">    </span><span class="nx">value</span><span class="p">,</span><span class="w"> </span><span class="nx">found</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">GetData</span><span class="p">[</span><span class="kt">string</span><span class="p">](</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;field&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">found</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span><span class="w">  </span><span class="c1">// Skip silently</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 3. Fast-path rejection</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">d</span><span class="p">.</span><span class="nx">couldBeSuspicious</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 4. Detailed analysis</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">isSuspicious</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">{{</span>
<span class="w">            </span><span class="nx">Data</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">EventValue</span><span class="p">{</span>
<span class="w">                </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewStringValue</span><span class="p">(</span><span class="s">&quot;field&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="p">),</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">        </span><span class="p">}},</span><span class="w"> </span><span class="kc">nil</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Performance tips</strong>:</p>
<ul>
<li>Check cheapest conditions first</li>
<li>Use datastores judiciously (they're fast but not free)</li>
<li>Avoid allocations in hot path</li>
<li>Consider caching expensive computations</li>
</ul>
<h3 id="error-handling-guidelines">Error Handling Guidelines<a class="headerlink" href="#error-handling-guidelines" title="Permanent link">&para;</a></h3>
<p><strong>Transient errors</strong> - Return error, engine may retry:</p>
<div class="highlight"><pre><span></span><code><span class="nx">proc</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Processes</span><span class="p">().</span><span class="nx">GetProcess</span><span class="p">(</span><span class="nx">entityId</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">!</span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrNotFound</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;failed to get process: %w&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Expected conditions</strong> - Return nil detection:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Data not found - this is normal</span>
<span class="k">if</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrNotFound</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>

<span class="c1">// Optional field missing - expected</span>
<span class="nx">value</span><span class="p">,</span><span class="w"> </span><span class="nx">found</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">GetData</span><span class="p">[</span><span class="kt">string</span><span class="p">](</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;optional_field&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">found</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Critical errors</strong> - Log and return error:</p>
<div class="highlight"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">criticalOperation</span><span class="p">();</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">Errorw</span><span class="p">(</span><span class="s">&quot;Critical operation failed&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;error&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;event&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">Name</span><span class="p">,</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;critical failure: %w&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Error wrapping</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Good - provides context</span>
<span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;failed to analyze process %d: %w&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">pid</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>

<span class="c1">// Bad - loses context</span>
<span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span>
</code></pre></div>
<hr />
<h2 id="testing">Testing<a class="headerlink" href="#testing" title="Permanent link">&para;</a></h2>
<h3 id="unit-testing-patterns">Unit Testing Patterns<a class="headerlink" href="#unit-testing-patterns" title="Permanent link">&para;</a></h3>
<p>Test detectors with mock events:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">detectors</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;context&quot;</span>
<span class="w">    </span><span class="s">&quot;testing&quot;</span>

<span class="w">    </span><span class="s">&quot;github.com/aquasecurity/tracee/api/v1beta1&quot;</span>
<span class="w">    </span><span class="s">&quot;github.com/aquasecurity/tracee/api/v1beta1/detection&quot;</span>
<span class="w">    </span><span class="s">&quot;github.com/stretchr/testify/assert&quot;</span>
<span class="w">    </span><span class="s">&quot;github.com/stretchr/testify/require&quot;</span>
<span class="p">)</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">TestSensitiveFileAccess_OnEvent</span><span class="p">(</span><span class="nx">t</span><span class="w"> </span><span class="o">*</span><span class="nx">testing</span><span class="p">.</span><span class="nx">T</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">detector</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">SensitiveFileAccess</span><span class="p">{}</span>

<span class="w">    </span><span class="c1">// Initialize with test params</span>
<span class="w">    </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">detector</span><span class="p">.</span><span class="nx">Init</span><span class="p">(</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorParams</span><span class="p">{</span>
<span class="w">        </span><span class="nx">Logger</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">mockLogger</span><span class="p">{},</span><span class="w">  </span><span class="c1">// Use your mock logger implementation</span>
<span class="w">        </span><span class="nx">Config</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">NewEmptyDetectorConfig</span><span class="p">(),</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="nx">require</span><span class="p">.</span><span class="nx">NoError</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>

<span class="w">    </span><span class="nx">t</span><span class="p">.</span><span class="nx">Run</span><span class="p">(</span><span class="s">&quot;detects_shadow_access&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">t</span><span class="w"> </span><span class="o">*</span><span class="nx">testing</span><span class="p">.</span><span class="nx">T</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">event</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Event</span><span class="p">{</span>
<span class="w">            </span><span class="nx">Id</span><span class="p">:</span><span class="w">   </span><span class="mi">257</span><span class="p">,</span>
<span class="w">            </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;security_file_open&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nx">Data</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">EventValue</span><span class="p">{</span>
<span class="w">                </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewStringValue</span><span class="p">(</span><span class="s">&quot;pathname&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/etc/shadow&quot;</span><span class="p">),</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nx">outputs</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">detector</span><span class="p">.</span><span class="nx">OnEvent</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">Background</span><span class="p">(),</span><span class="w"> </span><span class="nx">event</span><span class="p">)</span>

<span class="w">        </span><span class="nx">require</span><span class="p">.</span><span class="nx">NoError</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
<span class="w">        </span><span class="nx">require</span><span class="p">.</span><span class="nx">Len</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span><span class="w"> </span><span class="nx">outputs</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>

<span class="w">        </span><span class="c1">// Verify output data</span>
<span class="w">        </span><span class="nx">data</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">Data</span>
<span class="w">        </span><span class="nx">require</span><span class="p">.</span><span class="nx">Len</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">        </span><span class="nx">assert</span><span class="p">.</span><span class="nx">Equal</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;file_path&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">Name</span><span class="p">)</span>
<span class="w">        </span><span class="nx">assert</span><span class="p">.</span><span class="nx">Equal</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/etc/shadow&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">GetValue</span><span class="p">().</span><span class="nx">GetStringValue</span><span class="p">())</span>
<span class="w">    </span><span class="p">})</span>

<span class="w">    </span><span class="nx">t</span><span class="p">.</span><span class="nx">Run</span><span class="p">(</span><span class="s">&quot;ignores_normal_files&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">t</span><span class="w"> </span><span class="o">*</span><span class="nx">testing</span><span class="p">.</span><span class="nx">T</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">event</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Event</span><span class="p">{</span>
<span class="w">            </span><span class="nx">Id</span><span class="p">:</span><span class="w">   </span><span class="mi">257</span><span class="p">,</span>
<span class="w">            </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;security_file_open&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nx">Data</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">EventValue</span><span class="p">{</span>
<span class="w">                </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewStringValue</span><span class="p">(</span><span class="s">&quot;pathname&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/tmp/normal.txt&quot;</span><span class="p">),</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nx">outputs</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">detector</span><span class="p">.</span><span class="nx">OnEvent</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">Background</span><span class="p">(),</span><span class="w"> </span><span class="nx">event</span><span class="p">)</span>

<span class="w">        </span><span class="nx">require</span><span class="p">.</span><span class="nx">NoError</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
<span class="w">        </span><span class="nx">assert</span><span class="p">.</span><span class="nx">Empty</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span><span class="w"> </span><span class="nx">outputs</span><span class="p">)</span><span class="w">  </span><span class="c1">// No detection expected</span>
<span class="w">    </span><span class="p">})</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="mock-logger-and-datastores">Mock Logger and DataStores<a class="headerlink" href="#mock-logger-and-datastores" title="Permanent link">&para;</a></h3>
<p>Create mock implementations for testing:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Mock logger for testing</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">mockLogger</span><span class="w"> </span><span class="kd">struct</span><span class="p">{}</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">m</span><span class="w"> </span><span class="o">*</span><span class="nx">mockLogger</span><span class="p">)</span><span class="w"> </span><span class="nx">Debugw</span><span class="p">(</span><span class="nx">msg</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">keysAndValues</span><span class="w"> </span><span class="o">...</span><span class="kt">any</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">m</span><span class="w"> </span><span class="o">*</span><span class="nx">mockLogger</span><span class="p">)</span><span class="w"> </span><span class="nx">Infow</span><span class="p">(</span><span class="nx">msg</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">keysAndValues</span><span class="w"> </span><span class="o">...</span><span class="kt">any</span><span class="p">)</span><span class="w">  </span><span class="p">{}</span>
<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">m</span><span class="w"> </span><span class="o">*</span><span class="nx">mockLogger</span><span class="p">)</span><span class="w"> </span><span class="nx">Warnw</span><span class="p">(</span><span class="nx">msg</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">keysAndValues</span><span class="w"> </span><span class="o">...</span><span class="kt">any</span><span class="p">)</span><span class="w">  </span><span class="p">{}</span>
<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">m</span><span class="w"> </span><span class="o">*</span><span class="nx">mockLogger</span><span class="p">)</span><span class="w"> </span><span class="nx">Errorw</span><span class="p">(</span><span class="nx">msg</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">keysAndValues</span><span class="w"> </span><span class="o">...</span><span class="kt">any</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>

<span class="c1">// Mock process store</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">mockProcessStore</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">processes</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">uint32</span><span class="p">]</span><span class="o">*</span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ProcessInfo</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">m</span><span class="w"> </span><span class="o">*</span><span class="nx">mockProcessStore</span><span class="p">)</span><span class="w"> </span><span class="nx">GetProcess</span><span class="p">(</span><span class="nx">entityId</span><span class="w"> </span><span class="kt">uint32</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ProcessInfo</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">proc</span><span class="p">,</span><span class="w"> </span><span class="nx">ok</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">m</span><span class="p">.</span><span class="nx">processes</span><span class="p">[</span><span class="nx">entityId</span><span class="p">]</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">ok</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrNotFound</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">proc</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>

<span class="c1">// Mock datastore registry</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">mockRegistry</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">processStore</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ProcessStore</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">m</span><span class="w"> </span><span class="o">*</span><span class="nx">mockRegistry</span><span class="p">)</span><span class="w"> </span><span class="nx">Processes</span><span class="p">()</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ProcessStore</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">m</span><span class="p">.</span><span class="nx">processStore</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">m</span><span class="w"> </span><span class="o">*</span><span class="nx">mockRegistry</span><span class="p">)</span><span class="w"> </span><span class="nx">IsAvailable</span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;process&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">m</span><span class="p">.</span><span class="nx">processStore</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">TestDetectorWithDataStore</span><span class="p">(</span><span class="nx">t</span><span class="w"> </span><span class="o">*</span><span class="nx">testing</span><span class="p">.</span><span class="nx">T</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Create mock store with test data</span>
<span class="w">    </span><span class="nx">mockStore</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">mockProcessStore</span><span class="p">{</span>
<span class="w">        </span><span class="nx">processes</span><span class="p">:</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">uint32</span><span class="p">]</span><span class="o">*</span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ProcessInfo</span><span class="p">{</span>
<span class="w">            </span><span class="mi">12345</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">EntityID</span><span class="p">:</span><span class="w"> </span><span class="mi">12345</span><span class="p">,</span>
<span class="w">                </span><span class="nx">Executable</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Executable</span><span class="p">{</span><span class="nx">Path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/bin/bash&quot;</span><span class="p">},</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Create mock registry</span>
<span class="w">    </span><span class="nx">registry</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">mockRegistry</span><span class="p">{</span><span class="nx">processStore</span><span class="p">:</span><span class="w"> </span><span class="nx">mockStore</span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Initialize detector with mocks</span>
<span class="w">    </span><span class="nx">detector</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">MyDetector</span><span class="p">{}</span>
<span class="w">    </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">detector</span><span class="p">.</span><span class="nx">Init</span><span class="p">(</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorParams</span><span class="p">{</span>
<span class="w">        </span><span class="nx">Logger</span><span class="p">:</span><span class="w">     </span><span class="o">&amp;</span><span class="nx">mockLogger</span><span class="p">{},</span>
<span class="w">        </span><span class="nx">DataStores</span><span class="p">:</span><span class="w"> </span><span class="nx">registry</span><span class="p">,</span>
<span class="w">        </span><span class="nx">Config</span><span class="p">:</span><span class="w">     </span><span class="nx">detection</span><span class="p">.</span><span class="nx">NewEmptyDetectorConfig</span><span class="p">(),</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="nx">require</span><span class="p">.</span><span class="nx">NoError</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// Test with mock data</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="test-helpers">Test Helpers<a class="headerlink" href="#test-helpers" title="Permanent link">&para;</a></h3>
<p>Use built-in type-safe helpers for data extraction:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Type-safe data extraction with assertion</span>
<span class="nx">pathname</span><span class="p">,</span><span class="w"> </span><span class="nx">found</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">GetData</span><span class="p">[</span><span class="kt">string</span><span class="p">](</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pathname&quot;</span><span class="p">)</span>
<span class="nx">require</span><span class="p">.</span><span class="nx">True</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span><span class="w"> </span><span class="nx">found</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pathname field should exist&quot;</span><span class="p">)</span>
<span class="nx">assert</span><span class="p">.</span><span class="nx">Equal</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/etc/shadow&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">pathname</span><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="best-practices">Best Practices<a class="headerlink" href="#best-practices" title="Permanent link">&para;</a></h2>
<h3 id="detector-design-principles">Detector Design Principles<a class="headerlink" href="#detector-design-principles" title="Permanent link">&para;</a></h3>
<p><strong>1. Single Responsibility</strong>
Each detector should focus on one threat pattern or derived event type.</p>
<p><strong>Good</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Focused on one threat</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">ContainerEscapeDetector</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{}</span>

<span class="c1">// Focused on one derived event type</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">ContainerLifecycleDetector</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{}</span>
</code></pre></div>
<p><strong>Bad</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Too broad</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">AllContainerThreatsDetector</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{}</span><span class="w">  </span><span class="c1">// Don&#39;t do this!</span>
</code></pre></div>
<p><strong>2. Fail Fast</strong>
Reject events as early as possible:</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">OnEvent</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">Context</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="w"> </span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Event</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 1. Check required fields first</span>
<span class="w">    </span><span class="nx">pathname</span><span class="p">,</span><span class="w"> </span><span class="nx">found</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">GetData</span><span class="p">[</span><span class="kt">string</span><span class="p">](</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pathname&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">found</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 2. Quick pattern checks</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">strings</span><span class="p">.</span><span class="nx">HasPrefix</span><span class="p">(</span><span class="nx">pathname</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/etc/&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 3. Expensive checks last</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">isKnownMaliciousPattern</span><span class="p">(</span><span class="nx">pathname</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Create detection</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>3. Leverage Engine Filtering</strong>
Use <code>DataFilters</code> instead of logic in <code>OnEvent()</code>:</p>
<p><strong>Good</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">DataFilters</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">{</span>
<span class="w">    </span><span class="s">&quot;pathname=/etc/*&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;flags&gt;0&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">OnEvent</span><span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Events already filtered - just detection logic</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Bad</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">OnEvent</span><span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">pathname</span><span class="p">,</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">GetData</span><span class="p">[</span><span class="kt">string</span><span class="p">](</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pathname&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">strings</span><span class="p">.</span><span class="nx">HasPrefix</span><span class="p">(</span><span class="nx">pathname</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/etc/&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// Should be in DataFilters!</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>4. Use Auto-Population</strong>
Let the engine handle enrichment:</p>
<p><strong>Good</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nx">AutoPopulate</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">AutoPopulateFields</span><span class="p">{</span>
<span class="w">    </span><span class="nx">Threat</span><span class="p">:</span><span class="w">          </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nx">DetectedFrom</span><span class="p">:</span><span class="w">    </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nx">ProcessAncestry</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">OnEvent</span><span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">{{</span>
<span class="w">        </span><span class="nx">Data</span><span class="p">:</span><span class="w"> </span><span class="nx">simpleData</span><span class="p">,</span><span class="w">  </span><span class="c1">// Just the data fields</span>
<span class="w">    </span><span class="p">}},</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Bad</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">OnEvent</span><span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Don&#39;t manually query ancestry if you can auto-populate!</span>
<span class="w">    </span><span class="nx">ancestry</span><span class="p">,</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Processes</span><span class="p">().</span><span class="nx">GetAncestry</span><span class="p">(</span><span class="nx">entityId</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="w">    </span><span class="c1">// Manual enrichment is error-prone and slower</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>5. Graceful Degradation</strong>
Handle missing datastores gracefully:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// In Init - validate required stores</span>
<span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">params</span><span class="p">.</span><span class="nx">DataStores</span><span class="p">.</span><span class="nx">IsAvailable</span><span class="p">(</span><span class="s">&quot;process&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">New</span><span class="p">(</span><span class="s">&quot;process store required&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// In OnEvent - handle optional stores</span>
<span class="k">if</span><span class="w"> </span><span class="nx">params</span><span class="p">.</span><span class="nx">DataStores</span><span class="p">.</span><span class="nx">IsAvailable</span><span class="p">(</span><span class="s">&quot;container&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">containerInfo</span><span class="p">,</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Containers</span><span class="p">().</span><span class="nx">GetContainer</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
<span class="w">    </span><span class="c1">// Use if available</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="performance-considerations">Performance Considerations<a class="headerlink" href="#performance-considerations" title="Permanent link">&para;</a></h3>
<p><strong>1. Minimize DataStore Queries</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Good - single query</span>
<span class="nx">proc</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Processes</span><span class="p">().</span><span class="nx">GetProcess</span><span class="p">(</span><span class="nx">entityId</span><span class="p">)</span>

<span class="c1">// Bad - unnecessary queries</span>
<span class="nx">proc</span><span class="p">,</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Processes</span><span class="p">().</span><span class="nx">GetProcess</span><span class="p">(</span><span class="nx">entityId</span><span class="p">)</span>
<span class="nx">ancestors</span><span class="p">,</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Processes</span><span class="p">().</span><span class="nx">GetAncestry</span><span class="p">(</span><span class="nx">entityId</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="c1">// Could use AutoPopulate.ProcessAncestry instead!</span>
</code></pre></div>
<p><strong>2. Cache Expensive Computations</strong></p>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">MyDetector</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">mu</span><span class="w">    </span><span class="nx">sync</span><span class="p">.</span><span class="nx">RWMutex</span>
<span class="w">    </span><span class="nx">cache</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="nx">result</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">expensiveCheck</span><span class="p">(</span><span class="nx">key</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Check cache (read lock)</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">mu</span><span class="p">.</span><span class="nx">RLock</span><span class="p">()</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">cached</span><span class="p">,</span><span class="w"> </span><span class="nx">ok</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">cache</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span><span class="w"> </span><span class="nx">ok</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">d</span><span class="p">.</span><span class="nx">mu</span><span class="p">.</span><span class="nx">RUnlock</span><span class="p">()</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">cached</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">mu</span><span class="p">.</span><span class="nx">RUnlock</span><span class="p">()</span>

<span class="w">    </span><span class="c1">// Compute (write lock)</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">mu</span><span class="p">.</span><span class="nx">Lock</span><span class="p">()</span>
<span class="w">    </span><span class="k">defer</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">mu</span><span class="p">.</span><span class="nx">Unlock</span><span class="p">()</span>

<span class="w">    </span><span class="c1">// Double-check after acquiring write lock</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">cached</span><span class="p">,</span><span class="w"> </span><span class="nx">ok</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">cache</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span><span class="w"> </span><span class="nx">ok</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">cached</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">result</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">compute</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">cache</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">result</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">result</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>3. Batch Operations</strong>
If checking multiple conditions, batch them:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Good - batch check</span>
<span class="k">if</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">isSuspiciousPath</span><span class="p">(</span><span class="nx">pathname</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">   </span><span class="nx">d</span><span class="p">.</span><span class="nx">isSuspiciousFlags</span><span class="p">(</span><span class="nx">flags</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">   </span><span class="nx">d</span><span class="p">.</span><span class="nx">isSuspiciousProcess</span><span class="p">(</span><span class="nx">proc</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// All checks passed</span>
<span class="p">}</span>

<span class="c1">// Bad - create intermediary slices</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">checks</span><span class="w"> </span><span class="p">[]</span><span class="kt">bool</span>
<span class="nx">checks</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">append</span><span class="p">(</span><span class="nx">checks</span><span class="p">,</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">isSuspiciousPath</span><span class="p">(</span><span class="nx">pathname</span><span class="p">))</span>
<span class="nx">checks</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">append</span><span class="p">(</span><span class="nx">checks</span><span class="p">,</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">isSuspiciousFlags</span><span class="p">(</span><span class="nx">flags</span><span class="p">))</span>
<span class="c1">// Unnecessary allocations</span>
</code></pre></div>
<p><strong>4. Use Appropriate Data Structures</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Good - fast lookup</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">MyDetector</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">suspiciousPaths</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">bool</span><span class="w">  </span><span class="c1">// O(1) lookup</span>
<span class="p">}</span>

<span class="c1">// Bad - linear search</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">MyDetector</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">suspiciousPaths</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="w">  </span><span class="c1">// O(n) lookup</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="code-organization">Code Organization<a class="headerlink" href="#code-organization" title="Permanent link">&para;</a></h3>
<p><strong>File structure</strong>:
<div class="highlight"><pre><span></span><code>detectors/
 my_detector.go           # Detector implementation
 my_detector_test.go      # Unit tests
 my_detector_patterns.go  # Optional: complex pattern logic
</code></pre></div></p>
<p><strong>Detector file template</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">detectors</span>

<span class="c1">// 1. Imports</span>
<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;context&quot;</span>
<span class="w">    </span><span class="s">&quot;github.com/aquasecurity/tracee/api/v1beta1&quot;</span>
<span class="w">    </span><span class="s">&quot;github.com/aquasecurity/tracee/api/v1beta1/detection&quot;</span>
<span class="p">)</span>

<span class="c1">// 2. Auto-registration</span>
<span class="kd">func</span><span class="w"> </span><span class="nx">init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">register</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">MyDetector</span><span class="p">{})</span>
<span class="p">}</span>

<span class="c1">// 3. Detector struct</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">MyDetector</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">logger</span><span class="w">     </span><span class="nx">detection</span><span class="p">.</span><span class="nx">Logger</span>
<span class="w">    </span><span class="nx">dataStores</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">Registry</span>
<span class="w">    </span><span class="c1">// ... other state</span>
<span class="p">}</span>

<span class="c1">// 4. GetDefinition</span>
<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">GetDefinition</span><span class="p">()</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorDefinition</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// 5. Init</span>
<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">Init</span><span class="p">(</span><span class="nx">params</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorParams</span><span class="p">)</span><span class="w"> </span><span class="kt">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// 6. OnEvent</span>
<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">OnEvent</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">Context</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="w"> </span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Event</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// 7. Private helper methods</span>
<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">helperMethod</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="data-access-helpers">Data Access Helpers<a class="headerlink" href="#data-access-helpers" title="Permanent link">&para;</a></h2>
<h3 id="type-safe-event-data-extraction">Type-Safe Event Data Extraction<a class="headerlink" href="#type-safe-event-data-extraction" title="Permanent link">&para;</a></h3>
<p>Use generic <code>GetData[T]</code> for compile-time type safety:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// String extraction</span>
<span class="nx">pathname</span><span class="p">,</span><span class="w"> </span><span class="nx">found</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">GetData</span><span class="p">[</span><span class="kt">string</span><span class="p">](</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pathname&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">found</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>

<span class="c1">// Integer extraction</span>
<span class="nx">flags</span><span class="p">,</span><span class="w"> </span><span class="nx">found</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">GetData</span><span class="p">[</span><span class="kt">int64</span><span class="p">](</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;flags&quot;</span><span class="p">)</span>

<span class="c1">// Unsigned integer</span>
<span class="nx">uid</span><span class="p">,</span><span class="w"> </span><span class="nx">found</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">GetData</span><span class="p">[</span><span class="kt">uint64</span><span class="p">](</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uid&quot;</span><span class="p">)</span>

<span class="c1">// Boolean</span>
<span class="nx">success</span><span class="p">,</span><span class="w"> </span><span class="nx">found</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">GetData</span><span class="p">[</span><span class="kt">bool</span><span class="p">](</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;success&quot;</span><span class="p">)</span>

<span class="c1">// Byte array</span>
<span class="nx">data</span><span class="p">,</span><span class="w"> </span><span class="nx">found</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">GetData</span><span class="p">[[]</span><span class="kt">byte</span><span class="p">](</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;data&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="null-safe-accessors">Null-Safe Accessors<a class="headerlink" href="#null-safe-accessors" title="Permanent link">&para;</a></h3>
<p>Use protobuf's generated <code>Get*()</code> methods - they're nil-safe:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Safe - returns empty string if any field is nil</span>
<span class="nx">processPath</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">GetWorkload</span><span class="p">().</span><span class="nx">GetProcess</span><span class="p">().</span><span class="nx">GetExecutable</span><span class="p">().</span><span class="nx">GetPath</span><span class="p">()</span>

<span class="c1">// Safe - returns 0 if nil</span>
<span class="nx">entityId</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">GetWorkload</span><span class="p">().</span><span class="nx">GetProcess</span><span class="p">().</span><span class="nx">GetEntityId</span><span class="p">()</span>

<span class="c1">// Safe - returns empty slice if nil</span>
<span class="nx">ancestors</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">GetWorkload</span><span class="p">().</span><span class="nx">GetProcess</span><span class="p">().</span><span class="nx">GetAncestors</span><span class="p">()</span>
</code></pre></div>
<p><strong>Never do this</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// UNSAFE - panics if any field is nil!</span>
<span class="k">if</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">Workload</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">Workload</span><span class="p">.</span><span class="nx">Process</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">path</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">Workload</span><span class="p">.</span><span class="nx">Process</span><span class="p">.</span><span class="nx">Executable</span><span class="p">.</span><span class="nx">Path</span><span class="w">  </span><span class="c1">// Can still panic!</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="common-access-patterns">Common Access Patterns<a class="headerlink" href="#common-access-patterns" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">// Process information</span>
<span class="nx">entityId</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">GetWorkload</span><span class="p">().</span><span class="nx">GetProcess</span><span class="p">().</span><span class="nx">GetEntityId</span><span class="p">()</span>
<span class="nx">pid</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">GetWorkload</span><span class="p">().</span><span class="nx">GetProcess</span><span class="p">().</span><span class="nx">GetPid</span><span class="p">()</span>
<span class="nx">executable</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">GetWorkload</span><span class="p">().</span><span class="nx">GetProcess</span><span class="p">().</span><span class="nx">GetExecutable</span><span class="p">().</span><span class="nx">GetPath</span><span class="p">()</span>
<span class="nx">commandLine</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">GetWorkload</span><span class="p">().</span><span class="nx">GetProcess</span><span class="p">().</span><span class="nx">GetCommandLine</span><span class="p">()</span>

<span class="c1">// Container information (if in container)</span>
<span class="nx">containerId</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">GetWorkload</span><span class="p">().</span><span class="nx">GetContainer</span><span class="p">().</span><span class="nx">GetId</span><span class="p">()</span>
<span class="nx">containerName</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">GetWorkload</span><span class="p">().</span><span class="nx">GetContainer</span><span class="p">().</span><span class="nx">GetName</span><span class="p">()</span>
<span class="nx">containerImage</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">GetWorkload</span><span class="p">().</span><span class="nx">GetContainer</span><span class="p">().</span><span class="nx">GetImage</span><span class="p">().</span><span class="nx">GetName</span><span class="p">()</span>

<span class="c1">// Kubernetes information (if available)</span>
<span class="nx">namespace</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">GetWorkload</span><span class="p">().</span><span class="nx">GetK8s</span><span class="p">().</span><span class="nx">GetNamespace</span><span class="p">()</span>
<span class="nx">podName</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">GetWorkload</span><span class="p">().</span><span class="nx">GetK8s</span><span class="p">().</span><span class="nx">GetPod</span><span class="p">().</span><span class="nx">GetName</span><span class="p">()</span>

<span class="c1">// User information</span>
<span class="nx">uid</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">GetWorkload</span><span class="p">().</span><span class="nx">GetProcess</span><span class="p">().</span><span class="nx">GetRealUser</span><span class="p">().</span><span class="nx">GetId</span><span class="p">()</span>
<span class="nx">username</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">GetWorkload</span><span class="p">().</span><span class="nx">GetProcess</span><span class="p">().</span><span class="nx">GetRealUser</span><span class="p">().</span><span class="nx">GetName</span><span class="p">()</span>
</code></pre></div>
<hr />
<h3 id="next-steps">Next Steps<a class="headerlink" href="#next-steps" title="Permanent link">&para;</a></h3>
<ul>
<li><strong><a href="../quickstart/">Quick Start</a></strong>: Write your first detector</li>
<li><strong><a href="../datastore-api/">DataStore API</a></strong>: Complete datastore reference</li>
<li><strong>Real Examples</strong>: Browse <code>detectors/</code> directory</li>
</ul>
<h3 id="getting-help">Getting Help<a class="headerlink" href="#getting-help" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>GitHub Issues</strong>: https://github.com/aquasecurity/tracee/issues</li>
<li><strong>Discussions</strong>: https://github.com/aquasecurity/tracee/discussions</li>
<li><strong>API Definitions</strong>: <code>api/v1beta1/detection/detector.go</code></li>
</ul>
<hr />
<h2 id="migration-from-signatures">Migration from Signatures<a class="headerlink" href="#migration-from-signatures" title="Permanent link">&para;</a></h2>
<p>This section helps you migrate existing signatures to the new detector API.</p>
<h3 id="quick-comparison">Quick Comparison<a class="headerlink" href="#quick-comparison" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Old Signature API</th>
<th>New Detector API</th>
</tr>
</thead>
<tbody>
<tr>
<td>Package</td>
<td><code>package main</code> (plugin)</td>
<td><code>package detectors</code> (compiled-in)</td>
</tr>
<tr>
<td>Interface</td>
<td><code>detect.Signature</code></td>
<td><code>detection.EventDetector</code></td>
</tr>
<tr>
<td>Event Access</td>
<td><code>protocol.Event</code> (runtime casting)</td>
<td><code>*v1beta1.Event</code> (direct protobuf)</td>
</tr>
<tr>
<td>Data Extraction</td>
<td>Manual loop through <code>Args</code></td>
<td><code>GetData[T]</code> (type-safe)</td>
</tr>
<tr>
<td>Event Filtering</td>
<td><code>GetSelectedEvents()</code> (name only)</td>
<td><code>EventRequirement</code> (data + scope filters)</td>
</tr>
<tr>
<td>Output</td>
<td>Async <code>ctx.Callback()</code></td>
<td>Synchronous return <code>[]detection.DetectorOutput</code></td>
</tr>
<tr>
<td>Metadata</td>
<td><code>GetMetadata()</code> separate</td>
<td><code>GetDefinition()</code> unified</td>
</tr>
<tr>
<td>State Management</td>
<td>Manual</td>
<td>LRU caches + datastore access</td>
</tr>
<tr>
<td>Context Access</td>
<td>Limited</td>
<td>Full datastore access (process, container, etc.)</td>
</tr>
<tr>
<td>Auto-enrichment</td>
<td>Manual</td>
<td>Declarative (<code>AutoPopulateFields</code>)</td>
</tr>
<tr>
<td>Testing</td>
<td>Callback mocking</td>
<td>Direct function calls</td>
</tr>
<tr>
<td>Registration</td>
<td><code>ExportedSignatures</code> list</td>
<td><code>init()</code> auto-registration</td>
</tr>
</tbody>
</table>
<h3 id="step-by-step-migration">Step-by-Step Migration<a class="headerlink" href="#step-by-step-migration" title="Permanent link">&para;</a></h3>
<p><strong>Before</strong> (old signature):</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;github.com/aquasecurity/tracee/types/detect&quot;</span>
<span class="w">    </span><span class="s">&quot;github.com/aquasecurity/tracee/types/protocol&quot;</span>
<span class="p">)</span>

<span class="kd">type</span><span class="w"> </span><span class="nx">MySignature</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">cb</span><span class="w"> </span><span class="nx">detect</span><span class="p">.</span><span class="nx">SignatureHandler</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="w"> </span><span class="o">*</span><span class="nx">MySignature</span><span class="p">)</span><span class="w"> </span><span class="nx">GetMetadata</span><span class="p">()</span><span class="w"> </span><span class="nx">detect</span><span class="p">.</span><span class="nx">SignatureMetadata</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">detect</span><span class="p">.</span><span class="nx">SignatureMetadata</span><span class="p">{</span>
<span class="w">        </span><span class="nx">ID</span><span class="p">:</span><span class="w">          </span><span class="s">&quot;TRC-001&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">Name</span><span class="p">:</span><span class="w">        </span><span class="s">&quot;Sensitive File Access&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">Description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Detects access to sensitive files&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">Version</span><span class="p">:</span><span class="w">     </span><span class="s">&quot;1.0.0&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">Severity</span><span class="p">:</span><span class="w">    </span><span class="nx">detect</span><span class="p">.</span><span class="nx">SeverityMedium</span><span class="p">,</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="w"> </span><span class="o">*</span><span class="nx">MySignature</span><span class="p">)</span><span class="w"> </span><span class="nx">GetSelectedEvents</span><span class="p">()</span><span class="w"> </span><span class="p">[]</span><span class="nx">detect</span><span class="p">.</span><span class="nx">SignatureEventSelector</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[]</span><span class="nx">detect</span><span class="p">.</span><span class="nx">SignatureEventSelector</span><span class="p">{</span>
<span class="w">        </span><span class="p">{</span><span class="nx">Source</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tracee&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;security_file_open&quot;</span><span class="p">},</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="w"> </span><span class="o">*</span><span class="nx">MySignature</span><span class="p">)</span><span class="w"> </span><span class="nx">Init</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">detect</span><span class="p">.</span><span class="nx">SignatureContext</span><span class="p">)</span><span class="w"> </span><span class="kt">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">s</span><span class="p">.</span><span class="nx">cb</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">ctx</span><span class="p">.</span><span class="nx">Callback</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="w"> </span><span class="o">*</span><span class="nx">MySignature</span><span class="p">)</span><span class="w"> </span><span class="nx">OnEvent</span><span class="p">(</span><span class="nx">event</span><span class="w"> </span><span class="nx">protocol</span><span class="p">.</span><span class="nx">Event</span><span class="p">)</span><span class="w"> </span><span class="kt">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">traceEvent</span><span class="p">,</span><span class="w"> </span><span class="nx">ok</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">Payload</span><span class="p">.(</span><span class="nx">trace</span><span class="p">.</span><span class="nx">Event</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">ok</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;unexpected event type&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">pathname</span><span class="w"> </span><span class="kt">string</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">arg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">traceEvent</span><span class="p">.</span><span class="nx">Args</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">arg</span><span class="p">.</span><span class="nx">Name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;pathname&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">pathname</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">arg</span><span class="p">.</span><span class="nx">Value</span><span class="p">.(</span><span class="kt">string</span><span class="p">)</span>
<span class="w">            </span><span class="k">break</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">strings</span><span class="p">.</span><span class="nx">HasPrefix</span><span class="p">(</span><span class="nx">pathname</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/etc/&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">s</span><span class="p">.</span><span class="nx">cb</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">detect</span><span class="p">.</span><span class="nx">Finding</span><span class="p">{</span>
<span class="w">        </span><span class="nx">SigMetadata</span><span class="p">:</span><span class="w"> </span><span class="nx">s</span><span class="p">.</span><span class="nx">GetMetadata</span><span class="p">(),</span>
<span class="w">        </span><span class="nx">Event</span><span class="p">:</span><span class="w">       </span><span class="nx">event</span><span class="p">,</span>
<span class="w">        </span><span class="nx">Data</span><span class="p">:</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{}{</span>
<span class="w">            </span><span class="s">&quot;file&quot;</span><span class="p">:</span><span class="w"> </span><span class="nx">pathname</span><span class="p">,</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">    </span><span class="p">})</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="w"> </span><span class="o">*</span><span class="nx">MySignature</span><span class="p">)</span><span class="w"> </span><span class="nx">Close</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span>
</code></pre></div>
<p><strong>After</strong> (new detector):</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">detectors</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;context&quot;</span>
<span class="w">    </span><span class="s">&quot;strings&quot;</span>

<span class="w">    </span><span class="s">&quot;github.com/aquasecurity/tracee/api/v1beta1&quot;</span>
<span class="w">    </span><span class="s">&quot;github.com/aquasecurity/tracee/api/v1beta1/detection&quot;</span>
<span class="p">)</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">register</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">SensitiveFileAccess</span><span class="p">{})</span>
<span class="p">}</span>

<span class="kd">type</span><span class="w"> </span><span class="nx">SensitiveFileAccess</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">logger</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">Logger</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">SensitiveFileAccess</span><span class="p">)</span><span class="w"> </span><span class="nx">GetDefinition</span><span class="p">()</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorDefinition</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorDefinition</span><span class="p">{</span>
<span class="w">        </span><span class="nx">ID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TRC-001&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">Requirements</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorRequirements</span><span class="p">{</span>
<span class="w">            </span><span class="nx">Events</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">EventRequirement</span><span class="p">{</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;security_file_open&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">DataFilters</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="s">&quot;pathname=/etc/*&quot;</span><span class="p">},</span><span class="w">  </span><span class="c1">// Engine filters</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">ProducedEvent</span><span class="p">:</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">EventDefinition</span><span class="p">{</span>
<span class="w">            </span><span class="nx">Name</span><span class="p">:</span><span class="w">        </span><span class="s">&quot;sensitive_file_access&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nx">Description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Detects access to sensitive files&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nx">Version</span><span class="p">:</span><span class="w">     </span><span class="o">&amp;</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Version</span><span class="p">{</span><span class="nx">Major</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">Minor</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nx">Patch</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span>
<span class="w">            </span><span class="nx">Fields</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">EventField</span><span class="p">{</span>
<span class="w">                </span><span class="p">{</span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;const char*&quot;</span><span class="p">},</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">ThreatMetadata</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Threat</span><span class="p">{</span>
<span class="w">            </span><span class="nx">Name</span><span class="p">:</span><span class="w">        </span><span class="s">&quot;Sensitive File Access&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nx">Description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Access to sensitive system files detected&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nx">Severity</span><span class="p">:</span><span class="w">    </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Severity_MEDIUM</span><span class="p">,</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">AutoPopulate</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">AutoPopulateFields</span><span class="p">{</span>
<span class="w">            </span><span class="nx">Threat</span><span class="p">:</span><span class="w">          </span><span class="kc">true</span><span class="p">,</span>
<span class="w">            </span><span class="nx">DetectedFrom</span><span class="p">:</span><span class="w">    </span><span class="kc">true</span><span class="p">,</span>
<span class="w">            </span><span class="nx">ProcessAncestry</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">SensitiveFileAccess</span><span class="p">)</span><span class="w"> </span><span class="nx">Init</span><span class="p">(</span><span class="nx">params</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorParams</span><span class="p">)</span><span class="w"> </span><span class="kt">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">logger</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">params</span><span class="p">.</span><span class="nx">Logger</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">SensitiveFileAccess</span><span class="p">)</span><span class="w"> </span><span class="nx">OnEvent</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">Context</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="w"> </span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">Event</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Type-safe extraction (no casting)</span>
<span class="w">    </span><span class="nx">pathname</span><span class="p">,</span><span class="w"> </span><span class="nx">found</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">GetData</span><span class="p">[</span><span class="kt">string</span><span class="p">](</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pathname&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">found</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// No need to filter by /etc/* - engine already did it</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">{{</span>
<span class="w">        </span><span class="nx">Data</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">EventValue</span><span class="p">{</span>
<span class="w">            </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewStringValue</span><span class="p">(</span><span class="s">&quot;file&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">pathname</span><span class="p">),</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="c1">// Threat, DetectedFrom, ProcessAncestry auto-populated by engine</span>
<span class="w">    </span><span class="p">}},</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>

<span class="c1">// Close() is optional - only implement if you need cleanup</span>
</code></pre></div>
<h3 id="migration-checklist">Migration Checklist<a class="headerlink" href="#migration-checklist" title="Permanent link">&para;</a></h3>
<ul>
<li>[ ] Change package from <code>main</code> to <code>detectors</code></li>
<li>[ ] Add <code>init() { register(&amp;YourDetector{}) }</code></li>
<li>[ ] Update imports to <code>api/v1beta1</code> packages</li>
<li>[ ] Replace <code>detect.Signature</code> with <code>detection.EventDetector</code></li>
<li>[ ] Combine <code>GetMetadata()</code> + <code>GetSelectedEvents()</code>  <code>GetDefinition()</code></li>
<li>[ ] Move data filters from <code>OnEvent()</code> to <code>EventRequirement.DataFilters</code></li>
<li>[ ] Replace <code>protocol.Event</code> casting with <code>*v1beta1.Event</code> parameter</li>
<li>[ ] Replace manual <code>Args</code> loop with <code>GetData[T]()</code></li>
<li>[ ] Replace <code>ctx.Callback()</code> with synchronous <code>return []detection.DetectorOutput{}</code></li>
<li>[ ] Return <code>DetectorOutput</code> with <code>Data</code> fields instead of full <code>v1beta1.Event</code></li>
<li>[ ] Add <code>AutoPopulateFields</code> for automatic enrichment</li>
<li>[ ] Update tests to call <code>OnEvent()</code> directly and verify <code>DetectorOutput</code></li>
<li>[ ] Remove <code>Close()</code> if empty (optional interface)</li>
</ul>
<h3 id="common-pattern-translations">Common Pattern Translations<a class="headerlink" href="#common-pattern-translations" title="Permanent link">&para;</a></h3>
<p><strong>Pattern: Event Selection</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Before</span>
<span class="nx">GetSelectedEvents</span><span class="p">()</span><span class="w"> </span><span class="p">[]</span><span class="nx">detect</span><span class="p">.</span><span class="nx">SignatureEventSelector</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[]</span><span class="nx">detect</span><span class="p">.</span><span class="nx">SignatureEventSelector</span><span class="p">{</span>
<span class="w">        </span><span class="p">{</span><span class="nx">Source</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tracee&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;openat&quot;</span><span class="p">},</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// After</span>
<span class="nx">Requirements</span><span class="p">:</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorRequirements</span><span class="p">{</span>
<span class="w">    </span><span class="nx">Events</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">EventRequirement</span><span class="p">{</span>
<span class="w">        </span><span class="p">{</span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;openat&quot;</span><span class="p">},</span>
<span class="w">    </span><span class="p">},</span>
<span class="p">},</span>
</code></pre></div>
<p><strong>Pattern: Data Extraction</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Before</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">pathname</span><span class="w"> </span><span class="kt">string</span>
<span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">arg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">traceEvent</span><span class="p">.</span><span class="nx">Args</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">arg</span><span class="p">.</span><span class="nx">Name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;pathname&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">pathname</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">arg</span><span class="p">.</span><span class="nx">Value</span><span class="p">.(</span><span class="kt">string</span><span class="p">)</span><span class="w">  </span><span class="c1">// Runtime casting</span>
<span class="w">        </span><span class="k">break</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// After</span>
<span class="nx">pathname</span><span class="p">,</span><span class="w"> </span><span class="nx">found</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">GetData</span><span class="p">[</span><span class="kt">string</span><span class="p">](</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pathname&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1">// Compile-time safety</span>
<span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">found</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Pattern: Filtering</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Before (in OnEvent)</span>
<span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">strings</span><span class="p">.</span><span class="nx">HasPrefix</span><span class="p">(</span><span class="nx">pathname</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/etc/&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="w">  </span><span class="c1">// Manual filter</span>
<span class="p">}</span>

<span class="c1">// After (in EventRequirement)</span>
<span class="nx">DataFilters</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="s">&quot;pathname=/etc/*&quot;</span><span class="p">},</span><span class="w">  </span><span class="c1">// Engine filters before dispatch</span>
</code></pre></div>
<p><strong>Pattern: Callback  Return</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Before</span>
<span class="nx">s</span><span class="p">.</span><span class="nx">cb</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">detect</span><span class="p">.</span><span class="nx">Finding</span><span class="p">{</span>
<span class="w">    </span><span class="nx">SigMetadata</span><span class="p">:</span><span class="w"> </span><span class="nx">s</span><span class="p">.</span><span class="nx">GetMetadata</span><span class="p">(),</span>
<span class="w">    </span><span class="nx">Event</span><span class="p">:</span><span class="w">       </span><span class="nx">event</span><span class="p">,</span>
<span class="w">    </span><span class="nx">Data</span><span class="p">:</span><span class="w">        </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{}{</span><span class="s">&quot;file&quot;</span><span class="p">:</span><span class="w"> </span><span class="nx">pathname</span><span class="p">},</span>
<span class="p">})</span>
<span class="k">return</span><span class="w"> </span><span class="kc">nil</span>

<span class="c1">// After</span>
<span class="k">return</span><span class="w"> </span><span class="p">[]</span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorOutput</span><span class="p">{{</span>
<span class="w">    </span><span class="nx">Data</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">EventValue</span><span class="p">{</span>
<span class="w">        </span><span class="nx">v1beta1</span><span class="p">.</span><span class="nx">NewStringValue</span><span class="p">(</span><span class="s">&quot;file&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">pathname</span><span class="p">),</span>
<span class="w">    </span><span class="p">},</span>
<span class="p">}},</span><span class="w"> </span><span class="kc">nil</span>
</code></pre></div>
<hr />
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">&para;</a></h2>
<h3 id="problem-detector-not-running">Problem: Detector Not Running<a class="headerlink" href="#problem-detector-not-running" title="Permanent link">&para;</a></h3>
<p><strong>Symptoms</strong>: Detector code exists but never triggers</p>
<p><strong>Diagnosis</strong>:
<div class="highlight"><pre><span></span><code><span class="c1"># Check if detector is registered</span>
sudo<span class="w"> </span>./dist/tracee<span class="w"> </span>list<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>detectors

<span class="c1"># Check Tracee logs</span>
sudo<span class="w"> </span>./dist/tracee<span class="w"> </span>--logging<span class="w"> </span>debug
</code></pre></div></p>
<p><strong>Solutions</strong>:
1. Verify <code>init() { register(&amp;YourDetector{}) }</code> exists
2. Rebuild Tracee: <code>make clean &amp;&amp; make tracee</code>
3. Check for panics in <code>Init()</code> (blocks registration)</p>
<h3 id="problem-no-events-received">Problem: No Events Received<a class="headerlink" href="#problem-no-events-received" title="Permanent link">&para;</a></h3>
<p><strong>Symptoms</strong>: <code>OnEvent()</code> never called</p>
<p><strong>Diagnosis</strong>:
1. Check event name: <code>sudo ./dist/tracee list | grep event_name</code>
2. Temporarily remove <code>DataFilters</code> to see if they're too restrictive
3. Add debug logging in <code>OnEvent()</code></p>
<p><strong>Solutions</strong>:
1. Fix event name typo in <code>EventRequirement.Name</code>
2. Adjust <code>DataFilters</code> - they might be filtering everything out
3. Check <code>ScopeFilters</code> - ensure they match your test environment</p>
<h3 id="problem-datastore-returns-errnotfound">Problem: DataStore Returns ErrNotFound<a class="headerlink" href="#problem-datastore-returns-errnotfound" title="Permanent link">&para;</a></h3>
<p><strong>Symptoms</strong>: <code>GetProcess()</code>, <code>GetContainer()</code> return <code>ErrNotFound</code></p>
<p><strong>Possible causes</strong>:
1. Process tree not enabled: <code>--stores process</code>
2. Process exited before query
3. Container not tracked yet</p>
<p><strong>Solutions</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Always handle ErrNotFound gracefully</span>
<span class="nx">proc</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dataStores</span><span class="p">.</span><span class="nx">Processes</span><span class="p">().</span><span class="nx">GetProcess</span><span class="p">(</span><span class="nx">entityId</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">datastores</span><span class="p">.</span><span class="nx">ErrNotFound</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// This is normal - process might have exited</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;unexpected error: %w&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="problem-high-cpu-usage">Problem: High CPU Usage<a class="headerlink" href="#problem-high-cpu-usage" title="Permanent link">&para;</a></h3>
<p><strong>Symptoms</strong>: Tracee consuming excessive CPU</p>
<p><strong>Diagnosis</strong>:
1. Check if detector receives too many events
2. Profile detector logic</p>
<p><strong>Solutions</strong>:
1. Add more restrictive <code>DataFilters</code>
2. Optimize detector logic - avoid expensive operations in <code>OnEvent()</code>
3. Use caching for repeated computations
4. Consider batching if doing aggregations</p>
<h3 id="problem-memory-leaks">Problem: Memory Leaks<a class="headerlink" href="#problem-memory-leaks" title="Permanent link">&para;</a></h3>
<p><strong>Symptoms</strong>: Memory usage grows over time</p>
<p><strong>Causes</strong>:
1. Unbounded maps/slices in detector state
2. Not cleaning up old entries</p>
<p><strong>Solutions</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Use LRU cache with TTL instead of unbounded maps</span>
<span class="kn">import</span><span class="w"> </span><span class="s">&quot;github.com/hashicorp/golang-lru/v2/expirable&quot;</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="nx">MyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">Init</span><span class="p">(</span><span class="nx">params</span><span class="w"> </span><span class="nx">detection</span><span class="p">.</span><span class="nx">DetectorParams</span><span class="p">)</span><span class="w"> </span><span class="kt">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Bounded cache with expiration</span>
<span class="w">    </span><span class="nx">d</span><span class="p">.</span><span class="nx">cache</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">expirable</span><span class="p">.</span><span class="nx">NewLRU</span><span class="p">[</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="nx">data</span><span class="p">](</span>
<span class="w">        </span><span class="mi">1000</span><span class="p">,</span><span class="w">          </span><span class="c1">// Max entries</span>
<span class="w">        </span><span class="kc">nil</span><span class="p">,</span><span class="w">           </span><span class="c1">// No eviction callback</span>
<span class="w">        </span><span class="mi">5</span><span class="o">*</span><span class="nx">time</span><span class="p">.</span><span class="nx">Minute</span><span class="p">,</span><span class="w"> </span><span class="c1">// TTL</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
</code></pre></div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "content.tabs.link", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.26099bd0.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"method": "mike", "provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.9d1edc04.min.js"></script>
      
    
  </body>
</html>