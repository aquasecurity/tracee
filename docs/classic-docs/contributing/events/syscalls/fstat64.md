
# fstat64

## Intro
fstat64 - retrieves information about a specific file

## Description
The fstat64() system call is used to retrieve information about a specific file, given a file descriptor. This information includes the file size, the time of last access, etc. The function copies the information into a structure of type stat64, which is then filled with the information about the file. The file descriptor is typically used to identify a previously opened file.

The fstat64() system call is most notably used when a file is opened, in order to obtain information about it. However, it can also be used to check the existence of the file and to check the permissions associated with it.

The fstat64() system call has some drawbacks. It can only operate on a previously opened file, so it is not applicable if no file descriptor is associated with the file. Furthermore, since it is a system call, it can be expensive in terms of performance, particularly when called on a regular basis.

## Arguments
* `fd`:`int`[K] - File Descriptor. The file on which the system call is to operate on. 
* `statbuf`:`struct stat64*`[U] - Pointer to a struct stat64, which contains the information retrieved by the system call. 

### Available Tags
* K - Originated from kernel-space.
* U - Originated from user space (for example, pointer to user space memory used to get it)

## Hooks
### do_fstat64
#### Type
KProbe
#### Purpose
Hooked function for the fstat64 system call, used to get information about a specific file given a file descriptor.

## Example Use Case
The fstat64 system call can be used in cases when some basic information about a file is needed, such as its size, access time, or other similar info. For example, it could be used to implement a basic basename command which prints the basename, or file name, of a given file. In this case, fstat64 would be used to get information about the file, and then the basename could be extracted from that information.

## Issues
None.

## Related Events
* open: opens or creates a file or directory
* stat: stat() is the generic system call for getting information about a file. It can use the same underlying system call as fstat64() but is not limited to files that are opened using a file descriptor.

> This document was automatically generated by OpenAI and needs review. It might
> not be accurate and might contain errors. The authors of Tracee recommend that
> the user reads the "events.go" source file to understand the events and their
> arguments better.
