
```yaml
# userfaultfd

## Intro 
userfaultfd - Used to handle page faults in user space.

## Description 
userfaultfd is a mechanism by which applications can handle page faults in user space. This syscall creates a file descriptor which can receive notification of page faults occurring in a designated memory region. The application can then handle page faults in its own context, allowing for a finer control over how to respond to page faults.

The flags parameter indicates what type of faults can be handled. By setting certain flags the application can choose only certain types of page faults that it is interested in.

## Arguments
* `flags`:`int`[U, OPT] - Indicates which page faults the application is interested in. Possible values include `O_NONBLOCK`, `O_CLOEXEC` and `UFFD_API_FEATURES_EVENT`.

### Available Tags
* K - Originated from kernel-space.
* U - Originated from user space (for example, pointer to user space memory used to get it)
* TOCTOU - Vulnerable to TOCTOU (time of check, time of use)
* OPT - Optional argument - might not always be available (passed with null value)

## Hooks
### kernel_userfaultfd
#### Type
Kprobe + Kretprobe
#### Purpose
To track all calls to the kernel_userfaultfd entry point.

## Example Use Case
A user space application that needs to be able to handle page faults occurring in a specific sections of its address space, such as when servicing page faults from a user space page cache.

## Issues
No known issues.

## Related Events
All related page fault events.

> This document was automatically generated by OpenAI and needs review. It might
> not be accurate and might contain errors. The authors of Tracee recommend that
> the user reads the "events.go" source file to understand the events and their
> arguments better.
