.\" Automatically generated by Pandoc 3.2
.\"
.TH "TRACEE\-DO\-SIGACTION" "1" "" "" "Tracee Event Manual"
.SS NAME
\f[B]do_sigaction\f[R] \- Event triggered when registering new signal
handler or getting information about current one
.SS DESCRIPTION
The \f[B]do_sigaction\f[R] event marks that an attempt to get current
task signal handler or to change the signal handler of the current task
for a specific signal occurred.
Signal handler changes mark the change of program behavior, and might
indicate an attempt to defy expected signal behavior.
.PP
This event is relevant for each syscall related to signal handling \-
\f[CR]rt_sigaction\f[R], \f[CR]sigaction\f[R] and \f[CR]signal\f[R].
.PP
In the kernel, the handle method and the handler are united to one
field.
To make it more accessible to the user, Tracee splits the two apart.
Normally, the value can be one of the following: \f[CR]SIG_DFL\f[R](0),
\f[CR]SIG_IGN\f[R](1) or pointer to user\-mode handler function.
To deal with the case of a user\-mode handler, the value
\f[CR]SIG_HND\f[R](2) is created to specify that the method is by
handler.
.SS EVENT SETS
\f[B]none\f[R]
.SS DATA FIELDS
.TP
\f[B]sig\f[R] (\f[I]int32\f[R])
The signal that its handler is inspected or changed
.TP
\f[B]is_sa_initialized\f[R] (\f[I]bool\f[R])
Is a new signal handler given.
If not, this event marks only inspection of data
.TP
\f[B]sa_flags\f[R] (\f[I]uint64\f[R])
The flags given for the new signal handler
.TP
\f[B]sa_mask\f[R] (\f[I]uint64\f[R])
The mask given for the new signal handler
.TP
\f[B]sa_handle_method\f[R] (\f[I]uint8\f[R])
The handling method of the new signal handler
.TP
\f[B]sa_handler\f[R] (\f[I]trace.Pointer\f[R])
The address of the new signal handling function if method is SIG_HND
.TP
\f[B]is_old_sa_initialized\f[R] (\f[I]bool\f[R])
Is an old signal handler given.
If given, the old signal handler will be copied back to the caller
.TP
\f[B]old_sa_flags\f[R] (\f[I]uint64\f[R])
The flags of the old signal handler
.TP
\f[B]old_sa_mask\f[R] (\f[I]uint64\f[R])
The mask of the old signal handler
.TP
\f[B]old_sa_handle_method\f[R] (\f[I]uint8\f[R])
The handling method of the old signal handler
.TP
\f[B]old_sa_handler\f[R] (\f[I]trace.Pointer\f[R])
The address of the old signal handling function if method was SIG_HND
.SS DEPENDENCIES
\f[B]Kernel Probe:\f[R]
.IP \[bu] 2
do_sigaction (required): Kernel probe on the function implementing the
signal handler inspection/modification for syscalls
.SS USE CASES
.IP \[bu] 2
\f[B]Malware Detection\f[R]: Monitor signal handler modifications that
could indicate process injection or evasion techniques
.IP \[bu] 2
\f[B]Security Analysis\f[R]: Track changes to signal handling behavior
that might bypass security controls
.IP \[bu] 2
\f[B]Debugging\f[R]: Monitor signal handler registration during
application debugging
.SS RELATED EVENTS
.IP \[bu] 2
\f[B]rt_sigaction\f[R]: Real\-time signal action system call
.IP \[bu] 2
\f[B]sigaction\f[R]: Signal action system call
.IP \[bu] 2
\f[B]signal\f[R]: Signal system call
