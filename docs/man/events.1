.\" Automatically generated by Pandoc 3.1.2
.\"
.\" Define V font for inline verbatim, using C font in formats
.\" that render this, and otherwise B font.
.ie "\f[CB]x\f[]"x" \{\
. ftr V B
. ftr VI BI
. ftr VB B
. ftr VBI BI
.\}
.el \{\
. ftr V CR
. ftr VI CI
. ftr VB CB
. ftr VBI CBI
.\}
.TH "TRACEE-EVENTS" "1" "2023/10" "" "Tracee Events Flag Manual"
.hy
.SS NAME
.PP
tracee \f[B]--events\f[R] - Select which events to trace
.SS SYNOPSIS
.PP
tracee \f[B]--events\f[R] [<event-name1(,[-]event-name2\&...)> |
<[-]event-name1(,set1\&...)> |
<set1(,[-]event-name1,[-]event-name2\&...)> |
<event1.args.arg-field[=|!=]value> |
<event1.retval[=|!=|<|>|<=|>=]value> |
<event1.context.context-field[=|!=|<|>|<=|>=]value> |
<event.context.container>] \&...
.SS DESCRIPTION
.PP
The \f[B]--events\f[R] flag allows you to select which events to trace
by defining filters.
.SS FILTERS
.IP \[bu] 2
Event or set name: Select specific events using
`event-name1,event-name2\&...' or predefined event sets using
`event_set_name1,event_set_name2\&...'.
To exclude events, prepend the event name with a dash `-':
`-event-name'.
.IP \[bu] 2
Event arguments: Filter events based on their arguments using
`event-name.args.event_arg'.
The event argument expression follows the syntax of a string expression.
.IP \[bu] 2
Event return value: Filter events based on their return value using
`event-name.retval'.
The event return value expression follows the syntax of a numerical
expression.
.IP \[bu] 2
Event context fields: Filter events based on the non-argument fields
defined in the trace.Event struct using `event-name.context.field'.
Refer to the json tags in the trace.Event struct located in the
types/trace package for the correct field names, and the event filtering
section in the documentation for a full list.
.SS FILTER EXPRESSION
.PP
Filter expressions can be defined to operate on event options or process
metadata.
Only events that match all filter expressions will be traced.
.PP
Multiple flags are combined with AND logic, while multiple values within
a single flag are combined with OR logic when using the equals operator
`='.
Multiple values can be specified using `,'.
.SS NUMERICAL EXPRESSION OPERATORS
.PP
`=', `!=', `<', `>', `<=', `>='
.PP
Available for:
.IP \[bu] 2
return value
.IP \[bu] 2
context fields
.PP
NOTE: Expressions containing `<' or `>' tokens must be escaped!
.SS STRING EXPRESSION OPERATORS
.PP
`=', `!='
.PP
Available for:
.IP \[bu] 2
event arguments
.IP \[bu] 2
return value
.IP \[bu] 2
context fields
.PP
Strings can be compared as a prefix if ending with `*', or as a suffix
if starting with `*'.
.PP
NOTE: Expressions containing `*' token must be escaped!
.SS EXCLUSION OPERATOR (PREPENDED)
.PP
`-'
.PP
Available only for:
.IP \[bu] 2
event names
.SS EXAMPLES
.IP \[bu] 2
To trace only `execve' and `open' events, use the following flag:
.RS 2
.IP
.nf
\f[C]
--events execve,open
\f[R]
.fi
.RE
.IP \[bu] 2
To trace only events prefixed by \[lq]open\[rq], use the following flag:
.RS 2
.IP
.nf
\f[C]
--events \[aq]open*\[aq]
\f[R]
.fi
.RE
.IP \[bu] 2
To exclude events prefixed by \[lq]open\[rq] or \[lq]dup\[rq], use the
following flag:
.RS 2
.IP
.nf
\f[C]
--events \[aq]-open*,-dup*\[aq]
\f[R]
.fi
.RE
.IP \[bu] 2
To trace all file-system related events, use the following flag:
.RS 2
.IP
.nf
\f[C]
--events fs
\f[R]
.fi
.RE
.IP \[bu] 2
To trace all file-system related events, but not `open' or `openat', use
the following flag:
.RS 2
.IP
.nf
\f[C]
--events fs --events \[aq]-open,-openat\[aq]
\f[R]
.fi
.RE
.IP \[bu] 2
To trace only `close' events that have `fd' equal to 5, use the
following flag:
.RS 2
.IP
.nf
\f[C]
--events close.args.fd=5
\f[R]
.fi
.RE
.IP \[bu] 2
To trace only `openat' events that have `pathname' prefixed by `/tmp',
use the following flag:
.RS 2
.IP
.nf
\f[C]
--events openat.args.pathname=\[aq]/tmp*\[aq]
\f[R]
.fi
.RE
.IP \[bu] 2
To trace only `openat' events that have `pathname' suffixed by `shadow',
use the following flag:
.RS 2
.IP
.nf
\f[C]
--events openat.args.pathname=\[aq]*shadow\[aq]
\f[R]
.fi
.RE
.IP \[bu] 2
To exclude `openat' events that have `pathname' equal to `/tmp/1' or
`/bin/ls', use the following flag:
.RS 2
.IP
.nf
\f[C]
--events openat.args.pathname!=/tmp/1,/bin/ls
\f[R]
.fi
.RE
.IP \[bu] 2
To trace only `openat' events that have `processName' equal to `ls', use
the following flag:
.RS 2
.IP
.nf
\f[C]
--events openat.context.processName=ls
\f[R]
.fi
.RE
.IP \[bu] 2
To trace only `security_file_open' events coming from a container, use
the following flag:
.RS 2
.IP
.nf
\f[C]
--events security_file_open.context.container
\f[R]
.fi
.RE
