.\" Automatically generated by Pandoc 3.2
.\"
.TH "" "" "" "" ""
.PP
\[en] title: TRACEE\-EVENTS section: 1 header: Tracee Events Flag Manual
date: 2024/12 \&...
.SS NAME
tracee \f[B]\-\-events\f[R] \- Select which events to trace
.SS SYNOPSIS
tracee \f[B]\-\-events\f[R] [<event\-name1(,[\-]event\-name2\&...)> |
<tag=tag1(,tag2\&...)> | <event1.data.data\-field[=|!=]value> |
<event1.retval[=|!=|<|>|<=|>=]value> |
<event1.scope.field[=|!=|<|>|<=|>=]value> | <event.scope.container>]
\&...
.SS DESCRIPTION
The \f[B]\-\-events\f[R] flag allows you to select which events to trace
by defining filters.
.SS FILTERS
.IP \[bu] 2
Event name: Select specific events using
`event\-name1,event\-name2\&...'.
To exclude events, prepend the event name with a dash `\-':
`\-event\-name'.
.IP \[bu] 2
Tag selection: Select events by tag (set) using `tag=tag1,tag2\&...'.
Multiple tags are combined with OR logic.
Common tags include: syscalls, fs, network, proc, default.
.IP \[bu] 2
Detector selection by threat properties: Select detectors based on their
threat metadata using `threat.property=value'.
See THREAT\-BASED DETECTOR SELECTION section below.
.IP \[bu] 2
Event data: Filter events based on their data using
`event\-name.data.event_data'.
The event data expression follows the syntax of a string expression.
.IP \[bu] 2
Event return value: Filter events based on their return value using
`event\-name.retval'.
The event return value expression follows the syntax of a numerical
expression.
.IP \[bu] 2
Event scope fields: Filter events based on the non\-argument fields
defined in the trace.Event struct using `event\-name.scope.field'.
Refer to the json tags in the trace.Event struct located in the
types/trace package for the correct field names, and the event filtering
section in the documentation for a full list.
.SS FILTER EXPRESSION
Filter expressions can be defined to operate on event options or process
metadata.
Only events that match all filter expressions will be traced.
.PP
Multiple flags are combined with AND logic, while multiple values within
a single flag are combined with OR logic when using the equals operator
`='.
Multiple values can be specified using `,'.
.SS NUMERICAL EXPRESSION OPERATORS
`=', `!=', `<', `>', `<=', `>='
.PP
Available for:
.IP \[bu] 2
return value
.IP \[bu] 2
scope fields
.PP
NOTE: Expressions containing `<' or `>' tokens must be escaped!
.SS STRING EXPRESSION OPERATORS
`=', `!='
.PP
Available for:
.IP \[bu] 2
event arguments
.IP \[bu] 2
return value
.IP \[bu] 2
scope fields
.PP
Strings can be compared as a prefix if ending with `*', or as a suffix
if starting with `*'.
If a string starts with `*' and ends with `*', it functions as a
contains operator.
.PP
For certain event fields filtered in kernel space, the user will receive
a warning if:
.IP \[bu] 2
String filters exceed 255 characters.
.IP \[bu] 2
The contains operator is used.
Only exact matches, prefix, and suffix comparisons are allowed.
.PP
NOTE: Expressions containing `*' token must be escaped!
.SS EXCLUSION OPERATOR (PREPENDED)
`\-'
.PP
Available only for:
.IP \[bu] 2
event names
.SS THREAT\-BASED DETECTOR SELECTION
Detectors can be selected based on their threat metadata properties.
This allows you to enable all detectors that match specific security
criteria without knowing their individual event names.
.SS THREAT PROPERTIES
\f[B]threat.severity\f[R] \- Severity level (info, low, medium, high,
critical or 0\-4).
Supports: =, !=, <, >, <=, >=
.IP
.EX
\-\-events threat.severity=critical                # Only critical threats
\-\-events \[aq]threat.severity>=high\[aq]                 # High and critical threats
.EE
.PP
\f[B]threat.mitre.technique\f[R] \- MITRE ATT&CK technique ID (e.g.,
T1055).
Supports: =, !=
.IP
.EX
\-\-events threat.mitre.technique=T1055
.EE
.PP
\f[B]threat.mitre.tactic\f[R] \- MITRE ATT&CK tactic name (e.g.,
\[lq]Defense Evasion\[rq]).
Supports: =, !=
.IP
.EX
\-\-events \[aq]threat.mitre.tactic=\[dq]Defense Evasion\[dq]\[aq]
.EE
.PP
\f[B]threat.name\f[R] \- Threat name/identifier.
Supports: =, !=
.IP
.EX
\-\-events threat.name=process_injection
.EE
.PP
Threat selection can be combined with regular events.
Multiple \f[CR]\-\-events\f[R] flags are combined additively (OR logic):
.IP
.EX
\-\-events threat.severity=critical \-\-events write    # Critical threats OR write events
\-\-events tag=fs \-\-events \[aq]threat.severity>=high\[aq]    # Filesystem events OR high+ threats
.EE
.PP
\f[B]Note:\f[R] Detector selection based on threat properties is
performed once at startup.
Matching detectors are enabled; non\-matching detectors are never
loaded.
.SS TAG SELECTION
Events are categorized with tags (also known as sets).
You can select all events with a specific tag:
.IP
.EX
\-\-events tag=containers       # All events tagged with \[dq]containers\[dq]
\-\-events tag=fs               # All filesystem\-related events
\-\-events tag=detectors        # All detector events
.EE
.PP
Tags can be combined with other selection methods:
.IP
.EX
\-\-events tag=containers,execve            # Events with \[dq]containers\[dq] tag + execve syscall
\-\-events tag=fs,network                   # Filesystem OR network events
\-\-events tag=fs \-\-events \-open,\-openat    # Filesystem events except open(at)
.EE
.SS EXAMPLES
.IP \[bu] 2
To trace only `execve' and `open' events, use the following flag:
.RS 2
.IP
.EX
\-\-events execve,open
.EE
.RE
.IP \[bu] 2
To trace only events prefixed by \[lq]open\[rq], use the following flag:
.RS 2
.IP
.EX
\-\-events \[aq]open*\[aq]
.EE
.RE
.IP \[bu] 2
To trace all file\-system related events, use the following flag:
.RS 2
.IP
.EX
\-\-events tag=fs
.EE
.RE
.IP \[bu] 2
To trace all file\-system related events, but not `open' or `openat',
use the following flag:
.RS 2
.IP
.EX
\-\-events tag=fs \-\-events \[aq]\-open,\-openat\[aq]
.EE
.RE
.IP \[bu] 2
To trace only `close' events that have `fd' equal to 5, use the
following flag:
.RS 2
.IP
.EX
\-\-events close.data.fd=5
.EE
.RE
.IP \[bu] 2
To trace only `openat' events that have `pathname' prefixed by `/tmp',
use the following flag:
.RS 2
.IP
.EX
\-\-events openat.data.pathname=\[aq]/tmp*\[aq]
.EE
.RE
.IP \[bu] 2
To trace only `openat' events that have `pathname' suffixed by `shadow',
use the following flag:
.RS 2
.IP
.EX
\-\-events openat.data.pathname=\[aq]*shadow\[aq]
.EE
.RE
.IP \[bu] 2
To trace only `openat' events that have `pathname' contains the
substring `pass', use the following flag:
.RS 2
.IP
.EX
\-\-events openat.data.pathname=\[aq]*pass*\[aq]
.EE
.RE
.IP \[bu] 2
To exclude `openat' events that have `pathname' equal to `/tmp/1' or
`/bin/ls', use the following flag:
.RS 2
.IP
.EX
\-\-events openat.data.pathname!=/tmp/1,/bin/ls
.EE
.RE
.IP \[bu] 2
To trace only `openat' events that have `processName' equal to `ls', use
the following flag:
.RS 2
.IP
.EX
\-\-events openat.scope.processName=ls
.EE
.RE
.IP \[bu] 2
To trace only `security_file_open' events coming from a container, use
the following flag:
.RS 2
.IP
.EX
\-\-events security_file_open.scope.container
.EE
.RE
.IP \[bu] 2
To trace all detectors with critical severity, use the following flag:
.RS 2
.IP
.EX
\-\-events threat.severity=critical
.EE
.RE
.IP \[bu] 2
To trace all detectors with high or critical severity, use the following
flag:
.RS 2
.IP
.EX
\-\-events \[aq]threat.severity>=high\[aq]
.EE
.RE
.IP \[bu] 2
To trace detectors for a specific MITRE ATT&CK technique, use the
following flag:
.RS 2
.IP
.EX
\-\-events threat.mitre.technique=T1055
.EE
.RE
.IP \[bu] 2
To trace detectors for a specific MITRE ATT&CK tactic, use the following
flag:
.RS 2
.IP
.EX
\-\-events \[aq]threat.mitre.tactic=\[dq]Defense Evasion\[dq]\[aq]
.EE
.RE
.IP \[bu] 2
To combine threat\-based selection with regular events, use the
following flags:
.RS 2
.IP
.EX
\-\-events write \-\-events threat.severity=critical
.EE
.RE
