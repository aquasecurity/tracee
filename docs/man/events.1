.\" Automatically generated by Pandoc 3.2
.\"
.TH "TRACEE\-EVENTS" "1" "2024/06" "" "Tracee Events Flag Manual"
.SS NAME
tracee \f[B]\-\-events\f[R] \- Select which events to trace
.SS SYNOPSIS
tracee \f[B]\-\-events\f[R] [<event\-name1(,[\-]event\-name2\&...)> |
<[\-]event\-name1(,set1\&...)> |
<set1(,[\-]event\-name1,[\-]event\-name2\&...)> |
<event1.data.data\-field[=|!=]value> |
<event1.retval[=|!=|<|>|<=|>=]value> |
<event1.scope.field[=|!=|<|>|<=|>=]value> | <event.scope.container>]
\&...
.SS DESCRIPTION
The \f[B]\-\-events\f[R] flag allows you to select which events to trace
by defining filters.
.SS FILTERS
.IP \[bu] 2
Event or set name: Select specific events using
`event\-name1,event\-name2\&...' or predefined event sets using
`event_set_name1,event_set_name2\&...'.
To exclude events, prepend the event name with a dash `\-':
`\-event\-name'.
.IP \[bu] 2
Event data: Filter events based on their data using
`event\-name.data.event_data'.
The event data expression follows the syntax of a string expression.
.IP \[bu] 2
Event return value: Filter events based on their return value using
`event\-name.retval'.
The event return value expression follows the syntax of a numerical
expression.
.IP \[bu] 2
Event scope fields: Filter events based on the non\-argument fields
defined in the trace.Event struct using `event\-name.scope.field'.
Refer to the json tags in the trace.Event struct located in the
types/trace package for the correct field names, and the event filtering
section in the documentation for a full list.
.SS FILTER EXPRESSION
Filter expressions can be defined to operate on event options or process
metadata.
Only events that match all filter expressions will be traced.
.PP
Multiple flags are combined with AND logic, while multiple values within
a single flag are combined with OR logic when using the equals operator
`='.
Multiple values can be specified using `,'.
.SS NUMERICAL EXPRESSION OPERATORS
`=', `!=', `<', `>', `<=', `>='
.PP
Available for:
.IP \[bu] 2
return value
.IP \[bu] 2
scope fields
.PP
NOTE: Expressions containing `<' or `>' tokens must be escaped!
.SS STRING EXPRESSION OPERATORS
`=', `!='
.PP
Available for:
.IP \[bu] 2
event arguments
.IP \[bu] 2
return value
.IP \[bu] 2
scope fields
.PP
Strings can be compared as a prefix if ending with `*', or as a suffix
if starting with `*'.
.PP
NOTE: Expressions containing `*' token must be escaped!
.SS EXCLUSION OPERATOR (PREPENDED)
`\-'
.PP
Available only for:
.IP \[bu] 2
event names
.SS EXAMPLES
.IP \[bu] 2
To trace only `execve' and `open' events, use the following flag:
.RS 2
.IP
.EX
\-\-events execve,open
.EE
.RE
.IP \[bu] 2
To trace only events prefixed by \[lq]open\[rq], use the following flag:
.RS 2
.IP
.EX
\-\-events \[aq]open*\[aq]
.EE
.RE
.IP \[bu] 2
To exclude events prefixed by \[lq]open\[rq] or \[lq]dup\[rq], use the
following flag:
.RS 2
.IP
.EX
\-\-events \[aq]\-open*,\-dup*\[aq]
.EE
.RE
.IP \[bu] 2
To trace all file\-system related events, use the following flag:
.RS 2
.IP
.EX
\-\-events fs
.EE
.RE
.IP \[bu] 2
To trace all file\-system related events, but not `open' or `openat',
use the following flag:
.RS 2
.IP
.EX
\-\-events fs \-\-events \[aq]\-open,\-openat\[aq]
.EE
.RE
.IP \[bu] 2
To trace only `close' events that have `fd' equal to 5, use the
following flag:
.RS 2
.IP
.EX
\-\-events close.data.fd=5
.EE
.RE
.IP \[bu] 2
To trace only `openat' events that have `pathname' prefixed by `/tmp',
use the following flag:
.RS 2
.IP
.EX
\-\-events openat.data.pathname=\[aq]/tmp*\[aq]
.EE
.RE
.IP \[bu] 2
To trace only `openat' events that have `pathname' suffixed by `shadow',
use the following flag:
.RS 2
.IP
.EX
\-\-events openat.data.pathname=\[aq]*shadow\[aq]
.EE
.RE
.IP \[bu] 2
To exclude `openat' events that have `pathname' equal to `/tmp/1' or
`/bin/ls', use the following flag:
.RS 2
.IP
.EX
\-\-events openat.data.pathname!=/tmp/1,/bin/ls
.EE
.RE
.IP \[bu] 2
To trace only `openat' events that have `processName' equal to `ls', use
the following flag:
.RS 2
.IP
.EX
\-\-events openat.scope.processName=ls
.EE
.RE
.IP \[bu] 2
To trace only `security_file_open' events coming from a container, use
the following flag:
.RS 2
.IP
.EX
\-\-events security_file_open.scope.container
.EE
.RE
