.\" Automatically generated by Pandoc 3.2
.\"
.TH "TRACEE\-K8S\-CERT\-THEFT" "1" "" "" "Tracee Event Manual"
.SS NAME
\f[B]k8s_cert_theft\f[R] \- detect Kubernetes TLS certificate theft
attempts
.SS DESCRIPTION
This event detects unauthorized access or potential theft of Kubernetes
Transport Layer Security (TLS) certificates.
These certificates are critical for secure communication between
Kubernetes components, and their compromise could allow attackers to
impersonate legitimate cluster components.
.PP
The event monitors both direct file access and rename operations
involving Kubernetes certificate files, helping detect various
exfiltration techniques.
It also verifies that only authorized processes access these sensitive
files.
.SS SIGNATURE METADATA
.IP \[bu] 2
\f[B]ID\f[R]: TRC\-1018
.IP \[bu] 2
\f[B]Version\f[R]: 1
.IP \[bu] 2
\f[B]Severity\f[R]: 3
.IP \[bu] 2
\f[B]Category\f[R]: credential\-access
.IP \[bu] 2
\f[B]Technique\f[R]: Steal Application Access Token
.IP \[bu] 2
\f[B]MITRE ID\f[R]:
attack\-pattern\[en]890c9858\-598c\-401d\-a4d5\-c67ebcdd703a
.IP \[bu] 2
\f[B]MITRE External ID\f[R]: T1528
.SS EVENT SETS
\f[B]signatures\f[R], \f[B]default\f[R]
.SS DATA FIELDS
This signature event uses fields from the underlying security events:
.TP
\f[B]pathname\f[R] (\f[I]string\f[R])
Path to the certificate file being accessed
.TP
\f[B]flags\f[R] (\f[I]string\f[R])
File access flags indicating the type of operation
.TP
\f[B]old_path\f[R] (\f[I]string\f[R])
Original path in case of rename operations
.TP
\f[B]new_path\f[R] (\f[I]string\f[R])
New path in case of rename operations
.SS DEPENDENCIES
.IP \[bu] 2
\f[CR]security_file_open\f[R]: Monitor certificate file access
.IP \[bu] 2
\f[CR]security_inode_rename\f[R]: Track certificate file renames
.SS USE CASES
.IP \[bu] 2
\f[B]Certificate protection\f[R]: Monitor sensitive TLS file access
.IP \[bu] 2
\f[B]Credential theft detection\f[R]: Identify unauthorized access
attempts
.IP \[bu] 2
\f[B]Cluster security\f[R]: Protect component authentication
.IP \[bu] 2
\f[B]Incident response\f[R]: Track potential certificate compromise
.SS KUBERNETES CERTIFICATES
Critical certificate types:
.IP \[bu] 2
API server certificates
.IP \[bu] 2
Kubelet client certificates
.IP \[bu] 2
Service account tokens
.IP \[bu] 2
etcd client certificates
.IP \[bu] 2
Controller manager certificates
.IP \[bu] 2
Scheduler certificates
.SS ATTACK VECTORS
Common malicious uses include:
.IP \[bu] 2
\f[B]Component impersonation\f[R]: Masquerade as legitimate services
.IP \[bu] 2
\f[B]Man\-in\-the\-middle\f[R]: Intercept cluster communications
.IP \[bu] 2
\f[B]Credential theft\f[R]: Access to cluster authentication
.IP \[bu] 2
\f[B]Lateral movement\f[R]: Cross\-namespace access
.SS RISK ASSESSMENT
Risk factors to consider:
.IP \[bu] 2
\f[B]Cluster\-wide Impact\f[R]: Affects all communications
.IP \[bu] 2
\f[B]Authentication Bypass\f[R]: Enables impersonation
.IP \[bu] 2
\f[B]Long\-term Access\f[R]: Valid until certificate expiry
.IP \[bu] 2
\f[B]Detection Evasion\f[R]: Legitimate\-looking traffic
.SS MITIGATION
Recommended security controls:
.IP \[bu] 2
Certificate rotation
.IP \[bu] 2
File permissions hardening
.IP \[bu] 2
Process isolation
.IP \[bu] 2
Access auditing
.IP \[bu] 2
Certificate pinning
.IP \[bu] 2
Network segmentation
.SS LEGITIMATE USES
Valid certificate access patterns:
.IP \[bu] 2
Kubernetes components
.IP \[bu] 2
Certificate managers
.IP \[bu] 2
Backup processes
.IP \[bu] 2
Monitoring agents
.SS RELATED EVENTS
.IP \[bu] 2
\f[B]security_file_open\f[R]: File access monitoring
.IP \[bu] 2
\f[B]security_inode_rename\f[R]: File rename operations
.IP \[bu] 2
\f[B]k8s_api_connection\f[R]: API server connections
.IP \[bu] 2
\f[B]container_create\f[R]: Container lifecycle events
