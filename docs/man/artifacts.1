.\" Automatically generated by Pandoc 3.2
.\"
.TH "TRACEE\-ARTIFACTS" "1" "2024/06" "" "Tracee Artifacts Flag Manual"
.SS NAME
tracee \f[B]\-\-artifacts\f[R] \- Capture artifacts that were written,
executed, or found to be suspicious
.SS SYNOPSIS
tracee \f[B]\-\-artifacts\f[R] <artifact\-option[=value]> \&...
.SS DESCRIPTION
The \f[B]\-\-artifacts\f[R] flag allows you to capture artifacts that
were written, executed, or found to be suspicious during the execution
of Tracee.
The captured artifacts will appear in the `output\-path' directory.
.PP
Possible artifacts options:
.IP \[bu] 2
\f[B]file\-write\f[R]: Capture written files.
\f[B]Note\f[R]: Using \f[CR]file\-write.filters\f[R] automatically
enables file\-write, so you don\[cq]t need to also specify
\f[CR]\-\-artifacts file\-write\f[R].
.IP \[bu] 2
\f[B]file\-write.filters=<filter>\f[R]: Filter for file writes (multiple
allowed).
Format: <filter_type>=<filter_value>
.IP \[bu] 2
\f[B]file\-read\f[R]: Capture read files.
\f[B]Note\f[R]: Using \f[CR]file\-read.filters\f[R] automatically
enables file\-read, so you don\[cq]t need to also specify
\f[CR]\-\-artifacts file\-read\f[R].
.IP \[bu] 2
\f[B]file\-read.filters=<filter>\f[R]: Filter for file reads (multiple
allowed).
Format: <filter_type>=<filter_value>
.IP \[bu] 2
\f[B]executable\f[R]: Capture executed files.
.IP \[bu] 2
\f[B]kernel\-modules\f[R]: Capture loaded kernel modules.
.IP \[bu] 2
\f[B]bpf\-programs\f[R]: Capture loaded BPF programs bytecode.
.IP \[bu] 2
\f[B]memory\-regions\f[R]: Capture memory regions that had write+execute
(w+x) protection and then changed to execute (x) only.
.IP \[bu] 2
\f[B]network\f[R]: Capture network traffic.
Only TCP/UDP/ICMP protocols are currently supported.
\f[B]Note\f[R]: Using \f[CR]network.pcap.split\f[R],
\f[CR]network.pcap.options\f[R], or \f[CR]network.pcap.snaplen\f[R]
automatically enables network, so you don\[cq]t need to also specify
\f[CR]\-\-artifacts network\f[R].
.IP \[bu] 2
\f[B]network.pcap.split=<split_mode>\f[R]: Capture separate pcap files
organized by split mode: single, process, container, command
(comma\-separated).
.IP \[bu] 2
\f[B]network.pcap.options=<option>\f[R]: Network capturing options: none
(default) or filtered.
.IP \[bu] 2
\f[B]network.pcap.snaplen=<size>\f[R]: Sets captured payload from each
packet: default, headers, max, or SIZE (e.g., 256b, 512b, 1kb, 2kb,
4kb).
.IP \[bu] 2
\f[B]dir.path=<path>\f[R]: Path where tracee will save produced
artifacts.
The artifact will be saved into an `out' subdirectory (default:
/tmp/tracee).
.IP \[bu] 2
\f[B]dir.clear\f[R]: Clear the captured artifacts output dir before
starting (default: false).
.SS File Capture Filters
Files captured upon read/write can be filtered to catch only specific IO
operations.
The different filter types have a logical `AND' between them but a
logical `OR' between filters of the same type.
The filter format is as follows: <filter_type>=<filter_value>
.PP
Filter types:
.IP \[bu] 2
\f[B]path\f[R]: A filter for the file path prefix (up to 50 characters).
Up to 3 filters can be given.
Format: path=/path/prefix*
.IP \[bu] 2
\f[B]type\f[R]: A file type from the following options: `regular',
`pipe', `socket' and `elf'.
Format: type=regular
.IP \[bu] 2
\f[B]fd\f[R]: The file descriptor of the file.
Can be one of the three standards: `stdin', `stdout' and `stderr'.
Format: fd=stdout
.SS Network Capture Notes
.IP \[bu] 2
Pcap Files:
.RS 2
.IP \[bu] 2
If you only specify \f[B]\-\-artifacts network\f[R], you will have a
single file with all network traffic.
.IP \[bu] 2
You can use \f[B]network.pcap.split=xxx,yyy\f[R] to have more than one
pcap file, split by different means.
.RE
.IP \[bu] 2
Pcap Options:
.RS 2
.IP \[bu] 2
If you do not specify \f[B]network.pcap.options\f[R] (or set to none),
you will capture ALL network traffic into your pcap files.
.IP \[bu] 2
If you specify \f[B]network.pcap.options=filtered\f[R], events being
traced will define what network traffic will be captured.
.RE
.IP \[bu] 2
Snap Length:
.RS 2
.IP \[bu] 2
If you do not specify a snaplen, the default is headers only (incomplete
packets in tcpdump).
.IP \[bu] 2
If you specify \f[B]max\f[R] as snaplen, you will get full packets
contents (pcap files will be large).
.IP \[bu] 2
If you specify \f[B]headers\f[R] as snaplen, you will only get L2/L3
headers in captured packets.
.IP \[bu] 2
If you specify \f[B]headers\f[R] but trace for \f[B]net_packet_dns\f[R]
events, L4 DNS header will be captured.
.IP \[bu] 2
If you specify \f[B]headers\f[R] but trace for \f[B]net_packet_http\f[R]
events, only L2/L3 headers will be captured.
.RE
.SS EXAMPLES
.SS File capture
.IP \[bu] 2
To capture executed files into the default output directory, use the
following flag:
.RS 2
.IP
.EX
\-\-artifacts executable
.EE
.RE
.IP \[bu] 2
To capture executed files into a specific directory, clear the directory
before starting, use the following flags:
.RS 2
.IP
.EX
\-\-artifacts executable \-\-artifacts dir.path=/my/dir \-\-artifacts dir.clear
.EE
.RE
.IP \[bu] 2
To capture files that were written into anywhere under /usr/bin/ or
/etc/, use the following flags:
.RS 2
.IP
.EX
\-\-artifacts file\-write.filters=path=/usr/bin/* \-\-artifacts file\-write.filters=path=/etc/*
.EE
.PP
Note: \f[CR]file\-write.filters\f[R] automatically enables file\-write,
so \f[CR]\-\-artifacts file\-write\f[R] is not needed.
.RE
.IP \[bu] 2
To capture file writes to socket files that are the `stdout' of the
writing process, use the following flags:
.RS 2
.IP
.EX
\-\-artifacts file\-write.filters=type=socket \-\-artifacts file\-write.filters=fd=stdout
.EE
.PP
Note: \f[CR]file\-write.filters\f[R] automatically enables file\-write,
so \f[CR]\-\-artifacts file\-write\f[R] is not needed.
.RE
.SS Network Capture
.IP \[bu] 2
To capture network traffic, use the following flag:
.RS 2
.IP
.EX
\-\-artifacts network
.EE
.RE
.IP \[bu] 2
To capture network traffic and save separate pcap files for processes
and commands, use the following flags:
.RS 2
.IP
.EX
\-\-artifacts network.pcap.split=process,command
.EE
.PP
Note: \f[CR]network.pcap.split\f[R] automatically enables network, so
\f[CR]\-\-artifacts network\f[R] is not needed.
.RE
.IP \[bu] 2
To capture network traffic and save pcap files containing only
traced/filtered packets, use the following flags:
.RS 2
.IP
.EX
\-\-artifacts network.pcap.options=filtered
.EE
.PP
Note: \f[CR]network.pcap.options\f[R] automatically enables network, so
\f[CR]\-\-artifacts network\f[R] is not needed.
.RE
.IP \[bu] 2
To capture network traffic and set the captured payload from each packet
to 1KB, use the following flags:
.RS 2
.IP
.EX
\-\-artifacts network.pcap.snaplen=1kb
.EE
.PP
Note: \f[CR]network.pcap.snaplen\f[R] automatically enables network, so
\f[CR]\-\-artifacts network\f[R] is not needed.
.RE
.IP \[bu] 2
To capture network traffic and save pcap files for containers and
commands, use the following flags:
.RS 2
.IP
.EX
\-\-artifacts network.pcap.split=container,command
.EE
.PP
Note: \f[CR]network.pcap.split\f[R] automatically enables network, so
\f[CR]\-\-artifacts network\f[R] is not needed.
.RE
