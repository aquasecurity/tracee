.\" Automatically generated by Pandoc 3.2
.\"
.TH "TRACEE\-SUDOERS\-MODIFICATION" "1" "" "" "Tracee Event Manual"
.SS NAME
\f[B]sudoers_modification\f[R] \- detect modifications to sudo
configuration
.SS DESCRIPTION
This event detects modifications to the sudoers configuration files,
which control sudo command privileges on Unix and Linux systems.
The sudoers file (/etc/sudoers and files in /etc/sudoers.d/) defines
which users can run what commands with elevated privileges, making it a
critical security control point.
.PP
Unauthorized changes to these files could allow attackers to grant
themselves or others elevated privileges, potentially leading to
complete system compromise.
The event monitors both direct modifications and rename operations
involving sudoers files.
.SS SIGNATURE METADATA
.IP \[bu] 2
\f[B]ID\f[R]: TRC\-1028
.IP \[bu] 2
\f[B]Version\f[R]: 1
.IP \[bu] 2
\f[B]Severity\f[R]: 2
.IP \[bu] 2
\f[B]Category\f[R]: privilege\-escalation
.IP \[bu] 2
\f[B]Technique\f[R]: Sudo and Sudo Caching
.IP \[bu] 2
\f[B]MITRE ID\f[R]:
attack\-pattern\[en]1365fe3b\-0f50\-455d\-b4da\-266ce31c23b0
.IP \[bu] 2
\f[B]MITRE External ID\f[R]: T1548.003
.SS EVENT SETS
\f[B]signatures\f[R], \f[B]default\f[R]
.SS DATA FIELDS
This signature event uses fields from multiple underlying events:
.TP
\f[B]pathname\f[R] (\f[I]string\f[R])
Path to the sudoers file being accessed
.TP
\f[B]flags\f[R] (\f[I]string\f[R])
File access flags indicating modification
.TP
\f[B]old_path\f[R] (\f[I]string\f[R])
Original path in rename operations
.TP
\f[B]new_path\f[R] (\f[I]string\f[R])
New path in rename operations
.SS DEPENDENCIES
.IP \[bu] 2
\f[CR]security_file_open\f[R]: Monitor file modifications
.IP \[bu] 2
\f[CR]security_inode_rename\f[R]: Track file renames
.SS USE CASES
.IP \[bu] 2
\f[B]Privilege control\f[R]: Monitor sudo permission changes
.IP \[bu] 2
\f[B]System integrity\f[R]: Track critical file modifications
.IP \[bu] 2
\f[B]Security compliance\f[R]: Ensure proper sudo configuration
.IP \[bu] 2
\f[B]Incident response\f[R]: Detect unauthorized changes
.SS SUDOERS COMPONENTS
Critical files and locations:
.IP \[bu] 2
/etc/sudoers
.IP \[bu] 2
/etc/sudoers.d/
.IP \[bu] 2
visudo command
.IP \[bu] 2
sudoers.tmp
.IP \[bu] 2
User\-specific sudo rules
.IP \[bu] 2
Host\-specific rules
.IP \[bu] 2
Command aliases
.IP \[bu] 2
User aliases
.SS ATTACK VECTORS
Common malicious uses include:
.IP \[bu] 2
\f[B]Privilege escalation\f[R]: Grant unauthorized sudo access
.IP \[bu] 2
\f[B]Command execution\f[R]: Enable restricted commands
.IP \[bu] 2
\f[B]Persistence\f[R]: Maintain elevated access
.IP \[bu] 2
\f[B]Security bypass\f[R]: Disable security controls
.SS RISK ASSESSMENT
Risk factors to consider:
.IP \[bu] 2
\f[B]System\-Wide Impact\f[R]: Affects all users
.IP \[bu] 2
\f[B]Root Access\f[R]: Controls superuser access
.IP \[bu] 2
\f[B]Security Control\f[R]: Core security mechanism
.IP \[bu] 2
\f[B]Configuration Impact\f[R]: Changes persist
.SS LEGITIMATE USES
Valid modification scenarios:
.IP \[bu] 2
User permission updates
.IP \[bu] 2
System administration
.IP \[bu] 2
Security policy changes
.IP \[bu] 2
Access control updates
.IP \[bu] 2
Command restrictions
.SS MITIGATION
Recommended security controls:
.IP \[bu] 2
Use visudo for changes
.IP \[bu] 2
Restrict sudoers.d/ access
.IP \[bu] 2
Monitor file integrity
.IP \[bu] 2
Regular audits
.IP \[bu] 2
Backup configurations
.SS RELATED EVENTS
.IP \[bu] 2
\f[B]security_file_open\f[R]: File access monitoring
.IP \[bu] 2
\f[B]security_inode_rename\f[R]: File rename operations
.IP \[bu] 2
\f[B]process_execute\f[R]: Command execution
.IP \[bu] 2
\f[B]scheduled_task_mod\f[R]: Task scheduling changes
