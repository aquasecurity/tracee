.\" Automatically generated by Pandoc 3.2
.\"
.TH "TRACEE\-CGROUP\-RELEASE\-AGENT\-MODIFICATION" "1" "" "" "Tracee Event Manual"
.SS NAME
\f[B]cgroup_release_agent\f[R] \- detect modifications to cgroup
release_agent file
.SS DESCRIPTION
This event detects modifications to the \f[CR]release_agent\f[R] file
within cgroups.
The release agent is a critical component that specifies a script or
command to be executed whenever a cgroup becomes empty.
Due to its ability to execute arbitrary commands, unauthorized
modifications to this file could indicate attempts at privilege
escalation or container escape.
.PP
The event monitors both direct modifications and rename operations
involving the release_agent file, helping detect various tampering
techniques.
.SS SIGNATURE METADATA
.IP \[bu] 2
\f[B]ID\f[R]: TRC\-1010
.IP \[bu] 2
\f[B]Version\f[R]: 1
.IP \[bu] 2
\f[B]Severity\f[R]: 3
.IP \[bu] 2
\f[B]Category\f[R]: privilege\-escalation
.IP \[bu] 2
\f[B]Technique\f[R]: Escape to Host
.IP \[bu] 2
\f[B]MITRE ID\f[R]:
attack\-pattern\[en]4a5b7ade\-8bb5\-4853\-84ed\-23f262002665
.IP \[bu] 2
\f[B]MITRE External ID\f[R]: T1611
.SS EVENT SETS
\f[B]signatures\f[R], \f[B]default\f[R]
.SS DATA FIELDS
This signature event uses fields from the underlying security events:
.TP
\f[B]pathname\f[R] (\f[I]string\f[R])
Path to the release_agent file being accessed
.TP
\f[B]flags\f[R] (\f[I]string\f[R])
File access flags indicating the type of operation
.TP
\f[B]old_path\f[R] (\f[I]string\f[R])
Original path in case of rename operations
.TP
\f[B]new_path\f[R] (\f[I]string\f[R])
New path in case of rename operations
.SS DEPENDENCIES
.IP \[bu] 2
\f[CR]security_file_open\f[R]: Monitor file access attempts
.IP \[bu] 2
\f[CR]security_inode_rename\f[R]: Track file rename operations
.SS USE CASES
.IP \[bu] 2
\f[B]Container security\f[R]: Detect potential container escape attempts
.IP \[bu] 2
\f[B]Privilege escalation detection\f[R]: Monitor for unauthorized
command execution setup
.IP \[bu] 2
\f[B]Runtime integrity\f[R]: Track changes to critical cgroup
configurations
.IP \[bu] 2
\f[B]Incident response\f[R]: Identify tampering with container isolation
mechanisms
.SS CGROUP SECURITY
Critical aspects of release_agent security:
.IP \[bu] 2
Executes with root privileges
.IP \[bu] 2
Runs outside container context
.IP \[bu] 2
Can access host system resources
.IP \[bu] 2
Triggered automatically on cgroup emptying
.SS ATTACK VECTORS
Common malicious uses include:
.IP \[bu] 2
\f[B]Command injection\f[R]: Inserting malicious commands
.IP \[bu] 2
\f[B]Container escape\f[R]: Breaking container isolation
.IP \[bu] 2
\f[B]Persistence\f[R]: Establishing automatic execution
.IP \[bu] 2
\f[B]Privilege escalation\f[R]: Gaining elevated access
.SS RISK ASSESSMENT
Risk factors to consider:
.IP \[bu] 2
\f[B]High Impact\f[R]: Can lead to container escape
.IP \[bu] 2
\f[B]Root Access\f[R]: Commands run with full privileges
.IP \[bu] 2
\f[B]Automated Execution\f[R]: Triggers without user interaction
.IP \[bu] 2
\f[B]Wide Access\f[R]: Can affect multiple containers
.SS RELATED EVENTS
.IP \[bu] 2
\f[B]cgroup_notify_on_release_modification\f[R]: Related cgroup control
file changes
.IP \[bu] 2
\f[B]security_file_open\f[R]: File access monitoring
.IP \[bu] 2
\f[B]security_inode_rename\f[R]: File rename operations
.IP \[bu] 2
\f[B]container_create\f[R]: Container lifecycle events
