.\" Automatically generated by Pandoc 3.2
.\"
.TH "TRACEE\-STORES" "1" "2025/12" "" "Tracee Stores Flag Manual"
.SS NAME
tracee \f[B]\-\-stores\f[R] \- Configure data stores for DNS cache and
process tree
.SS SYNOPSIS
tracee \f[B]\-\-stores\f[R]
[dns|dns.max\-entries=\f[I]size\f[R]|process|process.max\-processes=\f[I]size\f[R]|process.max\-threads=\f[I]size\f[R]|process.source=\f[I]source\f[R]|process.use\-procfs]
[\f[B]\-\-stores\f[R] \&...]
.SS DESCRIPTION
The \f[B]\-\-stores\f[R] flag allows you to configure data stores for
DNS cache and process tree functionality.
.SS DNS Store Options
.IP \[bu] 2
\f[B]dns\f[R]: Enable the DNS cache store with default settings.
When enabled, Tracee will cache DNS query information for enrichment of
network events.
.IP \[bu] 2
\f[B]dns.max\-entries\f[R]=\f[I]size\f[R]: Enable the DNS cache store
and set the maximum number of DNS query trees to cache.
Default is 5000.
Further queries may be cached regardless once the limit is reached.
\f[B]Note\f[R]: Using this option automatically enables DNS, so you
don\[cq]t need to also specify \f[CR]\-\-stores dns\f[R].
.SS Process Store Options
.IP \[bu] 2
\f[B]process\f[R]: Enable the process tree store with default settings.
When enabled, Tracee will maintain a tree of processes and threads for
enrichment of events.
.IP \[bu] 2
\f[B]process.max\-processes\f[R]=\f[I]size\f[R]: Enable the process tree
store and set the maximum number of processes to cache in the process
tree.
Default is 10928.
This is an LRU cache that will evict least recently accessed entries
when full.
\f[B]Note\f[R]: Using this option automatically enables process, so you
don\[cq]t need to also specify \f[CR]\-\-stores process\f[R].
.IP \[bu] 2
\f[B]process.max\-threads\f[R]=\f[I]size\f[R]: Enable the process tree
store and set the maximum number of threads to cache in the process
tree.
Default is 21856.
This is an LRU cache that will evict least recently accessed entries
when full.
\f[B]Note\f[R]: Using this option automatically enables process, so you
don\[cq]t need to also specify \f[CR]\-\-stores process\f[R].
.IP \[bu] 2
\f[B]process.source\f[R]=\f[I]source\f[R]: Enable the process tree store
and set the source for process tree enrichment.
Valid values are:
.RS 2
.IP \[bu] 2
\f[B]signals\f[R]: Process tree is built from signals (default).
.IP \[bu] 2
\f[B]events\f[R]: Process tree is built from events.
.IP \[bu] 2
\f[B]both\f[R]: Process tree is built from both events and signals.
.PP
\f[B]Note\f[R]: Using this option automatically enables process, so you
don\[cq]t need to also specify \f[CR]\-\-stores process\f[R].
If no source is specified, the default is \f[CR]signals\f[R].
.RE
.IP \[bu] 2
\f[B]process.use\-procfs\f[R]: Enable the process tree store and enable
procfs initialization and querying.
When enabled, Tracee will:
.RS 2
.IP \[bu] 2
Scan procfs during initialization to fill all existing processes and
threads.
.IP \[bu] 2
Query specific processes at runtime in case of missing information
caused by missing events.
.PP
\f[B]Note\f[R]: Using this option automatically enables process, so you
don\[cq]t need to also specify \f[CR]\-\-stores process\f[R].
The procfs query might increase the feature toll on CPU and memory.
The runtime query might have a snowball effect on lost events, as it
will reduce the system resources in the processes of filling missing
information.
.RE
.SS EXAMPLES
.IP "1." 3
Enable DNS cache:
.RS 4
.IP
.EX
\-\-stores dns
.EE
.RE
.IP "2." 3
Enable DNS cache with custom size:
.RS 4
.IP
.EX
\-\-stores dns.max\-entries=10000
.EE
.PP
Note: \f[CR]dns.max\-entries\f[R] automatically enables DNS, so
\f[CR]\-\-stores dns\f[R] is not needed.
.RE
.IP "3." 3
Enable process tree:
.RS 4
.IP
.EX
\-\-stores process
.EE
.RE
.IP "4." 3
Enable process tree with custom cache sizes:
.RS 4
.IP
.EX
\-\-stores process.max\-processes=8192 \-\-stores process.max\-threads=16384
.EE
.PP
Note: \f[CR]process.max\-processes\f[R] and
\f[CR]process.max\-threads\f[R] automatically enable process, so
\f[CR]\-\-stores process\f[R] is not needed.
.RE
.IP "5." 3
Enable process tree with events source:
.RS 4
.IP
.EX
\-\-stores process.source=events
.EE
.PP
Note: \f[CR]process.source\f[R] automatically enables process, so
\f[CR]\-\-stores process\f[R] is not needed.
.RE
.IP "6." 3
Enable process tree with both events and signals sources:
.RS 4
.IP
.EX
\-\-stores process.source=both
.EE
.PP
Note: \f[CR]process.source\f[R] automatically enables process, so
\f[CR]\-\-stores process\f[R] is not needed.
.RE
.IP "7." 3
Enable process tree with procfs support:
.RS 4
.IP
.EX
\-\-stores process.use\-procfs
.EE
.PP
Note: \f[CR]process.use\-procfs\f[R] automatically enables process, so
\f[CR]\-\-stores process\f[R] is not needed.
.RE
.IP "8." 3
Combine DNS and process stores:
.RS 4
.IP
.EX
\-\-stores dns.max\-entries=5000 \-\-stores process.source=both \-\-stores process.max\-processes=8192
.EE
.PP
Note: Since \f[CR]dns.max\-entries\f[R] and \f[CR]process.source\f[R]
automatically enable their respective stores, you don\[cq]t need
\f[CR]\-\-stores dns\f[R] or \f[CR]\-\-stores process\f[R].
.RE
.IP "9." 3
Complete configuration example:
.RS 4
.IP
.EX
\-\-stores dns.max\-entries=5000 \-\-stores process.max\-processes=8192 \-\-stores process.max\-threads=16384 \-\-stores process.source=both \-\-stores process.use\-procfs
.EE
.PP
Note: All process options automatically enable process, and
\f[CR]dns.max\-entries\f[R] automatically enables DNS, so you don\[cq]t
need \f[CR]\-\-stores dns\f[R] or \f[CR]\-\-stores process\f[R].
.RE
.PP
Please refer to the DNS data source documentation and Process Tree data
source documentation for more information.
