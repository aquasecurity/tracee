
# msgsnd

## Intro
msgsnd - submit a message to a message queue

## Description
The msgsnd() system call appends a message to a message queue. It is a blocking version of msgsnd() and will block until the message can be enqueued. The msqid argument is the identifier of the message queue, and the msgp points to the message structure to be sent. The msgsz argument is the size of the passed message structure in bytes. The msgflag argument is the bitwise OR of flags to indicate the type of message transfer.

The msgp argument is a pointer to a structure of the following format:

```c
struct msgbuf {
    long mtype;    /* message type, must be > 0 */
    char mtext[1]; /* message data */
};
```

The mtype field specifies the type of message being sent, and must be nonzero. On return, the mtext field in the source msgp structure contains no meaningful data.

#### Advantages
Using msgsnd() allows for rapid, reliable communication between processes without involving multiple context switches.

#### Drawbacks
Using msgsnd() requires that the message queue already exists, and that the queues are tested to be valid before attempting to send a message.

## Arguments
* `msqid`:`int`[K] - Identifier of the message queue.
* `msgp`:`struct msgbuf*`[U] - Pointer to the message structure to be sent.
* `msgsz`:`size_t` - The size of the passed message structure in bytes.
* `msgflg`:`int`[K] - Bitwise OR of flags to indicate the type of message transfer.

### Available Tags
* K - Originated from kernel-space.
* U - Originated from user space (for example, pointer to user space memory used to get it)
* TOCTOU - Vulnerable to TOCTOU (time of check, time of use)
* OPT - Optional argument - might not always be available (passed with null value)

## Hooks
### do_msgsnd
#### Type
Kprobe
#### Purpose
To monitor the execution of the msgsnd syscall.

## Example Use Case
The msgsnd() system call can be used to send a message from one process to another, allowing for interprocess communication.

## Issues
None

## Related Events
- msgrcv() - Receive a message from a message queue.

> This document was automatically generated by OpenAI and needs review. It might
> not be accurate and might contain errors. The authors of Tracee recommend that
> the user reads the "events.go" source file to understand the events and their
> arguments better.
